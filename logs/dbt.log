[0m16:14:25.459852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F2CC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F2CCBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F44FE60>]}


============================== 16:14:25.466855 | 21183e17-5303-4ceb-bb0f-65ccd573b19e ==============================
[0m16:14:25.466855 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:14:25.466855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:25.583855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21183e17-5303-4ceb-bb0f-65ccd573b19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F508890>]}
[0m16:14:25.612863 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:14:25.613860 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:14:25.615855 [debug] [MainThread]: Command `cli deps` succeeded at 16:14:25.615855 after 0.40 seconds
[0m16:14:25.615855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281998E6A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819FEF3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F44FE60>]}
[0m16:14:25.616856 [debug] [MainThread]: Flushing usage events
[0m16:14:26.022113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:10.491941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027195162C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027197CA7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027197CA79B0>]}


============================== 16:24:10.495947 | c65a777a-87a9-48e2-8d53-f12d1d00b753 ==============================
[0m16:24:10.495947 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:24:10.496951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:24:10.511947 [info ] [MainThread]: dbt version: 1.9.3
[0m16:24:10.511947 [info ] [MainThread]: python version: 3.12.3
[0m16:24:10.512947 [info ] [MainThread]: python path: C:\Program Files\Python312\dbt-core-demo\Scripts\python.exe
[0m16:24:10.513947 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m16:24:10.571513 [info ] [MainThread]: Using profiles dir at C:\Users\peichunl\.dbt
[0m16:24:10.572515 [info ] [MainThread]: Using profiles.yml file at C:\Users\peichunl\.dbt\profiles.yml
[0m16:24:10.573512 [info ] [MainThread]: Using dbt_project.yml file at C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\dbt_project.yml
[0m16:24:10.574520 [info ] [MainThread]: adapter type: postgres
[0m16:24:10.574520 [info ] [MainThread]: adapter version: 1.9.0
[0m16:24:10.638513 [info ] [MainThread]: Configuration:
[0m16:24:10.639513 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:24:10.640515 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:24:10.640515 [info ] [MainThread]: Required dependencies:
[0m16:24:10.641518 [debug] [MainThread]: Executing "git --help"
[0m16:24:10.644531 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m16:24:10.645531 [info ] [MainThread]: Connection:
[0m16:24:10.646533 [info ] [MainThread]:   host: localhost
[0m16:24:10.647538 [info ] [MainThread]:   port: 5432
[0m16:24:10.648536 [info ] [MainThread]:   user: postgres
[0m16:24:10.649529 [info ] [MainThread]:   database: dvdrental
[0m16:24:10.649529 [info ] [MainThread]:   schema: public
[0m16:24:10.650529 [info ] [MainThread]:   connect_timeout: 10
[0m16:24:10.650529 [info ] [MainThread]:   role: None
[0m16:24:10.651532 [info ] [MainThread]:   search_path: None
[0m16:24:10.652532 [info ] [MainThread]:   keepalives_idle: 0
[0m16:24:10.652532 [info ] [MainThread]:   sslmode: None
[0m16:24:10.653530 [info ] [MainThread]:   sslcert: None
[0m16:24:10.653530 [info ] [MainThread]:   sslkey: None
[0m16:24:10.654531 [info ] [MainThread]:   sslrootcert: None
[0m16:24:10.654531 [info ] [MainThread]:   application_name: dbt
[0m16:24:10.654531 [info ] [MainThread]:   retries: 1
[0m16:24:10.655531 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:10.813527 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:24:10.903525 [debug] [MainThread]: Using postgres connection "debug"
[0m16:24:10.904525 [debug] [MainThread]: On debug: select 1 as id
[0m16:24:10.904525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:10.976523 [debug] [MainThread]: SQL status: SELECT 1 in 0.071 seconds
[0m16:24:10.977524 [debug] [MainThread]: On debug: Close
[0m16:24:10.977524 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:24:10.978522 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:24:10.980524 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m16:24:10.982523 [debug] [MainThread]: Command `dbt debug` failed at 16:24:10.982523 after 0.64 seconds
[0m16:24:10.982523 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:24:10.982523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027195162C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271952B39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027197ADA240>]}
[0m16:24:10.983526 [debug] [MainThread]: Flushing usage events
[0m16:24:11.330229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:47.605765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF76BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CECAA3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF54E1B0>]}


============================== 10:27:47.609767 | fe825283-0c5c-46ca-b65b-6d5ce97b6261 ==============================
[0m10:27:47.609767 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:27:47.610766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:47.724809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe825283-0c5c-46ca-b65b-6d5ce97b6261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEEF828D0>]}
[0m10:27:47.746809 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:27:47.747809 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:27:47.748809 [debug] [MainThread]: Command `cli deps` succeeded at 10:27:47.748809 after 0.28 seconds
[0m10:27:47.748809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF76BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF76AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEFFC26F0>]}
[0m10:27:47.749808 [debug] [MainThread]: Flushing usage events
[0m10:27:48.154587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:04.557253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B4C76C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B427FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B427D880>]}


============================== 10:44:04.560253 | 8a654a9b-bedf-43e7-924d-3045c41b77d5 ==============================
[0m10:44:04.560253 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:44:04.561253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:44:04.650087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a654a9b-bedf-43e7-924d-3045c41b77d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B2869580>]}
[0m10:44:04.680368 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:44:04.682774 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:44:04.683057 [debug] [MainThread]: Command `cli deps` succeeded at 10:44:04.683057 after 0.27 seconds
[0m10:44:04.684084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B45CCA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B640C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B640C9B0>]}
[0m10:44:04.684084 [debug] [MainThread]: Flushing usage events
[0m10:44:05.041217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:44.501977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3F8DAB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41DB5BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41DB7140>]}


============================== 13:28:44.505977 | b19ce1c2-4caa-4ed0-8c64-10ac6dab442a ==============================
[0m13:28:44.505977 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:28:44.506978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:44.652627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE428E33E0>]}
[0m13:28:44.692146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3FB558E0>]}
[0m13:28:44.693145 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:28:44.852066 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:28:44.958339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:44.959341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:44.981339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE42BF9BB0>]}
[0m13:28:45.022341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m13:28:45.031153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m13:28:45.054152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE442F60F0>]}
[0m13:28:45.055153 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m13:28:45.055153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4289D190>]}
[0m13:28:45.056153 [info ] [MainThread]: 
[0m13:28:45.057152 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:45.057152 [info ] [MainThread]: 
[0m13:28:45.058153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:28:45.060153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m13:28:45.188460 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m13:28:45.189472 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m13:28:45.189472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:45.270969 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.082 seconds
[0m13:28:45.273968 [debug] [ThreadPool]: On list_dvdrental: Close
[0m13:28:45.274968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m13:28:45.280973 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m13:28:45.280973 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m13:28:45.281967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:45.461969 [debug] [ThreadPool]: SQL status: BEGIN in 0.181 seconds
[0m13:28:45.462968 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m13:28:45.463969 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:28:45.474967 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.011 seconds
[0m13:28:45.476969 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m13:28:45.477967 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m13:28:45.482969 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.482969 [debug] [MainThread]: On master: BEGIN
[0m13:28:45.483968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:45.555967 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m13:28:45.556969 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.557970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:45.562969 [debug] [MainThread]: SQL status: SELECT 37 in 0.005 seconds
[0m13:28:45.567970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4485D5E0>]}
[0m13:28:45.567970 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:45.568974 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.568974 [debug] [MainThread]: On master: BEGIN
[0m13:28:45.569969 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:28:45.569969 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.570969 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.570969 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.570969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:45.571968 [debug] [MainThread]: On master: Close
[0m13:28:45.586970 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.587967 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:28:45.587967 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m13:28:45.588968 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.592967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.595968 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.622969 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.627967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.628969 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m13:28:45.628969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:45.712970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m13:28:45.713969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.713969 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:28:45.722968 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m13:28:45.727969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.727969 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:28:45.729974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:45.742972 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m13:28:45.742972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.743973 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m13:28:45.744969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:28:45.748969 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m13:28:45.752970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.752970 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:28:45.754969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:28:45.755972 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m13:28:45.757973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3F9E2960>]}
[0m13:28:45.758968 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.17s]
[0m13:28:45.762470 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.762968 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.762968 [info ] [Thread-3 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:28:45.763970 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_second_dbt_model'
[0m13:28:45.763970 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.765967 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.767968 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.778971 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.783144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.783144 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m13:28:45.783975 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:45.857903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.074 seconds
[0m13:28:45.858904 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.858904 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  create view "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:28:45.865906 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:28:45.868903 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.868903 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:28:45.871913 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:45.874903 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m13:28:45.874903 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.875901 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m13:28:45.876901 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:28:45.877905 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m13:28:45.880904 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.880904 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop view if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:28:45.881900 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:28:45.882902 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m13:28:45.882902 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE44947C20>]}
[0m13:28:45.883902 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:28:45.884901 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.885902 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.885902 [debug] [MainThread]: On master: BEGIN
[0m13:28:45.886901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:45.965900 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m13:28:45.965900 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.966902 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.966902 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.967901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:45.967901 [debug] [MainThread]: On master: Close
[0m13:28:45.967901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:45.968902 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m13:28:45.968902 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m13:28:45.968902 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_first_dbt_model' was properly closed.
[0m13:28:45.969902 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m13:28:45.969902 [info ] [MainThread]: 
[0m13:28:45.969902 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m13:28:45.970903 [debug] [MainThread]: Command end result
[0m13:28:45.985900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m13:28:45.987902 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m13:28:45.992901 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m13:28:45.992901 [info ] [MainThread]: 
[0m13:28:45.993901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:45.993901 [info ] [MainThread]: 
[0m13:28:45.993901 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:28:45.994901 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:45.994901 after 1.65 seconds
[0m13:28:45.994901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE422758E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE426363F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE42B4F4D0>]}
[0m13:28:45.995902 [debug] [MainThread]: Flushing usage events
[0m13:28:46.396027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:53.930214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3731D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3AA8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3AABBC0>]}


============================== 14:53:53.937160 | 0b0d2663-14d8-420e-a762-78136f924f45 ==============================
[0m14:53:53.937160 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:53:53.937160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:54.029009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0d2663-14d8-420e-a762-78136f924f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC107C3E0>]}
[0m14:53:54.053145 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:53:54.055143 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:53:54.056144 [debug] [MainThread]: Command `cli deps` succeeded at 14:53:54.056144 after 0.28 seconds
[0m14:53:54.056144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3AA8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3731D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC107C3E0>]}
[0m14:53:54.057148 [debug] [MainThread]: Flushing usage events
[0m14:53:54.474712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:19.468964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0EAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0C8C0>]}


============================== 14:14:19.475792 | 56e80a04-5a92-4c14-a688-729577ab3c9a ==============================
[0m14:14:19.475792 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:14:19.476793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:14:19.619228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001627405A630>]}
[0m14:14:19.659893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273D940E0>]}
[0m14:14:19.660894 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:14:19.821063 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:14:19.945189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:19.945189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:19.949190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres_prj1.example.staging
[0m14:14:19.978218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162744FDCA0>]}
[0m14:14:20.031983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:14:20.038984 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:14:20.072662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162758172F0>]}
[0m14:14:20.072662 [info ] [MainThread]: Found 3 models, 4 data tests, 15 sources, 433 macros
[0m14:14:20.073662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001627402EED0>]}
[0m14:14:20.074661 [info ] [MainThread]: 
[0m14:14:20.075662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:20.075662 [info ] [MainThread]: 
[0m14:14:20.076661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:20.079661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:14:20.222339 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:14:20.223339 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:14:20.223339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:20.295731 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.073 seconds
[0m14:14:20.297733 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:14:20.298733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:14:20.304243 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:14:20.305242 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:14:20.305242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:20.368275 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m14:14:20.368275 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:14:20.369275 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:14:20.376375 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.007 seconds
[0m14:14:20.378376 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:14:20.379375 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:14:20.385378 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.385378 [debug] [MainThread]: On master: BEGIN
[0m14:14:20.385378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:20.445626 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m14:14:20.446633 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.447627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:20.456742 [debug] [MainThread]: SQL status: SELECT 38 in 0.008 seconds
[0m14:14:20.461741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275D922A0>]}
[0m14:14:20.461741 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:20.462743 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.462743 [debug] [MainThread]: On master: BEGIN
[0m14:14:20.463744 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:14:20.463744 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.464741 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.464741 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.464741 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:20.465741 [debug] [MainThread]: On master: Close
[0m14:14:20.471742 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.471742 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.472743 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:14:20.473742 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:14:20.472743 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:14:20.473742 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.473742 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:14:20.478742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.478742 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.481741 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.482741 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.509260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.510260 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.521261 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.521261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.522262 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:14:20.522262 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:20.523259 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.523259 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:14:20.523259 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:20.593262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m14:14:20.594262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.594262 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:14:20.596664 [debug] [Thread-2 (]: SQL status: BEGIN in 0.073 seconds
[0m14:14:20.596664 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.596664 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:14:20.605046 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m14:14:20.610045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.610045 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:14:20.610045 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:14:20.613045 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.615045 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:14:20.616045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.617045 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.618045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.628045 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:14:20.628045 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:14:20.629044 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.629044 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:14:20.630044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.635376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:14:20.635376 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m14:14:20.635376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.639376 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:14:20.639376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:14:20.643376 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.643376 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:14:20.644376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:20.645375 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:14:20.646376 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:14:20.648381 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:14:20.650376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.651376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:14:20.652376 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275D8BC20>]}
[0m14:14:20.653383 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.18s]
[0m14:14:20.654375 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.656375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:14:20.657376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:14:20.658376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275E1BFE0>]}
[0m14:14:20.658376 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m14:14:20.659376 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.660376 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.661376 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:14:20.662375 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_second_dbt_model'
[0m14:14:20.662375 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.664380 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.666376 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.668375 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.670376 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.670376 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:14:20.670376 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:14:20.731897 [debug] [Thread-4 (]: SQL status: BEGIN in 0.061 seconds
[0m14:14:20.732898 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.733903 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:14:20.737897 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:14:20.739898 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.739898 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:14:20.740896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.741896 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:14:20.741896 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.742900 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:14:20.744640 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:20.745876 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:14:20.746876 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.746876 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:14:20.747876 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:14:20.748876 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:14:20.748876 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275E96510>]}
[0m14:14:20.749876 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.09s]
[0m14:14:20.750874 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.752874 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.754881 [debug] [MainThread]: On master: BEGIN
[0m14:14:20.755878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:20.818383 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m14:14:20.819388 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.820383 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.820383 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.821383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:20.821383 [debug] [MainThread]: On master: Close
[0m14:14:20.822387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:20.822387 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:14:20.822387 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:14:20.823384 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_first_dbt_model' was properly closed.
[0m14:14:20.823384 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m14:14:20.824384 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:14:20.824384 [info ] [MainThread]: 
[0m14:14:20.825384 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m14:14:20.826384 [debug] [MainThread]: Command end result
[0m14:14:20.840389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:14:20.843384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:14:20.848383 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:14:20.848383 [info ] [MainThread]: 
[0m14:14:20.849384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:20.850418 [info ] [MainThread]: 
[0m14:14:20.851430 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:14:20.852433 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:20.852433 after 1.53 seconds
[0m14:14:20.853430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273B6FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0D6A0>]}
[0m14:14:20.853430 [debug] [MainThread]: Flushing usage events
[0m14:14:21.285316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:52.441852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F9CF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F0F41D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F5683B0>]}


============================== 14:37:52.444847 | cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c ==============================
[0m14:37:52.444847 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:52.445850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:52.581406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C7EFC80>]}
[0m14:37:52.618924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6FDD9370>]}
[0m14:37:52.619925 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:52.769988 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:52.884949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:52.884949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:52.912479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C707DF770>]}
[0m14:37:52.964480 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:52.969481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:52.991028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C71B171D0>]}
[0m14:37:52.991028 [info ] [MainThread]: Found 3 models, 4 data tests, 15 sources, 433 macros
[0m14:37:52.992024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C71AB92E0>]}
[0m14:37:52.994028 [info ] [MainThread]: 
[0m14:37:52.994028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:52.995028 [info ] [MainThread]: 
[0m14:37:52.997028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:53.001031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:37:53.118536 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:37:53.119537 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:37:53.119537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:53.193684 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m14:37:53.194684 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:37:53.196684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:37:53.200684 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:53.201684 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:37:53.201684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:53.269079 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m14:37:53.270079 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:53.271079 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:53.274089 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.003 seconds
[0m14:37:53.275089 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:37:53.276090 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:37:53.281089 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.281089 [debug] [MainThread]: On master: BEGIN
[0m14:37:53.281089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:53.457431 [debug] [MainThread]: SQL status: BEGIN in 0.176 seconds
[0m14:37:53.457431 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.458429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:53.463428 [debug] [MainThread]: SQL status: SELECT 38 in 0.004 seconds
[0m14:37:53.467428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C71AE7FE0>]}
[0m14:37:53.467428 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:53.468428 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.468428 [debug] [MainThread]: On master: BEGIN
[0m14:37:53.469837 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:53.469837 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.469837 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.470845 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.470845 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:53.470845 [debug] [MainThread]: On master: Close
[0m14:37:53.476284 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.476284 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.477282 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:37:53.477282 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:37:53.478701 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:37:53.478701 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:37:53.479713 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.479713 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.483707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.485707 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.487211 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.487211 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.514580 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.532579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.534586 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.534586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.535581 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:37:53.535581 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:37:53.536584 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:37:53.536584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:53.615358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m14:37:53.616602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.616602 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:37:53.617610 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m14:37:53.618609 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.618609 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:37:53.619609 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:37:53.624609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.625608 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:37:53.625608 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:37:53.627677 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.627677 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:37:53.629104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:53.631146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.632149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:37:53.632149 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:37:53.634148 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.634148 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:37:53.635143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:53.635143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:53.647146 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:53.648146 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:53.649146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.649146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.649146 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:53.650144 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:53.653147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:37:53.653147 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:37:53.657145 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:37:53.658155 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:37:53.662146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.663146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.664146 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:37:53.664146 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:37:53.666146 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:37:53.668148 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:37:53.668148 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:37:53.670149 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:37:53.671145 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F5959D0>]}
[0m14:37:53.671145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7205B140>]}
[0m14:37:53.672144 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.19s]
[0m14:37:53.673654 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.672144 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m14:37:53.675017 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.676022 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.677023 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:37:53.678021 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_second_dbt_model'
[0m14:37:53.678021 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.680028 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.681025 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.684022 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.685021 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.686023 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:37:53.686023 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:37:53.755545 [debug] [Thread-4 (]: SQL status: BEGIN in 0.069 seconds
[0m14:37:53.755545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.756548 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:37:53.759545 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:37:53.761545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.761545 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:37:53.762546 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:53.763545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.764545 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:37:53.765546 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:53.766548 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:53.766548 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.766548 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:53.770567 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m14:37:53.772576 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:37:53.772576 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.773574 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:37:53.774576 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:37:53.775575 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:37:53.776576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7208B200>]}
[0m14:37:53.776576 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.10s]
[0m14:37:53.777577 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.779888 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.779888 [debug] [MainThread]: On master: BEGIN
[0m14:37:53.780898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:53.850464 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m14:37:53.851465 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.851465 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.851465 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.852466 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:53.852466 [debug] [MainThread]: On master: Close
[0m14:37:53.853465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:53.853465 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:37:53.853465 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:37:53.853465 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_first_dbt_model' was properly closed.
[0m14:37:53.854464 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m14:37:53.854464 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:37:53.855469 [info ] [MainThread]: 
[0m14:37:53.856464 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m14:37:53.857465 [debug] [MainThread]: Command end result
[0m14:37:53.871465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:53.874473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:53.878473 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:37:53.878473 [info ] [MainThread]: 
[0m14:37:53.879473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:53.880475 [info ] [MainThread]: 
[0m14:37:53.881472 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:37:53.882473 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:53.882473 after 1.60 seconds
[0m14:37:53.882473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6DB79070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7077B6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6D2CCFE0>]}
[0m14:37:53.883471 [debug] [MainThread]: Flushing usage events
[0m14:37:54.285325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:16.270181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F9AFA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F90761B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F9AF9AF0>]}


============================== 15:27:16.274183 | d68fc3ba-0022-43f5-87db-339375df4ad9 ==============================
[0m15:27:16.274183 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:27:16.275182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:27:16.407710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd68fc3ba-0022-43f5-87db-339375df4ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F99C7E90>]}
[0m15:27:16.448716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd68fc3ba-0022-43f5-87db-339375df4ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F6F10C50>]}
[0m15:27:16.449715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:16.607465 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:27:16.727982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:27:16.727982 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\staging\stg_dvdrental_payments.sql
[0m15:27:16.728985 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\staging\stg_dvdrental_orders.sql
[0m15:27:16.856403 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_postgres_prj1.stg_dvdrental_orders' (models\staging\stg_dvdrental_orders.sql) depends on a source named 'dvdrental_source.order' which was not found
[0m15:27:16.857399 [debug] [MainThread]: Command `dbt run` failed at 15:27:16.857399 after 0.77 seconds
[0m15:27:16.858399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F99C7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F9CF96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FB345220>]}
[0m15:27:16.858399 [debug] [MainThread]: Flushing usage events
[0m15:27:17.257166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:24.107786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0E4B0>]}


============================== 15:28:24.110791 | 90618684-88cd-446d-856d-518be68d9faa ==============================
[0m15:28:24.110791 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:28:24.111790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:28:24.240872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86E6D370>]}
[0m15:28:24.278872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86EB4590>]}
[0m15:28:24.279872 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:28:24.440598 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:28:24.559850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:24.559850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:24.587275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0FB60>]}
[0m15:28:24.637098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:28:24.640099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:28:24.664341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C886D9760>]}
[0m15:28:24.664341 [info ] [MainThread]: Found 5 models, 4 data tests, 15 sources, 433 macros
[0m15:28:24.665335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C884ADD00>]}
[0m15:28:24.668331 [info ] [MainThread]: 
[0m15:28:24.668331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:28:24.669340 [info ] [MainThread]: 
[0m15:28:24.670089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:24.673110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m15:28:24.785955 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m15:28:24.786965 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m15:28:24.786965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:24.857511 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.070 seconds
[0m15:28:24.858513 [debug] [ThreadPool]: On list_dvdrental: Close
[0m15:28:24.859512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m15:28:24.864514 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:28:24.864514 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m15:28:24.864514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:24.924035 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m15:28:24.925035 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:28:24.926036 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:28:24.929035 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.003 seconds
[0m15:28:24.931037 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m15:28:24.931037 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m15:28:24.936451 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:24.937450 [debug] [MainThread]: On master: BEGIN
[0m15:28:24.937450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:24.998455 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:28:24.999459 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:24.999459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:25.004974 [debug] [MainThread]: SQL status: SELECT 38 in 0.005 seconds
[0m15:28:25.009973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C849CFAD0>]}
[0m15:28:25.009973 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:25.010972 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.010972 [debug] [MainThread]: On master: BEGIN
[0m15:28:25.011972 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:28:25.012975 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.012975 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.012975 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.013974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:28:25.013974 [debug] [MainThread]: On master: Close
[0m15:28:25.019973 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.019973 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.019973 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.019973 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.020975 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:28:25.021972 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m15:28:25.021972 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_dvdrental_orders ........................ [RUN]
[0m15:28:25.022971 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m15:28:25.021972 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m15:28:25.022971 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m15:28:25.023973 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_orders'
[0m15:28:25.023973 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.024971 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m15:28:25.024971 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.025975 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.029972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.029972 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.031972 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.033973 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.034972 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.035973 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.036971 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.062972 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.074971 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.075970 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.076978 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.078974 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.080974 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.080974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.081972 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.081972 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m15:28:25.082972 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m15:28:25.082972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:25.082972 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.083972 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.083972 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:28:25.084972 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m15:28:25.084972 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: BEGIN
[0m15:28:25.085970 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:28:25.085970 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:28:25.166603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m15:28:25.166603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.167598 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:28:25.170600 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m15:28:25.174599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.175599 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:28:25.175599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:28:25.177600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.178597 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:28:25.179596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.194606 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:28:25.195604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.195604 [debug] [Thread-2 (]: SQL status: BEGIN in 0.111 seconds
[0m15:28:25.195604 [debug] [Thread-4 (]: SQL status: BEGIN in 0.110 seconds
[0m15:28:25.196488 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m15:28:25.196488 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:28:25.196488 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.197498 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.197498 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.198498 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m15:28:25.198498 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payments as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m15:28:25.199500 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */

  create view "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m15:28:25.199500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:28:25.204011 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m15:28:25.204011 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:28:25.205009 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "source_payment" does not exist
LINE 14:  select * from source_payment
                        ^

[0m15:28:25.205009 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:28:25.208009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.210013 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.211008 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: ROLLBACK
[0m15:28:25.212013 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.213007 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:28:25.213007 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m15:28:25.214008 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
alter table "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp" rename to "stg_dvdrental_orders"
[0m15:28:25.214008 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m15:28:25.215008 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.216010 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.217009 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:28:25.217009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:28:25.220010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.220010 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.222010 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m15:28:25.222010 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m15:28:25.223009 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:28:25.225009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C83FB26F0>]}
[0m15:28:25.226008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.227010 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:28:25.226008 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m15:28:25.228009 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:28:25.229010 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_orders__dbt_backup"
[0m15:28:25.230010 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.230010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.233010 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.233010 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:28:25.234008 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.234008 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_orders__dbt_backup" cascade
[0m15:28:25.235009 [info ] [Thread-1 (]: 5 of 5 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:28:25.236009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m15:28:25.236009 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:28:25.236009 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:28:25.237008 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.238012 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m15:28:25.239008 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: Close
[0m15:28:25.240009 [debug] [Thread-4 (]: Database Error in model stg_dvdrental_payments (models\staging\stg_dvdrental_payments.sql)
  relation "source_payment" does not exist
  LINE 14:  select * from source_payment
                          ^
  compiled code at target\run\dbt_postgres_prj1\models\staging\stg_dvdrental_payments.sql
[0m15:28:25.242010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.242010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.243011 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88E57A10>]}
[0m15:28:25.243011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88E96360>]}
[0m15:28:25.244010 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m15:28:25.245009 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_dvdrental_orders ................... [[32mCREATE VIEW[0m in 0.22s]
[0m15:28:25.245009 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.245009 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model public.stg_dvdrental_payments ............. [[31mERROR[0m in 0.22s]
[0m15:28:25.246009 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.248012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.249013 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:28:25.249013 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.251009 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m15:28:25.251009 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.stg_dvdrental_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_dvdrental_payments (models\staging\stg_dvdrental_payments.sql)
  relation "source_payment" does not exist
  LINE 14:  select * from source_payment
                          ^
  compiled code at target\run\dbt_postgres_prj1\models\staging\stg_dvdrental_payments.sql.
[0m15:28:25.252008 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88DFD670>]}
[0m15:28:25.252008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.253009 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m15:28:25.253009 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m15:28:25.254008 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.254008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:25.319534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m15:28:25.320541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.321538 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:28:25.324536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:28:25.327534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.327534 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:28:25.327534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:28:25.330540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.331532 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:28:25.332276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.333284 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:28:25.334287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.334287 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:28:25.338467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:28:25.340475 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m15:28:25.340475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.341476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:28:25.343477 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:28:25.344476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m15:28:25.344476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88E383E0>]}
[0m15:28:25.345476 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m15:28:25.345476 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.347475 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.348477 [debug] [MainThread]: On master: BEGIN
[0m15:28:25.349478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:25.410733 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:28:25.411733 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.411733 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.412733 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.412733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:28:25.412733 [debug] [MainThread]: On master: Close
[0m15:28:25.413733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:25.413733 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m15:28:25.414733 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m15:28:25.414733 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m15:28:25.414733 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m15:28:25.415734 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_orders' was properly closed.
[0m15:28:25.415734 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m15:28:25.415734 [info ] [MainThread]: 
[0m15:28:25.417015 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m15:28:25.418027 [debug] [MainThread]: Command end result
[0m15:28:25.432023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:28:25.434661 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:28:25.438786 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m15:28:25.438786 [info ] [MainThread]: 
[0m15:28:25.440082 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:28:25.440082 [info ] [MainThread]: 
[0m15:28:25.441089 [error] [MainThread]:   Database Error in model stg_dvdrental_payments (models\staging\stg_dvdrental_payments.sql)
  relation "source_payment" does not exist
  LINE 14:  select * from source_payment
                          ^
  compiled code at target\run\dbt_postgres_prj1\models\staging\stg_dvdrental_payments.sql
[0m15:28:25.441089 [info ] [MainThread]: 
[0m15:28:25.442090 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:28:25.443088 [debug] [MainThread]: Command `dbt run` failed at 15:28:25.443088 after 1.48 seconds
[0m15:28:25.443088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C85B65BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C869D2FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0D490>]}
[0m15:28:25.444086 [debug] [MainThread]: Flushing usage events
[0m15:28:25.849923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:08.275764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162FC9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162FC8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162B19970>]}


============================== 15:29:08.278763 | cab59702-ed7d-4611-a143-3642ec22fcb9 ==============================
[0m15:29:08.278763 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:29:08.279763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:08.407638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163B0D700>]}
[0m15:29:08.447892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163979370>]}
[0m15:29:08.448891 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:08.595713 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:29:08.714958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:08.714958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:08.741488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163C9E960>]}
[0m15:29:08.795090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:29:08.798091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:29:08.818115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165360410>]}
[0m15:29:08.818115 [info ] [MainThread]: Found 5 models, 4 data tests, 15 sources, 433 macros
[0m15:29:08.819130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163DAA810>]}
[0m15:29:08.820114 [info ] [MainThread]: 
[0m15:29:08.822113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:08.822113 [info ] [MainThread]: 
[0m15:29:08.823119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:08.826113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m15:29:08.918225 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m15:29:08.919228 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m15:29:08.919228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:08.993728 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m15:29:08.995730 [debug] [ThreadPool]: On list_dvdrental: Close
[0m15:29:08.997729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m15:29:09.001729 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:29:09.001729 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m15:29:09.002730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:09.175868 [debug] [ThreadPool]: SQL status: BEGIN in 0.174 seconds
[0m15:29:09.177048 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:29:09.177557 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:29:09.180564 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.003 seconds
[0m15:29:09.181564 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m15:29:09.182568 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m15:29:09.187728 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.187728 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.187728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:09.256247 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m15:29:09.257247 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.257247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:09.261246 [debug] [MainThread]: SQL status: SELECT 39 in 0.004 seconds
[0m15:29:09.266247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163CCCD10>]}
[0m15:29:09.266247 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:09.267247 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.267247 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.268245 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:29:09.268245 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.269247 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.269247 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.269247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:09.270245 [debug] [MainThread]: On master: Close
[0m15:29:09.274244 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.274244 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.275250 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.275250 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.275250 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:29:09.276250 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m15:29:09.276250 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_dvdrental_orders ........................ [RUN]
[0m15:29:09.277243 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m15:29:09.277243 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m15:29:09.278243 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m15:29:09.278243 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_orders'
[0m15:29:09.279243 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.279243 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m15:29:09.280245 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.280245 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.284245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.285245 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.286245 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.288245 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.290245 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.291243 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.309759 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.315937 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.316944 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.328529 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.328529 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.331529 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.333770 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.333770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.334769 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.334769 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m15:29:09.335769 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.335769 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m15:29:09.335769 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:09.336771 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.336771 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: BEGIN
[0m15:29:09.336771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:29:09.337771 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m15:29:09.337771 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:29:09.338772 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:29:09.422194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m15:29:09.423198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.423198 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:29:09.426196 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m15:29:09.430195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.430195 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:29:09.431701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.433709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.433709 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:29:09.434711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:09.448708 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:29:09.448708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.449707 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:29:09.451709 [debug] [Thread-3 (]: SQL status: BEGIN in 0.114 seconds
[0m15:29:09.453759 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.453759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:29:09.454753 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */

  create view "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m15:29:09.458757 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m15:29:09.461757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.462757 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m15:29:09.462757 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:29:09.462757 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:29:09.463756 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.465756 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.466756 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m15:29:09.466756 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
alter table "dvdrental"."public"."stg_dvdrental_orders" rename to "stg_dvdrental_orders__dbt_backup"
[0m15:29:09.467754 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.469755 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.470755 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:29:09.470755 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:29:09.470755 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
alter table "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp" rename to "stg_dvdrental_orders"
[0m15:29:09.472756 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m15:29:09.474757 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.475756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:09.476755 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m15:29:09.477754 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:29:09.477754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165BC6D80>]}
[0m15:29:09.478964 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.478964 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.479969 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:29:09.479969 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m15:29:09.481461 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:29:09.483467 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.483467 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:29:09.483467 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.484467 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.486469 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_orders__dbt_backup"
[0m15:29:09.486469 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:29:09.487470 [info ] [Thread-1 (]: 5 of 5 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:29:09.489468 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.490475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m15:29:09.490475 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_orders__dbt_backup" cascade
[0m15:29:09.490475 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:29:09.491472 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.493467 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m15:29:09.493467 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:29:09.495610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.495610 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.497606 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: Close
[0m15:29:09.497606 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m15:29:09.498603 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165B2A450>]}
[0m15:29:09.498603 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.499604 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:29:09.499604 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_dvdrental_orders ................... [[32mCREATE VIEW[0m in 0.22s]
[0m15:29:09.502603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.503607 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m15:29:09.503607 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.505603 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165A9B290>]}
[0m15:29:09.506641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.505603 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m15:29:09.506641 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m15:29:09.507649 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.507649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:09.540839 [debug] [Thread-2 (]: SQL status: BEGIN in 0.204 seconds
[0m15:29:09.541842 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.541842 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m15:29:09.545843 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:29:09.547840 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.548839 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m15:29:09.548839 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.550838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.550838 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m15:29:09.551840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.552840 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:29:09.552840 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.553835 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:29:09.555840 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:29:09.556839 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m15:29:09.557841 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.557841 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m15:29:09.559838 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:29:09.560839 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m15:29:09.560839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165B3CCE0>]}
[0m15:29:09.562213 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.28s]
[0m15:29:09.562717 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.572724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m15:29:09.572724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.573723 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:29:09.577722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:29:09.579722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.580725 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:29:09.581728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.582725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.583724 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:29:09.584726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:09.585724 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:29:09.585724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.586723 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:29:09.588725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:29:09.589725 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m15:29:09.590725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.590725 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:29:09.592725 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:29:09.593725 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m15:29:09.594724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165BAFBC0>]}
[0m15:29:09.594724 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.10s]
[0m15:29:09.595724 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.596722 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.596722 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.597723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:09.770721 [debug] [MainThread]: SQL status: BEGIN in 0.173 seconds
[0m15:29:09.771716 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.771716 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.771716 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.772715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:09.772715 [debug] [MainThread]: On master: Close
[0m15:29:09.773713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:09.773713 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m15:29:09.773713 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_orders' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m15:29:09.775712 [info ] [MainThread]: 
[0m15:29:09.776710 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:29:09.777712 [debug] [MainThread]: Command end result
[0m15:29:09.791712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:29:09.793715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:29:09.798711 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m15:29:09.798711 [info ] [MainThread]: 
[0m15:29:09.799708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:09.800710 [info ] [MainThread]: 
[0m15:29:09.801710 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:29:09.802710 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:09.802710 after 1.66 seconds
[0m15:29:09.802710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165507680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162C10FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163A054F0>]}
[0m15:29:09.803709 [debug] [MainThread]: Flushing usage events
[0m15:29:10.200135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:18.076277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025813FE6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025811F5DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025811F5ED80>]}


============================== 16:45:18.079281 | 9d197a54-df88-4010-9dd9-8e18608e7f89 ==============================
[0m16:45:18.079281 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:45:18.080280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:18.216927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025814AB74A0>]}
[0m16:45:18.265586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025814AB4950>]}
[0m16:45:18.266586 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:45:18.420128 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:45:18.532693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:18.532693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:18.560218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258151234A0>]}
[0m16:45:18.609529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:45:18.614129 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:45:18.636394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258162A6120>]}
[0m16:45:18.637394 [info ] [MainThread]: Found 6 models, 4 data tests, 15 sources, 433 macros
[0m16:45:18.638394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002581645A150>]}
[0m16:45:18.641396 [info ] [MainThread]: 
[0m16:45:18.642395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:18.642395 [info ] [MainThread]: 
[0m16:45:18.643395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:18.647395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m16:45:18.764023 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m16:45:18.764023 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m16:45:18.764023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.835700 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.072 seconds
[0m16:45:18.836718 [debug] [ThreadPool]: On list_dvdrental: Close
[0m16:45:18.838716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m16:45:18.842723 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:45:18.843718 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m16:45:18.844629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:19.016785 [debug] [ThreadPool]: SQL status: BEGIN in 0.173 seconds
[0m16:45:19.017794 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:45:19.018787 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:45:19.022801 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m16:45:19.023796 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m16:45:19.024800 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m16:45:19.029798 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.030802 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.030802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:19.090804 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m16:45:19.091816 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.092803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:19.097803 [debug] [MainThread]: SQL status: SELECT 40 in 0.004 seconds
[0m16:45:19.101803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258151227B0>]}
[0m16:45:19.102803 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:19.103802 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.103802 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.105450 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:45:19.105450 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.106472 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.106472 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.107477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:19.107477 [debug] [MainThread]: On master: Close
[0m16:45:19.112464 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.112464 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.113465 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.113465 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.114467 [info ] [Thread-1 (]: 1 of 6 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:45:19.115469 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m16:45:19.115469 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m16:45:19.116463 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m16:45:19.116463 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m16:45:19.117467 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m16:45:19.117467 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m16:45:19.118468 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.118468 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals'
[0m16:45:19.118468 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.119465 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.123474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.124474 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.126474 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.128472 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.130472 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.131473 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.132476 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.132476 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.156989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.156989 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.169642 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.172640 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.174641 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.175641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.176642 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m16:45:19.176642 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.176642 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.177641 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:45:19.177641 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m16:45:19.177641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.178642 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m16:45:19.178642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:45:19.179642 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m16:45:19.179642 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:19.180642 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:19.261159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m16:45:19.262159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.262159 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:45:19.266158 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m16:45:19.275168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.275168 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:45:19.276159 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m16:45:19.276159 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m16:45:19.276159 [debug] [Thread-2 (]: SQL status: BEGIN in 0.097 seconds
[0m16:45:19.277159 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.277159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:19.277159 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.278158 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.278158 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m16:45:19.280160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.281158 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m16:45:19.281158 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m16:45:19.281158 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:45:19.283160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.296161 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:45:19.296161 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m16:45:19.297160 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m16:45:19.297160 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m16:45:19.297160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.299161 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.302158 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.303158 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.304162 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:45:19.304162 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m16:45:19.305159 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m16:45:19.305159 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m16:45:19.306158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.306158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.307161 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.308160 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.309159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:45:19.310163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.311159 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:45:19.312160 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m16:45:19.316160 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m16:45:19.317158 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m16:45:19.317158 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.320160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.321158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:45:19.321158 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:45:19.322162 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:19.322162 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:45:19.323163 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:45:19.324161 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:45:19.324161 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:19.325162 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.325162 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.327161 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m16:45:19.327161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:45:19.327161 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:45:19.327161 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:45:19.330163 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.331167 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m16:45:19.332571 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m16:45:19.332571 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:19.332571 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m16:45:19.334576 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m16:45:19.337087 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m16:45:19.337087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025813F55910>]}
[0m16:45:19.338085 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.338085 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:45:19.339086 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.340085 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m16:45:19.339086 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:45:19.341087 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m16:45:19.341087 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m16:45:19.342085 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.342085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025815095BE0>]}
[0m16:45:19.343085 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.344086 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:45:19.344086 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:45:19.344086 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.22s]
[0m16:45:19.346086 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m16:45:19.345090 [info ] [Thread-1 (]: 5 of 6 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m16:45:19.347086 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m16:45:19.348085 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.348085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816A96630>]}
[0m16:45:19.348085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m16:45:19.349086 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816B27FE0>]}
[0m16:45:19.350085 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.350085 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:45:19.353085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.351087 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m16:45:19.353085 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.354084 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.355085 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.customers
[0m16:45:19.355085 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.358090 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.356086 [info ] [Thread-4 (]: 6 of 6 START sql view model public.customers ................................... [RUN]
[0m16:45:19.359084 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_rentals, now model.dbt_postgres_prj1.customers)
[0m16:45:19.359084 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m16:45:19.362086 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m16:45:19.362086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.363085 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m16:45:19.363085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:19.364087 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.customers
[0m16:45:19.366086 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m16:45:19.368086 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:45:19.368086 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m16:45:19.368086 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:45:19.435092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m16:45:19.436092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.436599 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m16:45:19.436599 [debug] [Thread-4 (]: SQL status: BEGIN in 0.068 seconds
[0m16:45:19.437604 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:45:19.437604 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_rental,
        customer_orders.most_recent_rental,
        customer_orders.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m16:45:19.439608 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:45:19.442604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.442604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m16:45:19.443604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:19.444609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.445607 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "customer_orders" does not exist
LINE 67:     left join customer_orders
                       ^

[0m16:45:19.445607 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:45:19.446604 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: ROLLBACK
[0m16:45:19.446604 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: Close
[0m16:45:19.447605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.449604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:45:19.449604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.450604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:45:19.451603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:19.452610 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m16:45:19.453607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.453607 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:45:19.455604 [debug] [Thread-4 (]: Database Error in model customers (models\intermediate\customers.sql)
  relation "customer_orders" does not exist
  LINE 67:     left join customer_orders
                         ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:45:19.456604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:45:19.456604 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816B5DA30>]}
[0m16:45:19.457604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m16:45:19.458605 [error] [Thread-4 (]: 6 of 6 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.10s]
[0m16:45:19.458605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258169AEA80>]}
[0m16:45:19.459605 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.customers
[0m16:45:19.459605 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m16:45:19.460604 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (models\intermediate\customers.sql)
  relation "customer_orders" does not exist
  LINE 67:     left join customer_orders
                         ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql.
[0m16:45:19.461604 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.463604 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.463604 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.464604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:19.526617 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m16:45:19.527615 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.528616 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.528616 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.528616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:19.529616 [debug] [MainThread]: On master: Close
[0m16:45:19.529616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m16:45:19.531617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m16:45:19.531617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m16:45:19.531617 [info ] [MainThread]: 
[0m16:45:19.532617 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m16:45:19.533616 [debug] [MainThread]: Command end result
[0m16:45:19.548646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:45:19.550646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:45:19.556644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m16:45:19.556644 [info ] [MainThread]: 
[0m16:45:19.557645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:45:19.557645 [info ] [MainThread]: 
[0m16:45:19.558644 [error] [MainThread]:   Database Error in model customers (models\intermediate\customers.sql)
  relation "customer_orders" does not exist
  LINE 67:     left join customer_orders
                         ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:45:19.559646 [info ] [MainThread]: 
[0m16:45:19.560645 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:45:19.560645 [debug] [MainThread]: Command `dbt run` failed at 16:45:19.560645 after 1.65 seconds
[0m16:45:19.561645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258110A91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025812598CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025813FE6FF0>]}
[0m16:45:19.561645 [debug] [MainThread]: Flushing usage events
[0m16:45:19.865658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:09.377025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB32E3D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB394B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB3949A60>]}


============================== 16:46:09.380025 | a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5 ==============================
[0m16:46:09.380025 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:46:09.381025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:46:09.509449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB40DBFB0>]}
[0m16:46:09.548503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB4251850>]}
[0m16:46:09.549504 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:46:09.702035 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:46:09.820790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:09.821800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:09.847780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB4209BB0>]}
[0m16:46:09.900354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:46:09.903354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:46:09.923658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB5A76690>]}
[0m16:46:09.924658 [info ] [MainThread]: Found 6 models, 4 data tests, 15 sources, 433 macros
[0m16:46:09.925649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB420A810>]}
[0m16:46:09.927648 [info ] [MainThread]: 
[0m16:46:09.927648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:09.928648 [info ] [MainThread]: 
[0m16:46:09.929647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:09.931647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m16:46:10.027177 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m16:46:10.027177 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m16:46:10.028177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:10.097226 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m16:46:10.099228 [debug] [ThreadPool]: On list_dvdrental: Close
[0m16:46:10.100225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m16:46:10.104226 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:46:10.105226 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m16:46:10.105226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:10.164761 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m16:46:10.166147 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:46:10.166147 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:46:10.170163 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.003 seconds
[0m16:46:10.172149 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m16:46:10.173150 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m16:46:10.178146 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.179154 [debug] [MainThread]: On master: BEGIN
[0m16:46:10.179154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:10.239146 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m16:46:10.240146 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.241146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:10.245145 [debug] [MainThread]: SQL status: SELECT 41 in 0.004 seconds
[0m16:46:10.250160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB3E355B0>]}
[0m16:46:10.251160 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:10.251160 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.251160 [debug] [MainThread]: On master: BEGIN
[0m16:46:10.252718 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:46:10.252718 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.252718 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.253728 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.253728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:46:10.253728 [debug] [MainThread]: On master: Close
[0m16:46:10.259728 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.259728 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.259728 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.260767 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.260767 [info ] [Thread-1 (]: 1 of 6 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:46:10.261726 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m16:46:10.262732 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m16:46:10.261726 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m16:46:10.262732 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m16:46:10.261726 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m16:46:10.263727 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.263727 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m16:46:10.264731 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.264731 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals'
[0m16:46:10.269246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.269246 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.271247 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.271247 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.273249 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.277250 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.277250 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.278246 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.288247 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.302528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.315527 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.317528 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.317528 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.320531 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.321529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.321529 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m16:46:10.322529 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.322529 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.322529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:10.323528 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m16:46:10.324528 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.324528 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m16:46:10.325528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:46:10.325528 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m16:46:10.325528 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:46:10.326529 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:46:10.413395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m16:46:10.414395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.414395 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:46:10.416393 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m16:46:10.417393 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.417393 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m16:46:10.418396 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m16:46:10.423396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.423396 [debug] [Thread-2 (]: SQL status: BEGIN in 0.098 seconds
[0m16:46:10.424394 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m16:46:10.425398 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:46:10.425398 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.426397 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.426397 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m16:46:10.426397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.426397 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:46:10.427398 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m16:46:10.429396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.431399 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.431399 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:46:10.432397 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:46:10.432397 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m16:46:10.434397 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.434397 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:46:10.435398 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.435398 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m16:46:10.436400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.437399 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.439394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.451445 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:46:10.452445 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m16:46:10.452445 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m16:46:10.453445 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m16:46:10.453445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.455444 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.455444 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:46:10.456445 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.456445 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.456445 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m16:46:10.459446 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.462128 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:46:10.462128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:46:10.463138 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m16:46:10.463138 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.463138 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.468646 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m16:46:10.469646 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:46:10.469646 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.470646 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:46:10.473645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.473645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.474646 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:46:10.475646 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:46:10.476180 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:46:10.476180 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:46:10.476180 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.479190 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m16:46:10.479190 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:46:10.479190 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:46:10.480190 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:46:10.482186 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.483188 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m16:46:10.485188 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m16:46:10.485188 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m16:46:10.486187 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:46:10.486187 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.488188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB6207B30>]}
[0m16:46:10.489188 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m16:46:10.490186 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:46:10.490186 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m16:46:10.491188 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.490186 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:46:10.492187 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m16:46:10.493197 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m16:46:10.493197 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.494198 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:46:10.494198 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB62CCF80>]}
[0m16:46:10.495188 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.496187 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m16:46:10.496187 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:46:10.497187 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:46:10.497187 [info ] [Thread-1 (]: 5 of 6 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m16:46:10.498189 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB6253BF0>]}
[0m16:46:10.499188 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m16:46:10.500195 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.501192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m16:46:10.501192 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.24s]
[0m16:46:10.502188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB60DA240>]}
[0m16:46:10.503188 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.503188 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.506294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.504188 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:46:10.507298 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.507298 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m16:46:10.508299 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.511305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.508299 [info ] [Thread-3 (]: 6 of 6 START sql view model public.customers ................................... [RUN]
[0m16:46:10.512304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m16:46:10.512304 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m16:46:10.514309 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m16:46:10.515303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.515303 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m16:46:10.516298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:10.516298 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m16:46:10.518302 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m16:46:10.519301 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:46:10.520298 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m16:46:10.520298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:46:10.586022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m16:46:10.587020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.587020 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m16:46:10.590019 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m16:46:10.590019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:46:10.590019 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:46:10.593021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.593021 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_rental,
        customer_orders.most_recent_rental,
        customer_orders.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m16:46:10.593021 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m16:46:10.594021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.596021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.596021 [debug] [Thread-3 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_orders"
LINE 60:         customer_orders.first_rental,
                 ^

[0m16:46:10.597020 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:46:10.597020 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: ROLLBACK
[0m16:46:10.598020 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m16:46:10.599021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.600022 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:46:10.601024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.601024 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:46:10.604022 [debug] [Thread-3 (]: Database Error in model customers (models\intermediate\customers.sql)
  missing FROM-clause entry for table "customer_orders"
  LINE 60:         customer_orders.first_rental,
                   ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:46:10.605021 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB6313CB0>]}
[0m16:46:10.605021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:46:10.605021 [error] [Thread-3 (]: 6 of 6 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.09s]
[0m16:46:10.608021 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m16:46:10.609018 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m16:46:10.609018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.610029 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (models\intermediate\customers.sql)
  missing FROM-clause entry for table "customer_orders"
  LINE 60:         customer_orders.first_rental,
                   ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql.
[0m16:46:10.610029 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:46:10.613023 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:46:10.614021 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m16:46:10.614021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB632FE00>]}
[0m16:46:10.615018 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m16:46:10.616019 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.618020 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.618020 [debug] [MainThread]: On master: BEGIN
[0m16:46:10.619023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:10.796647 [debug] [MainThread]: SQL status: BEGIN in 0.178 seconds
[0m16:46:10.796647 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.797648 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.797648 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.798653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:46:10.798653 [debug] [MainThread]: On master: Close
[0m16:46:10.799645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:10.799645 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m16:46:10.799645 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m16:46:10.799645 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m16:46:10.800645 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m16:46:10.800645 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m16:46:10.801652 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m16:46:10.801652 [info ] [MainThread]: 
[0m16:46:10.803007 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m16:46:10.805017 [debug] [MainThread]: Command end result
[0m16:46:10.819013 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:46:10.822015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:46:10.827012 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m16:46:10.827012 [info ] [MainThread]: 
[0m16:46:10.828013 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:46:10.828013 [info ] [MainThread]: 
[0m16:46:10.829016 [error] [MainThread]:   Database Error in model customers (models\intermediate\customers.sql)
  missing FROM-clause entry for table "customer_orders"
  LINE 60:         customer_orders.first_rental,
                   ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:46:10.830015 [info ] [MainThread]: 
[0m16:46:10.830015 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:46:10.831017 [debug] [MainThread]: Command `dbt run` failed at 16:46:10.831017 after 1.59 seconds
[0m16:46:10.831017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB32E3D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB3C0EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB09D29F0>]}
[0m16:46:10.832013 [debug] [MainThread]: Flushing usage events
[0m16:46:11.126141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:07.022355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BCA52B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BA46C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BA47DA0>]}


============================== 16:47:07.026358 | aa520693-d7dc-44bf-99bf-490009000214 ==============================
[0m16:47:07.026358 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:47:07.027355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:47:07.160672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BF0DC40>]}
[0m16:47:07.200193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0912CBF0>]}
[0m16:47:07.201190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:47:07.354779 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:47:07.471063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:07.472066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:07.499595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0B898AA0>]}
[0m16:47:07.552477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:47:07.556464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:47:07.575463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0D8CA0C0>]}
[0m16:47:07.576464 [info ] [MainThread]: Found 6 models, 4 data tests, 15 sources, 433 macros
[0m16:47:07.576464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0D8C5F10>]}
[0m16:47:07.578469 [info ] [MainThread]: 
[0m16:47:07.579466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:07.579466 [info ] [MainThread]: 
[0m16:47:07.580464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:07.583469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m16:47:07.679994 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m16:47:07.679994 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m16:47:07.680995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:07.754811 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m16:47:07.755811 [debug] [ThreadPool]: On list_dvdrental: Close
[0m16:47:07.756810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m16:47:07.760810 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:47:07.761813 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m16:47:07.761813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:07.936595 [debug] [ThreadPool]: SQL status: BEGIN in 0.175 seconds
[0m16:47:07.937595 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:47:07.937595 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:47:07.941596 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.003 seconds
[0m16:47:07.942637 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m16:47:07.942637 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m16:47:07.948595 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:07.948595 [debug] [MainThread]: On master: BEGIN
[0m16:47:07.949593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:08.011432 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m16:47:08.012516 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.013466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:08.018432 [debug] [MainThread]: SQL status: SELECT 41 in 0.004 seconds
[0m16:47:08.023431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BF0F050>]}
[0m16:47:08.023431 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:08.024431 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.024431 [debug] [MainThread]: On master: BEGIN
[0m16:47:08.025309 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:47:08.026323 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.026323 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.026323 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.027321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:08.027321 [debug] [MainThread]: On master: Close
[0m16:47:08.031320 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.032323 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.032323 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.032323 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.033320 [info ] [Thread-1 (]: 1 of 6 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:47:08.033320 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m16:47:08.034320 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m16:47:08.035319 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m16:47:08.034320 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m16:47:08.035319 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m16:47:08.036321 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m16:47:08.036321 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.036321 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals'
[0m16:47:08.037319 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.037319 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.041319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.042319 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.044344 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.046353 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.048352 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.049351 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.059350 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.074353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.074353 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.074353 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.088359 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.090361 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.093364 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.095362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.096364 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.096364 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.096364 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m16:47:08.096364 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.097873 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m16:47:08.097873 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m16:47:08.097873 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:08.098883 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m16:47:08.098883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:47:08.099881 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:47:08.099881 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:47:08.183103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m16:47:08.183103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.184092 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:47:08.187087 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m16:47:08.191084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.192084 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m16:47:08.192084 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:47:08.193084 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.193084 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m16:47:08.194083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.196081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.196081 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:47:08.196081 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m16:47:08.197080 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:47:08.197080 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.198585 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.199591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:47:08.199591 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m16:47:08.199591 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m16:47:08.200593 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m16:47:08.213590 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:47:08.214596 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.214596 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.214596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.215592 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m16:47:08.215592 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:47:08.217593 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.217593 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:47:08.219595 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m16:47:08.220595 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:47:08.224592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.224592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:47:08.226596 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.226596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:47:08.227594 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m16:47:08.231588 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m16:47:08.231588 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m16:47:08.233598 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:47:08.238591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.238591 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:47:08.239590 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.239590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.239590 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:47:08.241592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.241592 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:47:08.243591 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.243591 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m16:47:08.244589 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m16:47:08.245590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.245590 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:08.245590 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:08.246593 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:47:08.247593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:47:08.248594 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:47:08.250035 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m16:47:08.251044 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.252044 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m16:47:08.253033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.255030 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.255030 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:47:08.256031 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:47:08.257033 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m16:47:08.257033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DEA55B0>]}
[0m16:47:08.259032 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:08.258035 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:47:08.261031 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m16:47:08.261031 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m16:47:08.261031 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:47:08.262032 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.262032 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.264036 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m16:47:08.265031 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m16:47:08.265031 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.266031 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m16:47:08.266031 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.267034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DEF2420>]}
[0m16:47:08.267034 [info ] [Thread-1 (]: 5 of 6 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m16:47:08.268031 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m16:47:08.269031 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:47:08.269031 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m16:47:08.269031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m16:47:08.271032 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m16:47:08.271032 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.271032 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:47:08.272033 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.272033 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DEBD1F0>]}
[0m16:47:08.273035 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m16:47:08.275032 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.277032 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DE25550>]}
[0m16:47:08.276032 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:47:08.277032 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:47:08.278033 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.278033 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.279032 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.282035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.282035 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.customers
[0m16:47:08.283040 [info ] [Thread-2 (]: 6 of 6 START sql view model public.customers ................................... [RUN]
[0m16:47:08.283040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.customers)
[0m16:47:08.284048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.284048 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m16:47:08.284048 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m16:47:08.286049 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m16:47:08.287048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:08.288048 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.customers
[0m16:47:08.290050 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m16:47:08.292049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.292049 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m16:47:08.292049 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:47:08.353185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.061 seconds
[0m16:47:08.354186 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.355186 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m16:47:08.364772 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:47:08.366779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.366779 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m16:47:08.367778 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.368779 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m16:47:08.368779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.369778 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m16:47:08.370763 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:08.372770 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m16:47:08.372770 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.373768 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m16:47:08.374770 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:47:08.375770 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: Close
[0m16:47:08.376768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DFAE750>]}
[0m16:47:08.377775 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m16:47:08.377775 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.customers
[0m16:47:08.453477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m16:47:08.454494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.455516 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m16:47:08.458478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:47:08.461476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.461476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m16:47:08.462477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.464478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.464478 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:47:08.465476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:08.467479 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:47:08.467479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.467479 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:47:08.471873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:47:08.473872 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m16:47:08.473872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.473872 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:47:08.475871 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:47:08.476872 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m16:47:08.477871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DF9BEF0>]}
[0m16:47:08.477871 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.21s]
[0m16:47:08.479870 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.481871 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.482871 [debug] [MainThread]: On master: BEGIN
[0m16:47:08.483876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:08.549387 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m16:47:08.549387 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.550387 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.550387 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.551387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:08.551387 [debug] [MainThread]: On master: Close
[0m16:47:08.551387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:08.552387 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m16:47:08.552387 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m16:47:08.552387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m16:47:08.553387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m16:47:08.553387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m16:47:08.553387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m16:47:08.554388 [info ] [MainThread]: 
[0m16:47:08.554388 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m16:47:08.556393 [debug] [MainThread]: Command end result
[0m16:47:08.570386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:47:08.572388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:47:08.577387 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m16:47:08.577387 [info ] [MainThread]: 
[0m16:47:08.578386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:08.578386 [info ] [MainThread]: 
[0m16:47:08.579387 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:47:08.580387 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:08.580387 after 1.68 seconds
[0m16:47:08.581393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BDC60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B093EAAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BC0F650>]}
[0m16:47:08.581393 [debug] [MainThread]: Flushing usage events
[0m16:47:08.922234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:00.136007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF57653320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF575E7B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF575E7AD0>]}


============================== 10:10:00.140008 | a3d24c8f-fefe-48eb-b52a-f213da484f7b ==============================
[0m10:10:00.140008 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:00.140306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:10:00.268127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56ABBFE0>]}
[0m10:10:00.309005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56F43E30>]}
[0m10:10:00.310005 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:10:00.457544 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:10:00.574268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:00.575317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:00.601279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF581FE4E0>]}
[0m10:10:00.650224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:10:00.654214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:10:00.675211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF581FDCD0>]}
[0m10:10:00.676212 [info ] [MainThread]: Found 7 models, 4 data tests, 15 sources, 433 macros
[0m10:10:00.676212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5951AE70>]}
[0m10:10:00.678210 [info ] [MainThread]: 
[0m10:10:00.679210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:00.680210 [info ] [MainThread]: 
[0m10:10:00.681211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:00.684210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:10:00.802259 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:10:00.802259 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:10:00.802259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:00.867747 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m10:10:00.868756 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:10:00.871747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:10:00.875756 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:10:00.876753 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:10:00.876753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:00.936918 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m10:10:00.937918 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:10:00.937918 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:00.940918 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.003 seconds
[0m10:10:00.942919 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:10:00.942919 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:10:00.948924 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:00.949919 [debug] [MainThread]: On master: BEGIN
[0m10:10:00.949919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:01.013818 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m10:10:01.014819 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.015818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:10:01.020877 [debug] [MainThread]: SQL status: SELECT 44 in 0.004 seconds
[0m10:10:01.025875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59597A40>]}
[0m10:10:01.025875 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:01.026876 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.026876 [debug] [MainThread]: On master: BEGIN
[0m10:10:01.027876 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:10:01.028876 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.028876 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.029876 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.030876 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:01.030876 [debug] [MainThread]: On master: Close
[0m10:10:01.035878 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.035878 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.035878 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.035878 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.036876 [info ] [Thread-1 (]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:10:01.036876 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:10:01.037876 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:10:01.037876 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:10:01.038876 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:10:01.038876 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:10:01.039876 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:10:01.039876 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:10:01.039876 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.040876 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.040876 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.040876 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.045875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.046876 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.048876 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.050876 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.051876 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.051876 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.064875 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.074876 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.074876 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.088939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.090939 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.093939 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.094940 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.094940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.095939 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:10:01.096939 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.096939 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:10:01.096939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:10:01.097944 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:10:01.097944 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.097944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:10:01.098939 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:10:01.098939 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:10:01.099939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:10:01.183146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.085 seconds
[0m10:10:01.183146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.184153 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:10:01.191165 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:10:01.195165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.196165 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:10:01.196165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m10:10:01.197165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.098 seconds
[0m10:10:01.197165 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m10:10:01.197165 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.198165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.198165 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.199165 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.200165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.201164 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:10:01.201164 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:10:01.202165 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:10:01.202165 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:10:01.203678 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.213750 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:10:01.213750 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:10:01.213750 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m10:10:01.214750 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:10:01.214750 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.216749 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.218750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.219750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.220749 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:10:01.220749 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:10:01.221750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:10:01.221750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:10:01.222746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.223749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.223749 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.224749 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:10:01.224749 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m10:10:01.226749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.228750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.229750 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.232751 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:10:01.233750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:10:01.233750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:10:01.234750 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:10:01.237749 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.238760 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.238760 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:10:01.239760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.240752 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:10:01.240752 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m10:10:01.243754 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:10:01.243754 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:10:01.244750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.245750 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:10:01.246750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.247750 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:10:01.248750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:10:01.248750 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.249750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:10:01.250750 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:10:01.251748 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59B94470>]}
[0m10:10:01.251748 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.252753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.252753 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:10:01.252753 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.21s]
[0m10:10:01.254752 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:10:01.255750 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:10:01.256750 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:10:01.257750 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.257750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.259750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.260749 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59A53920>]}
[0m10:10:01.260749 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.261750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:10:01.261750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:10:01.262752 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.22s]
[0m10:10:01.262752 [info ] [Thread-2 (]: 5 of 7 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:10:01.264204 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.264204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:10:01.265469 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.267492 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.267492 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:10:01.267492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:10:01.268499 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:10:01.269497 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:10:01.270479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59A50D70>]}
[0m10:10:01.270479 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.270479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59B56D50>]}
[0m10:10:01.271479 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:10:01.273485 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.274566 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m10:10:01.274566 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.275995 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.276506 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.276506 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.277520 [info ] [Thread-3 (]: 6 of 7 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:10:01.277520 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:10:01.278515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:10:01.278515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:01.279515 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.281519 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.282514 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.284517 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.285844 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.285844 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:10:01.286849 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:01.355851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.077 seconds
[0m10:10:01.355851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.356852 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:10:01.356852 [debug] [Thread-3 (]: SQL status: BEGIN in 0.071 seconds
[0m10:10:01.357852 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.357852 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:10:01.358850 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:10:01.361851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.361851 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:10:01.361851 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:10:01.363854 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.364855 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:10:01.364855 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.367853 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.367853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:10:01.367853 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:10:01.369848 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.370848 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:10:01.370848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.371849 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:10:01.371849 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.372851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.373851 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:10:01.373851 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:10:01.373851 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.374849 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:10:01.376049 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.376555 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.377562 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:10:01.378561 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:10:01.379561 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.380559 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.380559 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:10:01.381560 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:10:01.382560 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:10:01.383560 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:10:01.384569 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:10:01.384569 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59C0D5B0>]}
[0m10:10:01.385560 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:10:01.386560 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.12s]
[0m10:10:01.386560 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59C18200>]}
[0m10:10:01.387560 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.387560 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m10:10:01.388559 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:10:01.388559 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.389564 [info ] [Thread-1 (]: 7 of 7 START sql view model public.customers ................................... [RUN]
[0m10:10:01.389564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.customers)
[0m10:10:01.390564 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:10:01.392566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:10:01.393563 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:10:01.395568 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:10:01.397564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.397564 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:10:01.397564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:01.459307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m10:10:01.461302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.461302 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:10:01.465306 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:10:01.467306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.468307 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:10:01.468307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.469306 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:10:01.470306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.470306 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:10:01.474434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:10:01.477450 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:10:01.478450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.478450 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:10:01.479450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:10:01.479450 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:10:01.480450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59B8A870>]}
[0m10:10:01.481450 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m10:10:01.481450 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:10:01.483455 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.483455 [debug] [MainThread]: On master: BEGIN
[0m10:10:01.483455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:01.543990 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m10:10:01.544990 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.544990 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.545990 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.545990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:01.546989 [debug] [MainThread]: On master: Close
[0m10:10:01.546989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:10:01.548990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:10:01.548990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m10:10:01.548990 [info ] [MainThread]: 
[0m10:10:01.549988 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m10:10:01.551001 [debug] [MainThread]: Command end result
[0m10:10:01.565989 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:10:01.568990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:10:01.572995 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:10:01.572995 [info ] [MainThread]: 
[0m10:10:01.573990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:01.573990 [info ] [MainThread]: 
[0m10:10:01.574990 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:10:01.574990 [debug] [MainThread]: Command `dbt run` succeeded at 10:10:01.574990 after 1.60 seconds
[0m10:10:01.575989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF572594C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56F976E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56F97BF0>]}
[0m10:10:01.575989 [debug] [MainThread]: Flushing usage events
[0m10:10:02.023735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:59.878743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6199AEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6213D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B655A0AD0>]}


============================== 10:10:59.881743 | 3def158e-5d1f-40f4-8754-6c1e8b4b6fbb ==============================
[0m10:10:59.881743 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:59.882745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:11:00.012291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65A724E0>]}
[0m10:11:00.051819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B64F45670>]}
[0m10:11:00.052820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:11:00.197365 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:11:00.317279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:00.317279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:00.344839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B660EDD90>]}
[0m10:11:00.399835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:11:00.405840 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:11:00.427855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B672314F0>]}
[0m10:11:00.428858 [info ] [MainThread]: Found 8 models, 4 data tests, 15 sources, 433 macros
[0m10:11:00.428858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B672ED670>]}
[0m10:11:00.430857 [info ] [MainThread]: 
[0m10:11:00.431857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:11:00.431857 [info ] [MainThread]: 
[0m10:11:00.432857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:11:00.435395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:11:00.525407 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:11:00.526406 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:11:00.526406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:00.712589 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.186 seconds
[0m10:11:00.713595 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:11:00.714589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:11:00.718589 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:11:00.719602 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:11:00.719602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:00.780120 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m10:11:00.781124 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:11:00.781124 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:11:00.784125 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m10:11:00.786122 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:11:00.786122 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:11:00.791120 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.792120 [debug] [MainThread]: On master: BEGIN
[0m10:11:00.792120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:00.854059 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m10:11:00.855094 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.856071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:11:00.860059 [debug] [MainThread]: SQL status: SELECT 45 in 0.004 seconds
[0m10:11:00.865062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67230F50>]}
[0m10:11:00.866060 [debug] [MainThread]: On master: ROLLBACK
[0m10:11:00.866060 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.866060 [debug] [MainThread]: On master: BEGIN
[0m10:11:00.867061 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:11:00.867061 [debug] [MainThread]: On master: COMMIT
[0m10:11:00.868060 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.868060 [debug] [MainThread]: On master: COMMIT
[0m10:11:00.868060 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:00.869057 [debug] [MainThread]: On master: Close
[0m10:11:00.874057 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:00.874057 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:00.875059 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:00.875059 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:00.875059 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:11:00.876062 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:11:00.876062 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:11:00.877058 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:11:00.877058 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:11:00.878057 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:11:00.879058 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:11:00.879058 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:11:00.880058 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:00.880058 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:00.880058 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:00.881058 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:00.885059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:00.887060 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:00.888264 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:00.889263 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:00.891261 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:00.909262 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:00.915693 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:00.929698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:00.929698 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:00.930698 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:00.932700 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:00.933697 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:00.933697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:00.936210 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:00.936210 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:11:00.937207 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:11:00.937207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:00.938209 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:11:00.938209 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:11:00.938209 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:11:00.939206 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:00.939206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:11:00.940206 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:11:00.941207 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:11:01.029705 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m10:11:01.030707 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.030707 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:11:01.032706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m10:11:01.033705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.033705 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m10:11:01.034706 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:11:01.034706 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:11:01.034706 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.039864 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.040865 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m10:11:01.041247 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:11:01.041247 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m10:11:01.041247 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:11:01.044255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.044255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.045253 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:11:01.045253 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.045253 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:11:01.046253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.048255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.048255 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:11:01.050255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.050255 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:11:01.050255 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:11:01.053254 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.053254 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:11:01.055256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.055256 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:01.056253 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m10:11:01.056253 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:11:01.066252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:11:01.067256 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:11:01.070253 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:11:01.070253 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:11:01.071253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:11:01.071253 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.071253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.074255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.076256 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.076256 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:11:01.076256 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:11:01.077254 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:11:01.077254 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:11:01.078254 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.078254 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.079254 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:11:01.079254 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:11:01.080254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:11:01.081255 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:11:01.081255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.085256 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:11:01.087258 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:11:01.087258 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.087258 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:11:01.091255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.093255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.093255 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:11:01.093255 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:11:01.094255 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:11:01.095254 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:11:01.095254 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:11:01.097255 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:11:01.097255 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:11:01.097255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:11:01.099260 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:11:01.100255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.101254 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:11:01.102254 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:11:01.103256 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.103256 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:11:01.105254 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:11:01.105254 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B62B42A50>]}
[0m10:11:01.105254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6795B080>]}
[0m10:11:01.106255 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m10:11:01.107255 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m10:11:01.108254 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:01.108254 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:01.109254 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.109254 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:11:01.110255 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:11:01.110255 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.111255 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:11:01.112255 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:11:01.113256 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:11:01.114262 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_dverental_inventory ..................... [RUN]
[0m10:11:01.114262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:11:01.115254 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67964860>]}
[0m10:11:01.115254 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B679EB260>]}
[0m10:11:01.116254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dverental_inventory)
[0m10:11:01.116254 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.117254 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.24s]
[0m10:11:01.117254 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.24s]
[0m10:11:01.118255 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.120260 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.121259 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:01.121259 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:01.123261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.124260 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.125259 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.125259 [info ] [Thread-4 (]: 7 of 8 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:11:01.127260 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.128259 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:11:01.128259 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.128259 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.131261 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.132259 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.133259 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.133259 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:11:01.133259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:01.134763 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.134763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.137768 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.138768 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: BEGIN
[0m10:11:01.138768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:01.139767 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.140768 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:11:01.140768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:11:01.214769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m10:11:01.215777 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.215777 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:11:01.218771 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:11:01.218771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m10:11:01.221772 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.221772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.221772 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:11:01.222772 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventory"} */

  create view "dvdrental"."public"."stg_dverental_inventory__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m10:11:01.223773 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.225775 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.225775 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:11:01.225775 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:11:01.226774 [debug] [Thread-4 (]: SQL status: BEGIN in 0.086 seconds
[0m10:11:01.227776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.228782 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.228782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.229774 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventory"} */
alter table "dvdrental"."public"."stg_dverental_inventory__dbt_tmp" rename to "stg_dverental_inventory"
[0m10:11:01.229774 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:11:01.230780 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:11:01.231774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.231774 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.232775 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: COMMIT
[0m10:11:01.232775 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:11:01.233775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.233775 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:11:01.234774 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: COMMIT
[0m10:11:01.236287 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.237286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:11:01.237286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.239288 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.239288 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m10:11:01.239288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:11:01.240286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:11:01.241288 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:11:01.243286 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dverental_inventory__dbt_backup"
[0m10:11:01.243286 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.244286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.244286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:01.245286 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:11:01.245286 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventory"} */
drop view if exists "dvdrental"."public"."stg_dverental_inventory__dbt_backup" cascade
[0m10:11:01.246287 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:11:01.247288 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.247288 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:11:01.248286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:11:01.248286 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:11:01.249287 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: Close
[0m10:11:01.250287 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:11:01.250287 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:11:01.251286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67AEEBA0>]}
[0m10:11:01.251286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67A3C890>]}
[0m10:11:01.253286 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:11:01.253286 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_dverental_inventory ................ [[32mCREATE VIEW[0m in 0.14s]
[0m10:11:01.254287 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m10:11:01.255286 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.255286 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.256286 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.256286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:11:01.257287 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:11:01.258287 [info ] [Thread-3 (]: 8 of 8 START sql view model public.customers ................................... [RUN]
[0m10:11:01.258287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.customers)
[0m10:11:01.258287 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:11:01.261286 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:11:01.261286 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:11:01.262288 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:11:01.263287 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67B2AE70>]}
[0m10:11:01.263287 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:11:01.263287 [info ] [Thread-4 (]: 7 of 8 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.14s]
[0m10:11:01.266287 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:11:01.266287 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.267287 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.268288 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:11:01.268288 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:11:01.330290 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m10:11:01.331290 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.331290 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:11:01.334798 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:11:01.338809 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.338809 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:11:01.339803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:01.340804 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:11:01.340804 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.341804 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:11:01.346139 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m10:11:01.347145 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:11:01.348144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.348144 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:11:01.349143 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:11:01.350145 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:11:01.350145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67B3F920>]}
[0m10:11:01.351148 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m10:11:01.352144 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:11:01.354143 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:01.354143 [debug] [MainThread]: On master: BEGIN
[0m10:11:01.355144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:01.430148 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m10:11:01.431156 [debug] [MainThread]: On master: COMMIT
[0m10:11:01.432153 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:01.432153 [debug] [MainThread]: On master: COMMIT
[0m10:11:01.433147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:01.433147 [debug] [MainThread]: On master: Close
[0m10:11:01.433147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dverental_inventory' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:11:01.435658 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:11:01.435658 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:11:01.435658 [info ] [MainThread]: 
[0m10:11:01.436658 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m10:11:01.438664 [debug] [MainThread]: Command end result
[0m10:11:01.452657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:11:01.455659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:11:01.460658 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:11:01.461658 [info ] [MainThread]: 
[0m10:11:01.462659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:01.462659 [info ] [MainThread]: 
[0m10:11:01.463657 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:11:01.464658 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:01.464658 after 1.75 seconds
[0m10:11:01.465659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B630391F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B64FA4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6199AEA0>]}
[0m10:11:01.465659 [debug] [MainThread]: Flushing usage events
[0m10:11:01.874080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:11.358676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0BE4EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5A1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5638F0>]}


============================== 10:14:11.361696 | 08067f73-01c8-45ef-8728-fddd3031ca3b ==============================
[0m10:14:11.361696 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:14:11.362699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:11.494351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C8BBEC0>]}
[0m10:14:11.532350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0CE60920>]}
[0m10:14:11.533351 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:11.690749 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:14:11.813451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:11.813451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:11.840451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0DFAA270>]}
[0m10:14:11.892944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:14:11.896964 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:14:11.919942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E31BE90>]}
[0m10:14:11.920948 [info ] [MainThread]: Found 8 models, 4 data tests, 15 sources, 433 macros
[0m10:14:11.921944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5626F0>]}
[0m10:14:11.922944 [info ] [MainThread]: 
[0m10:14:11.923944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:14:11.924657 [info ] [MainThread]: 
[0m10:14:11.924657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:11.927664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:14:12.026188 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:14:12.026188 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:14:12.027188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:12.095265 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.068 seconds
[0m10:14:12.096264 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:14:12.098265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:14:12.102264 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:12.102264 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:14:12.103265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:12.164407 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m10:14:12.165418 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:12.165418 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:14:12.168303 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m10:14:12.170289 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:14:12.170857 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:14:12.177379 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.178380 [debug] [MainThread]: On master: BEGIN
[0m10:14:12.178380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:12.238568 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m10:14:12.239568 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.239568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:14:12.244564 [debug] [MainThread]: SQL status: SELECT 46 in 0.004 seconds
[0m10:14:12.249565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E2E9460>]}
[0m10:14:12.249565 [debug] [MainThread]: On master: ROLLBACK
[0m10:14:12.250566 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.250566 [debug] [MainThread]: On master: BEGIN
[0m10:14:12.251565 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:14:12.251565 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.252565 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.252565 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.252565 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:12.252565 [debug] [MainThread]: On master: Close
[0m10:14:12.257890 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.257890 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.257890 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.258883 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.258883 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:14:12.258883 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:14:12.259889 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:14:12.260905 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:14:12.259889 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:14:12.260905 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:14:12.261903 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:14:12.261903 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.262903 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:14:12.262903 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.263903 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.267903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.268900 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.270902 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.271911 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.275420 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.276440 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.276440 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.283438 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.301433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.312438 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.313439 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.315439 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.318439 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.319439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.319439 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.320439 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:14:12.320439 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:14:12.320439 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.321439 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.321439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:14:12.321439 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:14:12.322439 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:14:12.322439 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:14:12.323439 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:14:12.323439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:14:12.408990 [debug] [Thread-2 (]: SQL status: BEGIN in 0.087 seconds
[0m10:14:12.409989 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.410990 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:14:12.413991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m10:14:12.413991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.413991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:12.414995 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:14:12.418990 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.419991 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m10:14:12.419991 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m10:14:12.420991 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:14:12.420991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.420991 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.421990 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:14:12.421990 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.421990 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:14:12.422990 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m10:14:12.424990 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.424990 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:12.426987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.426987 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:14:12.428991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.428991 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:14:12.429990 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:14:12.429990 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:14:12.430991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.432990 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.441990 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:14:12.441990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:14:12.442998 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:12.443990 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m10:14:12.445990 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.447991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.448991 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.448991 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:14:12.448991 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.449991 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:14:12.449991 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:12.451991 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.451991 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:12.452991 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:14:12.453991 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:12.453991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:12.453991 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:14:12.454991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.457992 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:12.457992 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:14:12.462008 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:14:12.462008 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:12.463008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.464009 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:12.467008 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.468008 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:12.468008 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.469013 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:14:12.469013 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:12.469013 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:12.469013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:14:12.471009 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:14:12.471009 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:14:12.473012 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:14:12.473012 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:12.474008 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.475523 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:14:12.477539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.478539 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:14:12.478539 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:14:12.480539 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:14:12.480539 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.481539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E8F4890>]}
[0m10:14:12.482541 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:14:12.483535 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.22s]
[0m10:14:12.484545 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.484545 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.484545 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:14:12.485535 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:14:12.485535 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:14:12.485535 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:14:12.487540 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:14:12.488540 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:14:12.489539 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:14:12.489539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:14:12.490541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E93E660>]}
[0m10:14:12.490541 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E7E28A0>]}
[0m10:14:12.491540 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0CECD6A0>]}
[0m10:14:12.491540 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.492534 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m10:14:12.492534 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:14:12.496717 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.493536 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.23s]
[0m10:14:12.496717 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.497728 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.498722 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.498722 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.499722 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.499722 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.500721 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_dverental_inventories ................... [RUN]
[0m10:14:12.500721 [info ] [Thread-4 (]: 7 of 8 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:14:12.503721 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.503721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dverental_inventories)
[0m10:14:12.504721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:14:12.504721 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.505724 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.505724 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.507722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.508722 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.509722 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:14:12.510722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:14:12.510722 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.510722 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.513716 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.516723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.518717 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.518717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.519727 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:14:12.519727 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: BEGIN
[0m10:14:12.519727 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:14:12.520722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:12.589789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m10:14:12.590789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.590789 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:14:12.593786 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:12.595786 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.596795 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:14:12.597787 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.599794 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.599794 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:14:12.599794 [debug] [Thread-4 (]: SQL status: BEGIN in 0.080 seconds
[0m10:14:12.600791 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.600791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.600791 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:14:12.601789 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:12.602789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.602789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m10:14:12.603787 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:12.603787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.604790 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */

  create view "dvdrental"."public"."stg_dverental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m10:14:12.605793 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:14:12.606789 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.607793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:12.607793 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:14:12.607793 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:14:12.609789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.611789 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:14:12.611789 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
alter table "dvdrental"."public"."stg_dverental_inventories__dbt_tmp" rename to "stg_dverental_inventories"
[0m10:14:12.611789 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.612790 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.614790 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.614790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:12.615785 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:14:12.615785 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:14:12.616787 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:12.617790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.617790 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:12.617790 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:12.619791 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:12.619791 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:14:12.619791 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.619791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:14:12.620793 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:14:12.621790 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:12.622790 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dverental_inventories__dbt_backup"
[0m10:14:12.623802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0EA37BF0>]}
[0m10:14:12.623802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.624794 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:12.625784 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dverental_inventories__dbt_backup" cascade
[0m10:14:12.624794 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.13s]
[0m10:14:12.626791 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:14:12.627788 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.628790 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:14:12.629788 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.629788 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:14:12.630797 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: Close
[0m10:14:12.631789 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:14:12.632786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0EA77E30>]}
[0m10:14:12.631789 [info ] [Thread-3 (]: 8 of 8 START sql view model public.customers ................................... [RUN]
[0m10:14:12.634786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.customers)
[0m10:14:12.633785 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_dverental_inventories .............. [[32mCREATE VIEW[0m in 0.13s]
[0m10:14:12.634786 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:14:12.635787 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:14:12.635787 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.637789 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:14:12.638787 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:14:12.640786 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0DFCCC20>]}
[0m10:14:12.640786 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:14:12.640786 [info ] [Thread-4 (]: 7 of 8 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.14s]
[0m10:14:12.643786 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:14:12.643786 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.645789 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.645789 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:14:12.645789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:14:12.822642 [debug] [Thread-3 (]: SQL status: BEGIN in 0.176 seconds
[0m10:14:12.823630 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.824649 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:14:12.827624 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:12.830642 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.831628 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:14:12.832625 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:12.833628 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:12.833628 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.833628 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:12.838549 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m10:14:12.840546 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:14:12.841544 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.841544 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:14:12.842545 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:14:12.843549 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:14:12.844546 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0EA97A70>]}
[0m10:14:12.844546 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.21s]
[0m10:14:12.845545 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:14:12.847690 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.847690 [debug] [MainThread]: On master: BEGIN
[0m10:14:12.848695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:14:12.915448 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m10:14:12.915448 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.916448 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.916448 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.917447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:12.917447 [debug] [MainThread]: On master: Close
[0m10:14:12.918449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:12.918449 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:14:12.918449 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:14:12.919447 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dverental_inventories' was properly closed.
[0m10:14:12.919447 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:14:12.919447 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:14:12.920449 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:14:12.920449 [info ] [MainThread]: 
[0m10:14:12.921450 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m10:14:12.922449 [debug] [MainThread]: Command end result
[0m10:14:12.936446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:14:12.939449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:14:12.944448 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:14:12.944448 [info ] [MainThread]: 
[0m10:14:12.945449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:12.945449 [info ] [MainThread]: 
[0m10:14:12.946449 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:14:12.947446 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:12.947446 after 1.73 seconds
[0m10:14:12.947446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C562E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C562300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5638F0>]}
[0m10:14:12.948449 [debug] [MainThread]: Flushing usage events
[0m10:14:13.378481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:58.481913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFF2B29F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D824355E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82434740>]}


============================== 10:14:58.484914 | 8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5 ==============================
[0m10:14:58.484914 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:14:58.485911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:14:58.612277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8301D8B0>]}
[0m10:14:58.651279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82FB0920>]}
[0m10:14:58.652278 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:58.801095 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:14:58.918120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:58.919120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:58.946120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844CD460>]}
[0m10:14:58.999128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:14:59.002632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:14:59.023640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844CE000>]}
[0m10:14:59.023640 [info ] [MainThread]: Found 8 models, 4 data tests, 15 sources, 433 macros
[0m10:14:59.024637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844EEB70>]}
[0m10:14:59.026638 [info ] [MainThread]: 
[0m10:14:59.026638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:14:59.027637 [info ] [MainThread]: 
[0m10:14:59.027637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:59.030641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:14:59.127156 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:14:59.128156 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:14:59.128156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:59.201841 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m10:14:59.203347 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:14:59.205354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:14:59.209357 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:59.210355 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:14:59.210355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:59.272983 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m10:14:59.272983 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:59.273984 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:14:59.276984 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m10:14:59.277983 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:14:59.277983 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:14:59.286983 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.287985 [debug] [MainThread]: On master: BEGIN
[0m10:14:59.287985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:59.349504 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m10:14:59.350503 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.351503 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:14:59.355503 [debug] [MainThread]: SQL status: SELECT 47 in 0.004 seconds
[0m10:14:59.361502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8446AB40>]}
[0m10:14:59.361502 [debug] [MainThread]: On master: ROLLBACK
[0m10:14:59.362504 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.363503 [debug] [MainThread]: On master: BEGIN
[0m10:14:59.364502 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:14:59.365508 [debug] [MainThread]: On master: COMMIT
[0m10:14:59.366503 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.366503 [debug] [MainThread]: On master: COMMIT
[0m10:14:59.367503 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:59.367503 [debug] [MainThread]: On master: Close
[0m10:14:59.372503 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.373503 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.373503 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.373503 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.374503 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:14:59.374503 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:14:59.375503 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:14:59.376503 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:14:59.375503 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:14:59.376503 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:14:59.377503 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:14:59.377503 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.378504 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:14:59.378504 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.378504 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.383504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.383504 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.385507 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.387505 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.390510 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.391510 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.403018 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.424028 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.425025 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.441026 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.441026 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.444028 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.446024 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.446024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.447026 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:14:59.448025 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.448025 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:14:59.448025 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:14:59.449026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.449026 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.450026 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:14:59.450026 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:14:59.450026 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:14:59.451026 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:14:59.451026 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:14:59.540539 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m10:14:59.540539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.541539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m10:14:59.541539 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:14:59.542539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.543538 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:14:59.544547 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m10:14:59.545539 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.545539 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:14:59.545539 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:59.546539 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:14:59.546539 [debug] [Thread-4 (]: SQL status: BEGIN in 0.095 seconds
[0m10:14:59.551541 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.551541 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:14:59.553540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.554540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.554540 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:14:59.556545 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.557538 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:14:59.557538 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:14:59.558540 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m10:14:59.558540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.559538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.559538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.560541 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.561537 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:59.562540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.564540 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.565542 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:14:59.567540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.567540 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:14:59.568539 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:14:59.568539 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:14:59.568539 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.569540 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.569540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.570540 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.583539 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:59.584542 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:59.588545 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:59.590545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.590545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.591546 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.591546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.591546 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:14:59.592544 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:59.592544 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:59.593545 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:59.593545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.594545 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:59.595546 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.595546 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:59.598156 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.599169 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.599169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.600165 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m10:14:59.604680 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:14:59.605680 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:14:59.607680 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:14:59.608680 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:14:59.612679 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.613681 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.615682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.616680 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.616680 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:14:59.617680 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:14:59.617680 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:14:59.618680 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:14:59.620685 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:14:59.621681 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:14:59.623679 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:14:59.623679 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:14:59.624680 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m10:14:59.625686 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:14:59.627167 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:14:59.629172 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:14:59.629172 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84E285C0>]}
[0m10:14:59.630173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844EE8A0>]}
[0m10:14:59.630173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84D69730>]}
[0m10:14:59.632173 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84D68530>]}
[0m10:14:59.631173 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.25s]
[0m10:14:59.632173 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.25s]
[0m10:14:59.633586 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.25s]
[0m10:14:59.634591 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.25s]
[0m10:14:59.635739 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.635739 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.636749 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.636749 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.637750 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.637750 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.638749 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.638749 [info ] [Thread-3 (]: 5 of 8 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:14:59.639748 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_dverental_inventories ................... [RUN]
[0m10:14:59.639748 [info ] [Thread-1 (]: 7 of 8 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:14:59.640745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:14:59.640745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dverental_inventories)
[0m10:14:59.641751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:14:59.641751 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.642745 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.642745 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.644747 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.646745 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.648745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.649747 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.650745 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.650745 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.652746 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.654744 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.657746 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.658745 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.659747 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.659747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.659747 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:14:59.660747 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: BEGIN
[0m10:14:59.660747 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:14:59.661746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:14:59.661746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:14:59.661746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:59.740271 [debug] [Thread-3 (]: SQL status: BEGIN in 0.079 seconds
[0m10:14:59.741269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.741269 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:14:59.742266 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m10:14:59.742266 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.742266 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */

  create view "dvdrental"."public"."stg_dverental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m10:14:59.744269 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:59.746269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.746269 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:14:59.747270 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:14:59.747270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m10:14:59.749270 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.750265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.750265 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.751270 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
alter table "dvdrental"."public"."stg_dverental_inventories" rename to "stg_dverental_inventories__dbt_backup"
[0m10:14:59.751270 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:14:59.753270 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.754268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.754268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:14:59.756269 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.756269 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:14:59.756269 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.757268 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
alter table "dvdrental"."public"."stg_dverental_inventories__dbt_tmp" rename to "stg_dverental_inventories"
[0m10:14:59.759267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.760268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:59.760268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.761268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:14:59.761268 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.762267 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:59.763268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:59.763268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.763268 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.765268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.766269 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:59.768268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:14:59.768268 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.770269 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:14:59.771270 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:14:59.771270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:59.772270 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.773268 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dverental_inventories__dbt_backup"
[0m10:14:59.774268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:59.775269 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:14:59.775269 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.776268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.776268 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dverental_inventories__dbt_backup" cascade
[0m10:14:59.776268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:59.777268 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:14:59.778268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:14:59.779268 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:14:59.779268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:59.780267 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: Close
[0m10:14:59.780267 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84F5A930>]}
[0m10:14:59.782269 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:14:59.783272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84D8FFB0>]}
[0m10:14:59.784271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.783272 [info ] [Thread-3 (]: 5 of 8 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m10:14:59.785267 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:14:59.785267 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_dverental_inventories .............. [[32mCREATE VIEW[0m in 0.14s]
[0m10:14:59.786269 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.787268 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.788271 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:14:59.789277 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:14:59.790279 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:14:59.791276 [info ] [Thread-4 (]: 8 of 8 START sql view model public.customers ................................... [RUN]
[0m10:14:59.791276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84F502C0>]}
[0m10:14:59.792277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m10:14:59.792277 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:14:59.792277 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.15s]
[0m10:14:59.795281 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:14:59.796277 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.798276 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:14:59.802286 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:14:59.803279 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.803789 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:14:59.803789 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:14:59.978562 [debug] [Thread-4 (]: SQL status: BEGIN in 0.175 seconds
[0m10:14:59.979561 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.979561 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:14:59.983564 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:59.986559 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.986559 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:14:59.987564 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.988564 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:59.989572 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.989572 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:59.994573 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.996574 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:14:59.997573 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.997573 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:14:59.998572 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:14:59.999573 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:14:59.999573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84F89040>]}
[0m10:15:00.000572 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.21s]
[0m10:15:00.001572 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:15:00.003571 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:00.003571 [debug] [MainThread]: On master: BEGIN
[0m10:15:00.004077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:00.077086 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m10:15:00.078096 [debug] [MainThread]: On master: COMMIT
[0m10:15:00.078096 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:00.079083 [debug] [MainThread]: On master: COMMIT
[0m10:15:00.079083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:15:00.079083 [debug] [MainThread]: On master: Close
[0m10:15:00.080083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:00.080083 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:15:00.081084 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:15:00.081084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:15:00.081084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dverental_inventories' was properly closed.
[0m10:15:00.082084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:15:00.082084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:15:00.082084 [info ] [MainThread]: 
[0m10:15:00.083085 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m10:15:00.085083 [debug] [MainThread]: Command end result
[0m10:15:00.102091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:15:00.105603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:15:00.110602 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:15:00.110602 [info ] [MainThread]: 
[0m10:15:00.111601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:00.112602 [info ] [MainThread]: 
[0m10:15:00.112602 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:15:00.114605 [debug] [MainThread]: Command `dbt run` succeeded at 10:15:00.113607 after 1.76 seconds
[0m10:15:00.114605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82B60860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82AE7A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82E8D910>]}
[0m10:15:00.114605 [debug] [MainThread]: Flushing usage events
[0m10:15:00.503745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:04.862155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E44B26FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4514EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4514C680>]}


============================== 14:26:04.869152 | fc3055d9-4965-4b45-a6f0-0e8ceb811e31 ==============================
[0m14:26:04.869152 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:26:04.870153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:26:05.014220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc3055d9-4965-4b45-a6f0-0e8ceb811e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E44FED370>]}
[0m14:26:05.055220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc3055d9-4965-4b45-a6f0-0e8ceb811e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E42DA2AB0>]}
[0m14:26:05.056222 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:26:05.206605 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:26:05.335481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:26:05.336479 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\intermediate\categories_inventories.sql
[0m14:26:05.475600 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_postgres_prj1.categories_inventories' (models\intermediate\categories_inventories.sql) depends on a node named 'stg_dvdrental_inventories' which was not found
[0m14:26:05.476607 [debug] [MainThread]: Command `dbt run` failed at 14:26:05.476607 after 0.80 seconds
[0m14:26:05.477611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4490B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E46E3AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E45B31940>]}
[0m14:26:05.477611 [debug] [MainThread]: Flushing usage events
[0m14:26:05.796274 [debug] [MainThread]: An error was encountered while trying to flush usage events
