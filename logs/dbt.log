[0m16:14:25.459852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F2CC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F2CCBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F44FE60>]}


============================== 16:14:25.466855 | 21183e17-5303-4ceb-bb0f-65ccd573b19e ==============================
[0m16:14:25.466855 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:14:25.466855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:25.583855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21183e17-5303-4ceb-bb0f-65ccd573b19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F508890>]}
[0m16:14:25.612863 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:14:25.613860 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:14:25.615855 [debug] [MainThread]: Command `cli deps` succeeded at 16:14:25.615855 after 0.40 seconds
[0m16:14:25.615855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281998E6A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819FEF3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819F44FE60>]}
[0m16:14:25.616856 [debug] [MainThread]: Flushing usage events
[0m16:14:26.022113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:10.491941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027195162C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027197CA7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027197CA79B0>]}


============================== 16:24:10.495947 | c65a777a-87a9-48e2-8d53-f12d1d00b753 ==============================
[0m16:24:10.495947 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:24:10.496951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:24:10.511947 [info ] [MainThread]: dbt version: 1.9.3
[0m16:24:10.511947 [info ] [MainThread]: python version: 3.12.3
[0m16:24:10.512947 [info ] [MainThread]: python path: C:\Program Files\Python312\dbt-core-demo\Scripts\python.exe
[0m16:24:10.513947 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m16:24:10.571513 [info ] [MainThread]: Using profiles dir at C:\Users\peichunl\.dbt
[0m16:24:10.572515 [info ] [MainThread]: Using profiles.yml file at C:\Users\peichunl\.dbt\profiles.yml
[0m16:24:10.573512 [info ] [MainThread]: Using dbt_project.yml file at C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\dbt_project.yml
[0m16:24:10.574520 [info ] [MainThread]: adapter type: postgres
[0m16:24:10.574520 [info ] [MainThread]: adapter version: 1.9.0
[0m16:24:10.638513 [info ] [MainThread]: Configuration:
[0m16:24:10.639513 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:24:10.640515 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:24:10.640515 [info ] [MainThread]: Required dependencies:
[0m16:24:10.641518 [debug] [MainThread]: Executing "git --help"
[0m16:24:10.644531 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m16:24:10.645531 [info ] [MainThread]: Connection:
[0m16:24:10.646533 [info ] [MainThread]:   host: localhost
[0m16:24:10.647538 [info ] [MainThread]:   port: 5432
[0m16:24:10.648536 [info ] [MainThread]:   user: postgres
[0m16:24:10.649529 [info ] [MainThread]:   database: dvdrental
[0m16:24:10.649529 [info ] [MainThread]:   schema: public
[0m16:24:10.650529 [info ] [MainThread]:   connect_timeout: 10
[0m16:24:10.650529 [info ] [MainThread]:   role: None
[0m16:24:10.651532 [info ] [MainThread]:   search_path: None
[0m16:24:10.652532 [info ] [MainThread]:   keepalives_idle: 0
[0m16:24:10.652532 [info ] [MainThread]:   sslmode: None
[0m16:24:10.653530 [info ] [MainThread]:   sslcert: None
[0m16:24:10.653530 [info ] [MainThread]:   sslkey: None
[0m16:24:10.654531 [info ] [MainThread]:   sslrootcert: None
[0m16:24:10.654531 [info ] [MainThread]:   application_name: dbt
[0m16:24:10.654531 [info ] [MainThread]:   retries: 1
[0m16:24:10.655531 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:10.813527 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:24:10.903525 [debug] [MainThread]: Using postgres connection "debug"
[0m16:24:10.904525 [debug] [MainThread]: On debug: select 1 as id
[0m16:24:10.904525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:10.976523 [debug] [MainThread]: SQL status: SELECT 1 in 0.071 seconds
[0m16:24:10.977524 [debug] [MainThread]: On debug: Close
[0m16:24:10.977524 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:24:10.978522 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:24:10.980524 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m16:24:10.982523 [debug] [MainThread]: Command `dbt debug` failed at 16:24:10.982523 after 0.64 seconds
[0m16:24:10.982523 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:24:10.982523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027195162C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271952B39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027197ADA240>]}
[0m16:24:10.983526 [debug] [MainThread]: Flushing usage events
[0m16:24:11.330229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:47.605765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF76BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CECAA3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF54E1B0>]}


============================== 10:27:47.609767 | fe825283-0c5c-46ca-b65b-6d5ce97b6261 ==============================
[0m10:27:47.609767 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:27:47.610766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:47.724809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe825283-0c5c-46ca-b65b-6d5ce97b6261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEEF828D0>]}
[0m10:27:47.746809 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:27:47.747809 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:27:47.748809 [debug] [MainThread]: Command `cli deps` succeeded at 10:27:47.748809 after 0.28 seconds
[0m10:27:47.748809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF76BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEF76AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CEFFC26F0>]}
[0m10:27:47.749808 [debug] [MainThread]: Flushing usage events
[0m10:27:48.154587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:04.557253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B4C76C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B427FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B427D880>]}


============================== 10:44:04.560253 | 8a654a9b-bedf-43e7-924d-3045c41b77d5 ==============================
[0m10:44:04.560253 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:44:04.561253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:44:04.650087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a654a9b-bedf-43e7-924d-3045c41b77d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B2869580>]}
[0m10:44:04.680368 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:44:04.682774 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:44:04.683057 [debug] [MainThread]: Command `cli deps` succeeded at 10:44:04.683057 after 0.27 seconds
[0m10:44:04.684084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B45CCA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B640C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8B640C9B0>]}
[0m10:44:04.684084 [debug] [MainThread]: Flushing usage events
[0m10:44:05.041217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:44.501977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3F8DAB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41DB5BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41DB7140>]}


============================== 13:28:44.505977 | b19ce1c2-4caa-4ed0-8c64-10ac6dab442a ==============================
[0m13:28:44.505977 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:28:44.506978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:44.652627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE428E33E0>]}
[0m13:28:44.692146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3FB558E0>]}
[0m13:28:44.693145 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:28:44.852066 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:28:44.958339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:44.959341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:44.981339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE42BF9BB0>]}
[0m13:28:45.022341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m13:28:45.031153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m13:28:45.054152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE442F60F0>]}
[0m13:28:45.055153 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m13:28:45.055153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4289D190>]}
[0m13:28:45.056153 [info ] [MainThread]: 
[0m13:28:45.057152 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:45.057152 [info ] [MainThread]: 
[0m13:28:45.058153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:28:45.060153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m13:28:45.188460 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m13:28:45.189472 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m13:28:45.189472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:45.270969 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.082 seconds
[0m13:28:45.273968 [debug] [ThreadPool]: On list_dvdrental: Close
[0m13:28:45.274968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m13:28:45.280973 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m13:28:45.280973 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m13:28:45.281967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:45.461969 [debug] [ThreadPool]: SQL status: BEGIN in 0.181 seconds
[0m13:28:45.462968 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m13:28:45.463969 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:28:45.474967 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.011 seconds
[0m13:28:45.476969 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m13:28:45.477967 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m13:28:45.482969 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.482969 [debug] [MainThread]: On master: BEGIN
[0m13:28:45.483968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:45.555967 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m13:28:45.556969 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.557970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:45.562969 [debug] [MainThread]: SQL status: SELECT 37 in 0.005 seconds
[0m13:28:45.567970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4485D5E0>]}
[0m13:28:45.567970 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:45.568974 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.568974 [debug] [MainThread]: On master: BEGIN
[0m13:28:45.569969 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:28:45.569969 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.570969 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.570969 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.570969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:45.571968 [debug] [MainThread]: On master: Close
[0m13:28:45.586970 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.587967 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:28:45.587967 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m13:28:45.588968 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.592967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.595968 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.622969 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.627967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.628969 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m13:28:45.628969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:45.712970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m13:28:45.713969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.713969 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:28:45.722968 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m13:28:45.727969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.727969 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:28:45.729974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:45.742972 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m13:28:45.742972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.743973 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m13:28:45.744969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:28:45.748969 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m13:28:45.752970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m13:28:45.752970 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:28:45.754969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:28:45.755972 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m13:28:45.757973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3F9E2960>]}
[0m13:28:45.758968 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.17s]
[0m13:28:45.762470 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m13:28:45.762968 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.762968 [info ] [Thread-3 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:28:45.763970 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_second_dbt_model'
[0m13:28:45.763970 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.765967 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.767968 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.778971 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.783144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.783144 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m13:28:45.783975 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:45.857903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.074 seconds
[0m13:28:45.858904 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.858904 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  create view "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:28:45.865906 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:28:45.868903 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.868903 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:28:45.871913 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:45.874903 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m13:28:45.874903 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.875901 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m13:28:45.876901 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:28:45.877905 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m13:28:45.880904 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m13:28:45.880904 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop view if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:28:45.881900 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:28:45.882902 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m13:28:45.882902 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b19ce1c2-4caa-4ed0-8c64-10ac6dab442a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE44947C20>]}
[0m13:28:45.883902 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:28:45.884901 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m13:28:45.885902 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.885902 [debug] [MainThread]: On master: BEGIN
[0m13:28:45.886901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:45.965900 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m13:28:45.965900 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.966902 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:45.966902 [debug] [MainThread]: On master: COMMIT
[0m13:28:45.967901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:45.967901 [debug] [MainThread]: On master: Close
[0m13:28:45.967901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:45.968902 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m13:28:45.968902 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m13:28:45.968902 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_first_dbt_model' was properly closed.
[0m13:28:45.969902 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m13:28:45.969902 [info ] [MainThread]: 
[0m13:28:45.969902 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m13:28:45.970903 [debug] [MainThread]: Command end result
[0m13:28:45.985900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m13:28:45.987902 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m13:28:45.992901 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m13:28:45.992901 [info ] [MainThread]: 
[0m13:28:45.993901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:45.993901 [info ] [MainThread]: 
[0m13:28:45.993901 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:28:45.994901 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:45.994901 after 1.65 seconds
[0m13:28:45.994901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE422758E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE426363F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE42B4F4D0>]}
[0m13:28:45.995902 [debug] [MainThread]: Flushing usage events
[0m13:28:46.396027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:53.930214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3731D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3AA8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3AABBC0>]}


============================== 14:53:53.937160 | 0b0d2663-14d8-420e-a762-78136f924f45 ==============================
[0m14:53:53.937160 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:53:53.937160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:54.029009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0d2663-14d8-420e-a762-78136f924f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC107C3E0>]}
[0m14:53:54.053145 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:53:54.055143 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:53:54.056144 [debug] [MainThread]: Command `cli deps` succeeded at 14:53:54.056144 after 0.28 seconds
[0m14:53:54.056144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3AA8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC3731D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC107C3E0>]}
[0m14:53:54.057148 [debug] [MainThread]: Flushing usage events
[0m14:53:54.474712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:19.468964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0EAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0C8C0>]}


============================== 14:14:19.475792 | 56e80a04-5a92-4c14-a688-729577ab3c9a ==============================
[0m14:14:19.475792 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:14:19.476793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:14:19.619228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001627405A630>]}
[0m14:14:19.659893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273D940E0>]}
[0m14:14:19.660894 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:14:19.821063 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:14:19.945189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:19.945189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:19.949190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres_prj1.example.staging
[0m14:14:19.978218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162744FDCA0>]}
[0m14:14:20.031983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:14:20.038984 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:14:20.072662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162758172F0>]}
[0m14:14:20.072662 [info ] [MainThread]: Found 3 models, 4 data tests, 15 sources, 433 macros
[0m14:14:20.073662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001627402EED0>]}
[0m14:14:20.074661 [info ] [MainThread]: 
[0m14:14:20.075662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:20.075662 [info ] [MainThread]: 
[0m14:14:20.076661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:20.079661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:14:20.222339 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:14:20.223339 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:14:20.223339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:20.295731 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.073 seconds
[0m14:14:20.297733 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:14:20.298733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:14:20.304243 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:14:20.305242 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:14:20.305242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:20.368275 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m14:14:20.368275 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:14:20.369275 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:14:20.376375 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.007 seconds
[0m14:14:20.378376 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:14:20.379375 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:14:20.385378 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.385378 [debug] [MainThread]: On master: BEGIN
[0m14:14:20.385378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:20.445626 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m14:14:20.446633 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.447627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:20.456742 [debug] [MainThread]: SQL status: SELECT 38 in 0.008 seconds
[0m14:14:20.461741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275D922A0>]}
[0m14:14:20.461741 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:20.462743 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.462743 [debug] [MainThread]: On master: BEGIN
[0m14:14:20.463744 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:14:20.463744 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.464741 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.464741 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.464741 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:20.465741 [debug] [MainThread]: On master: Close
[0m14:14:20.471742 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.471742 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.472743 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:14:20.473742 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:14:20.472743 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:14:20.473742 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.473742 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:14:20.478742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.478742 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.481741 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.482741 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.509260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.510260 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.521261 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.521261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.522262 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:14:20.522262 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:20.523259 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.523259 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:14:20.523259 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:20.593262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m14:14:20.594262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.594262 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:14:20.596664 [debug] [Thread-2 (]: SQL status: BEGIN in 0.073 seconds
[0m14:14:20.596664 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.596664 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:14:20.605046 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m14:14:20.610045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.610045 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:14:20.610045 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:14:20.613045 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.615045 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:14:20.616045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.617045 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.618045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.628045 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:14:20.628045 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:14:20.629044 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.629044 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:14:20.630044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.635376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:14:20.635376 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m14:14:20.635376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.639376 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:14:20.639376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:14:20.643376 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:14:20.643376 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:14:20.644376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:20.645375 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:14:20.646376 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:14:20.648381 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:14:20.650376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:14:20.651376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:14:20.652376 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275D8BC20>]}
[0m14:14:20.653383 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.18s]
[0m14:14:20.654375 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:14:20.656375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:14:20.657376 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:14:20.658376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275E1BFE0>]}
[0m14:14:20.658376 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m14:14:20.659376 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:14:20.660376 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.661376 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:14:20.662375 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_second_dbt_model'
[0m14:14:20.662375 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.664380 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.666376 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.668375 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.670376 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.670376 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:14:20.670376 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:14:20.731897 [debug] [Thread-4 (]: SQL status: BEGIN in 0.061 seconds
[0m14:14:20.732898 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.733903 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:14:20.737897 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:14:20.739898 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.739898 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:14:20.740896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:20.741896 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:14:20.741896 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.742900 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:14:20.744640 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:20.745876 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:14:20.746876 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:14:20.746876 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:14:20.747876 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:14:20.748876 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:14:20.748876 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e80a04-5a92-4c14-a688-729577ab3c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016275E96510>]}
[0m14:14:20.749876 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.09s]
[0m14:14:20.750874 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:14:20.752874 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.754881 [debug] [MainThread]: On master: BEGIN
[0m14:14:20.755878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:20.818383 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m14:14:20.819388 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.820383 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:20.820383 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.821383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:20.821383 [debug] [MainThread]: On master: Close
[0m14:14:20.822387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:20.822387 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:14:20.822387 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:14:20.823384 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_first_dbt_model' was properly closed.
[0m14:14:20.823384 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m14:14:20.824384 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:14:20.824384 [info ] [MainThread]: 
[0m14:14:20.825384 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m14:14:20.826384 [debug] [MainThread]: Command end result
[0m14:14:20.840389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:14:20.843384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:14:20.848383 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:14:20.848383 [info ] [MainThread]: 
[0m14:14:20.849384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:20.850418 [info ] [MainThread]: 
[0m14:14:20.851430 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:14:20.852433 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:20.852433 after 1.53 seconds
[0m14:14:20.853430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273B6FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273A0D6A0>]}
[0m14:14:20.853430 [debug] [MainThread]: Flushing usage events
[0m14:14:21.285316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:52.441852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F9CF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F0F41D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F5683B0>]}


============================== 14:37:52.444847 | cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c ==============================
[0m14:37:52.444847 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:52.445850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:52.581406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C7EFC80>]}
[0m14:37:52.618924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6FDD9370>]}
[0m14:37:52.619925 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:52.769988 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:52.884949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:52.884949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:52.912479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C707DF770>]}
[0m14:37:52.964480 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:52.969481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:52.991028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C71B171D0>]}
[0m14:37:52.991028 [info ] [MainThread]: Found 3 models, 4 data tests, 15 sources, 433 macros
[0m14:37:52.992024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C71AB92E0>]}
[0m14:37:52.994028 [info ] [MainThread]: 
[0m14:37:52.994028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:52.995028 [info ] [MainThread]: 
[0m14:37:52.997028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:53.001031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:37:53.118536 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:37:53.119537 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:37:53.119537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:53.193684 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m14:37:53.194684 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:37:53.196684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:37:53.200684 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:53.201684 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:37:53.201684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:53.269079 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m14:37:53.270079 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:53.271079 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:53.274089 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.003 seconds
[0m14:37:53.275089 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:37:53.276090 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:37:53.281089 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.281089 [debug] [MainThread]: On master: BEGIN
[0m14:37:53.281089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:53.457431 [debug] [MainThread]: SQL status: BEGIN in 0.176 seconds
[0m14:37:53.457431 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.458429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:53.463428 [debug] [MainThread]: SQL status: SELECT 38 in 0.004 seconds
[0m14:37:53.467428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C71AE7FE0>]}
[0m14:37:53.467428 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:53.468428 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.468428 [debug] [MainThread]: On master: BEGIN
[0m14:37:53.469837 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:53.469837 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.469837 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.470845 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.470845 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:53.470845 [debug] [MainThread]: On master: Close
[0m14:37:53.476284 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.476284 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.477282 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:37:53.477282 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:37:53.478701 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:37:53.478701 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:37:53.479713 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.479713 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.483707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.485707 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.487211 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.487211 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.514580 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.532579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.534586 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.534586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.535581 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:37:53.535581 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:37:53.536584 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:37:53.536584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:53.615358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m14:37:53.616602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.616602 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:37:53.617610 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m14:37:53.618609 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.618609 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:37:53.619609 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:37:53.624609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.625608 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:37:53.625608 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:37:53.627677 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.627677 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:37:53.629104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:53.631146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.632149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:37:53.632149 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:37:53.634148 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.634148 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:37:53.635143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:53.635143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:53.647146 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:53.648146 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:53.649146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.649146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.649146 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:53.650144 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:53.653147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:37:53.653147 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:37:53.657145 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:37:53.658155 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:37:53.662146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:53.663146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:53.664146 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:37:53.664146 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:37:53.666146 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:37:53.668148 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:37:53.668148 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:37:53.670149 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:37:53.671145 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6F5959D0>]}
[0m14:37:53.671145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7205B140>]}
[0m14:37:53.672144 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.19s]
[0m14:37:53.673654 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:53.672144 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m14:37:53.675017 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:53.676022 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.677023 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:37:53.678021 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_second_dbt_model'
[0m14:37:53.678021 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.680028 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.681025 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.684022 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.685021 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.686023 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:37:53.686023 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:37:53.755545 [debug] [Thread-4 (]: SQL status: BEGIN in 0.069 seconds
[0m14:37:53.755545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.756548 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:37:53.759545 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:37:53.761545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.761545 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:37:53.762546 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:53.763545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.764545 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:37:53.765546 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:53.766548 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:53.766548 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.766548 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:53.770567 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m14:37:53.772576 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:37:53.772576 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:53.773574 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:37:53.774576 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:37:53.775575 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:37:53.776576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8f5ad6-3500-4dbd-aeb8-8fb62a39049c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7208B200>]}
[0m14:37:53.776576 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.10s]
[0m14:37:53.777577 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:53.779888 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.779888 [debug] [MainThread]: On master: BEGIN
[0m14:37:53.780898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:53.850464 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m14:37:53.851465 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.851465 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:53.851465 [debug] [MainThread]: On master: COMMIT
[0m14:37:53.852466 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:53.852466 [debug] [MainThread]: On master: Close
[0m14:37:53.853465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:53.853465 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:37:53.853465 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:37:53.853465 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_first_dbt_model' was properly closed.
[0m14:37:53.854464 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m14:37:53.854464 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:37:53.855469 [info ] [MainThread]: 
[0m14:37:53.856464 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m14:37:53.857465 [debug] [MainThread]: Command end result
[0m14:37:53.871465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:53.874473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:53.878473 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:37:53.878473 [info ] [MainThread]: 
[0m14:37:53.879473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:53.880475 [info ] [MainThread]: 
[0m14:37:53.881472 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:37:53.882473 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:53.882473 after 1.60 seconds
[0m14:37:53.882473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6DB79070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7077B6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6D2CCFE0>]}
[0m14:37:53.883471 [debug] [MainThread]: Flushing usage events
[0m14:37:54.285325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:16.270181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F9AFA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F90761B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F9AF9AF0>]}


============================== 15:27:16.274183 | d68fc3ba-0022-43f5-87db-339375df4ad9 ==============================
[0m15:27:16.274183 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:27:16.275182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:27:16.407710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd68fc3ba-0022-43f5-87db-339375df4ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F99C7E90>]}
[0m15:27:16.448716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd68fc3ba-0022-43f5-87db-339375df4ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F6F10C50>]}
[0m15:27:16.449715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:16.607465 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:27:16.727982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:27:16.727982 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\staging\stg_dvdrental_payments.sql
[0m15:27:16.728985 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\staging\stg_dvdrental_orders.sql
[0m15:27:16.856403 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_postgres_prj1.stg_dvdrental_orders' (models\staging\stg_dvdrental_orders.sql) depends on a source named 'dvdrental_source.order' which was not found
[0m15:27:16.857399 [debug] [MainThread]: Command `dbt run` failed at 15:27:16.857399 after 0.77 seconds
[0m15:27:16.858399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F99C7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263F9CF96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FB345220>]}
[0m15:27:16.858399 [debug] [MainThread]: Flushing usage events
[0m15:27:17.257166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:24.107786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0E4B0>]}


============================== 15:28:24.110791 | 90618684-88cd-446d-856d-518be68d9faa ==============================
[0m15:28:24.110791 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:28:24.111790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:28:24.240872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86E6D370>]}
[0m15:28:24.278872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86EB4590>]}
[0m15:28:24.279872 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:28:24.440598 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:28:24.559850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:24.559850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:24.587275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0FB60>]}
[0m15:28:24.637098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:28:24.640099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:28:24.664341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C886D9760>]}
[0m15:28:24.664341 [info ] [MainThread]: Found 5 models, 4 data tests, 15 sources, 433 macros
[0m15:28:24.665335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C884ADD00>]}
[0m15:28:24.668331 [info ] [MainThread]: 
[0m15:28:24.668331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:28:24.669340 [info ] [MainThread]: 
[0m15:28:24.670089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:24.673110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m15:28:24.785955 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m15:28:24.786965 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m15:28:24.786965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:24.857511 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.070 seconds
[0m15:28:24.858513 [debug] [ThreadPool]: On list_dvdrental: Close
[0m15:28:24.859512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m15:28:24.864514 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:28:24.864514 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m15:28:24.864514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:24.924035 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m15:28:24.925035 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:28:24.926036 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:28:24.929035 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.003 seconds
[0m15:28:24.931037 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m15:28:24.931037 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m15:28:24.936451 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:24.937450 [debug] [MainThread]: On master: BEGIN
[0m15:28:24.937450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:24.998455 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:28:24.999459 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:24.999459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:25.004974 [debug] [MainThread]: SQL status: SELECT 38 in 0.005 seconds
[0m15:28:25.009973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C849CFAD0>]}
[0m15:28:25.009973 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:25.010972 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.010972 [debug] [MainThread]: On master: BEGIN
[0m15:28:25.011972 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:28:25.012975 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.012975 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.012975 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.013974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:28:25.013974 [debug] [MainThread]: On master: Close
[0m15:28:25.019973 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.019973 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.019973 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.019973 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.020975 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:28:25.021972 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m15:28:25.021972 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_dvdrental_orders ........................ [RUN]
[0m15:28:25.022971 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m15:28:25.021972 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m15:28:25.022971 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m15:28:25.023973 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_orders'
[0m15:28:25.023973 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.024971 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m15:28:25.024971 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.025975 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.029972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.029972 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.031972 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.033973 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.034972 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.035973 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.036971 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.062972 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.074971 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.075970 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.076978 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.078974 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.080974 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.080974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.081972 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.081972 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m15:28:25.082972 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m15:28:25.082972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:25.082972 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.083972 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.083972 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:28:25.084972 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m15:28:25.084972 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: BEGIN
[0m15:28:25.085970 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:28:25.085970 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:28:25.166603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m15:28:25.166603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.167598 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:28:25.170600 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m15:28:25.174599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.175599 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:28:25.175599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:28:25.177600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.178597 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:28:25.179596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.194606 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:28:25.195604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.195604 [debug] [Thread-2 (]: SQL status: BEGIN in 0.111 seconds
[0m15:28:25.195604 [debug] [Thread-4 (]: SQL status: BEGIN in 0.110 seconds
[0m15:28:25.196488 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m15:28:25.196488 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:28:25.196488 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.197498 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:28:25.197498 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.198498 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m15:28:25.198498 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payments as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m15:28:25.199500 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */

  create view "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m15:28:25.199500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:28:25.204011 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m15:28:25.204011 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:28:25.205009 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "source_payment" does not exist
LINE 14:  select * from source_payment
                        ^

[0m15:28:25.205009 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:28:25.208009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:28:25.210013 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.211008 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: ROLLBACK
[0m15:28:25.212013 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.213007 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:28:25.213007 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m15:28:25.214008 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
alter table "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp" rename to "stg_dvdrental_orders"
[0m15:28:25.214008 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m15:28:25.215008 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.216010 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.217009 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:28:25.217009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:28:25.220010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.220010 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.222010 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m15:28:25.222010 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m15:28:25.223009 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:28:25.225009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C83FB26F0>]}
[0m15:28:25.226008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.227010 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:28:25.226008 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m15:28:25.228009 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:28:25.229010 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_orders__dbt_backup"
[0m15:28:25.230010 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:28:25.230010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.233010 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:28:25.233010 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:28:25.234008 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.234008 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_orders__dbt_backup" cascade
[0m15:28:25.235009 [info ] [Thread-1 (]: 5 of 5 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:28:25.236009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m15:28:25.236009 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:28:25.236009 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:28:25.237008 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.238012 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m15:28:25.239008 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: Close
[0m15:28:25.240009 [debug] [Thread-4 (]: Database Error in model stg_dvdrental_payments (models\staging\stg_dvdrental_payments.sql)
  relation "source_payment" does not exist
  LINE 14:  select * from source_payment
                          ^
  compiled code at target\run\dbt_postgres_prj1\models\staging\stg_dvdrental_payments.sql
[0m15:28:25.242010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.242010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:28:25.243011 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88E57A10>]}
[0m15:28:25.243011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88E96360>]}
[0m15:28:25.244010 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m15:28:25.245009 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_dvdrental_orders ................... [[32mCREATE VIEW[0m in 0.22s]
[0m15:28:25.245009 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.245009 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model public.stg_dvdrental_payments ............. [[31mERROR[0m in 0.22s]
[0m15:28:25.246009 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:28:25.248012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.249013 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:28:25.249013 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:28:25.251009 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m15:28:25.251009 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.stg_dvdrental_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_dvdrental_payments (models\staging\stg_dvdrental_payments.sql)
  relation "source_payment" does not exist
  LINE 14:  select * from source_payment
                          ^
  compiled code at target\run\dbt_postgres_prj1\models\staging\stg_dvdrental_payments.sql.
[0m15:28:25.252008 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88DFD670>]}
[0m15:28:25.252008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.253009 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m15:28:25.253009 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m15:28:25.254008 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:28:25.254008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:25.319534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m15:28:25.320541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.321538 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:28:25.324536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:28:25.327534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.327534 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:28:25.327534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:28:25.330540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.331532 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:28:25.332276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:25.333284 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:28:25.334287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.334287 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:28:25.338467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:28:25.340475 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m15:28:25.340475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:28:25.341476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:28:25.343477 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:28:25.344476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m15:28:25.344476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90618684-88cd-446d-856d-518be68d9faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88E383E0>]}
[0m15:28:25.345476 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m15:28:25.345476 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:28:25.347475 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.348477 [debug] [MainThread]: On master: BEGIN
[0m15:28:25.349478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:25.410733 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:28:25.411733 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.411733 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:25.412733 [debug] [MainThread]: On master: COMMIT
[0m15:28:25.412733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:28:25.412733 [debug] [MainThread]: On master: Close
[0m15:28:25.413733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:25.413733 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m15:28:25.414733 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m15:28:25.414733 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m15:28:25.414733 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m15:28:25.415734 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_orders' was properly closed.
[0m15:28:25.415734 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m15:28:25.415734 [info ] [MainThread]: 
[0m15:28:25.417015 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m15:28:25.418027 [debug] [MainThread]: Command end result
[0m15:28:25.432023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:28:25.434661 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:28:25.438786 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m15:28:25.438786 [info ] [MainThread]: 
[0m15:28:25.440082 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:28:25.440082 [info ] [MainThread]: 
[0m15:28:25.441089 [error] [MainThread]:   Database Error in model stg_dvdrental_payments (models\staging\stg_dvdrental_payments.sql)
  relation "source_payment" does not exist
  LINE 14:  select * from source_payment
                          ^
  compiled code at target\run\dbt_postgres_prj1\models\staging\stg_dvdrental_payments.sql
[0m15:28:25.441089 [info ] [MainThread]: 
[0m15:28:25.442090 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:28:25.443088 [debug] [MainThread]: Command `dbt run` failed at 15:28:25.443088 after 1.48 seconds
[0m15:28:25.443088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C85B65BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C869D2FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C86A0D490>]}
[0m15:28:25.444086 [debug] [MainThread]: Flushing usage events
[0m15:28:25.849923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:08.275764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162FC9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162FC8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162B19970>]}


============================== 15:29:08.278763 | cab59702-ed7d-4611-a143-3642ec22fcb9 ==============================
[0m15:29:08.278763 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:29:08.279763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:08.407638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163B0D700>]}
[0m15:29:08.447892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163979370>]}
[0m15:29:08.448891 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:08.595713 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:29:08.714958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:08.714958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:08.741488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163C9E960>]}
[0m15:29:08.795090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:29:08.798091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:29:08.818115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165360410>]}
[0m15:29:08.818115 [info ] [MainThread]: Found 5 models, 4 data tests, 15 sources, 433 macros
[0m15:29:08.819130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163DAA810>]}
[0m15:29:08.820114 [info ] [MainThread]: 
[0m15:29:08.822113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:08.822113 [info ] [MainThread]: 
[0m15:29:08.823119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:08.826113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m15:29:08.918225 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m15:29:08.919228 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m15:29:08.919228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:08.993728 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m15:29:08.995730 [debug] [ThreadPool]: On list_dvdrental: Close
[0m15:29:08.997729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m15:29:09.001729 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:29:09.001729 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m15:29:09.002730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:09.175868 [debug] [ThreadPool]: SQL status: BEGIN in 0.174 seconds
[0m15:29:09.177048 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:29:09.177557 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:29:09.180564 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.003 seconds
[0m15:29:09.181564 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m15:29:09.182568 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m15:29:09.187728 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.187728 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.187728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:09.256247 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m15:29:09.257247 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.257247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:09.261246 [debug] [MainThread]: SQL status: SELECT 39 in 0.004 seconds
[0m15:29:09.266247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163CCCD10>]}
[0m15:29:09.266247 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:09.267247 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.267247 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.268245 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:29:09.268245 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.269247 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.269247 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.269247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:09.270245 [debug] [MainThread]: On master: Close
[0m15:29:09.274244 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.274244 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.275250 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.275250 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.275250 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:29:09.276250 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m15:29:09.276250 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_dvdrental_orders ........................ [RUN]
[0m15:29:09.277243 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m15:29:09.277243 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m15:29:09.278243 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m15:29:09.278243 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_orders'
[0m15:29:09.279243 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.279243 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m15:29:09.280245 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.280245 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.284245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.285245 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.286245 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.288245 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.290245 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.291243 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.309759 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.315937 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.316944 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.328529 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.328529 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.331529 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.333770 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.333770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.334769 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.334769 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m15:29:09.335769 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.335769 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m15:29:09.335769 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:09.336771 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.336771 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: BEGIN
[0m15:29:09.336771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:29:09.337771 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m15:29:09.337771 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:29:09.338772 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:29:09.422194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m15:29:09.423198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.423198 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:29:09.426196 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m15:29:09.430195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.430195 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:29:09.431701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.433709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.433709 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:29:09.434711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:09.448708 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:29:09.448708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.449707 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:29:09.451709 [debug] [Thread-3 (]: SQL status: BEGIN in 0.114 seconds
[0m15:29:09.453759 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.453759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:29:09.454753 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */

  create view "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m15:29:09.458757 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m15:29:09.461757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:29:09.462757 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m15:29:09.462757 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:29:09.462757 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:29:09.463756 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.465756 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.466756 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m15:29:09.466756 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
alter table "dvdrental"."public"."stg_dvdrental_orders" rename to "stg_dvdrental_orders__dbt_backup"
[0m15:29:09.467754 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.469755 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.470755 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:29:09.470755 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:29:09.470755 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
alter table "dvdrental"."public"."stg_dvdrental_orders__dbt_tmp" rename to "stg_dvdrental_orders"
[0m15:29:09.472756 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m15:29:09.474757 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.475756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:09.476755 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m15:29:09.477754 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:29:09.477754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165BC6D80>]}
[0m15:29:09.478964 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.478964 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.479969 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: COMMIT
[0m15:29:09.479969 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m15:29:09.481461 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:29:09.483467 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:29:09.483467 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:29:09.483467 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.484467 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.486469 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_orders__dbt_backup"
[0m15:29:09.486469 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:29:09.487470 [info ] [Thread-1 (]: 5 of 5 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:29:09.489468 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_orders"
[0m15:29:09.490475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m15:29:09.490475 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_orders"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_orders__dbt_backup" cascade
[0m15:29:09.490475 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:29:09.491472 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.493467 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m15:29:09.493467 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:29:09.495610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.495610 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:29:09.497606 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_orders: Close
[0m15:29:09.497606 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m15:29:09.498603 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165B2A450>]}
[0m15:29:09.498603 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.499604 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:29:09.499604 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_dvdrental_orders ................... [[32mCREATE VIEW[0m in 0.22s]
[0m15:29:09.502603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.503607 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m15:29:09.503607 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_orders
[0m15:29:09.505603 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165A9B290>]}
[0m15:29:09.506641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.505603 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m15:29:09.506641 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m15:29:09.507649 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:29:09.507649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:09.540839 [debug] [Thread-2 (]: SQL status: BEGIN in 0.204 seconds
[0m15:29:09.541842 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.541842 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m15:29:09.545843 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:29:09.547840 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.548839 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m15:29:09.548839 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.550838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.550838 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m15:29:09.551840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.552840 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:29:09.552840 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.553835 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:29:09.555840 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:29:09.556839 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m15:29:09.557841 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:29:09.557841 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m15:29:09.559838 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:29:09.560839 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m15:29:09.560839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165B3CCE0>]}
[0m15:29:09.562213 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.28s]
[0m15:29:09.562717 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:29:09.572724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m15:29:09.572724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.573723 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:29:09.577722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:29:09.579722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.580725 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:29:09.581728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:09.582725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.583724 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:29:09.584726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:09.585724 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:29:09.585724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.586723 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:29:09.588725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:29:09.589725 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m15:29:09.590725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:29:09.590725 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:29:09.592725 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:29:09.593725 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m15:29:09.594724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab59702-ed7d-4611-a143-3642ec22fcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165BAFBC0>]}
[0m15:29:09.594724 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.10s]
[0m15:29:09.595724 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:29:09.596722 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.596722 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.597723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:09.770721 [debug] [MainThread]: SQL status: BEGIN in 0.173 seconds
[0m15:29:09.771716 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.771716 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:09.771716 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.772715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:09.772715 [debug] [MainThread]: On master: Close
[0m15:29:09.773713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:09.773713 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m15:29:09.773713 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_orders' was properly closed.
[0m15:29:09.774708 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m15:29:09.775712 [info ] [MainThread]: 
[0m15:29:09.776710 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:29:09.777712 [debug] [MainThread]: Command end result
[0m15:29:09.791712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:29:09.793715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:29:09.798711 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m15:29:09.798711 [info ] [MainThread]: 
[0m15:29:09.799708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:09.800710 [info ] [MainThread]: 
[0m15:29:09.801710 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:29:09.802710 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:09.802710 after 1.66 seconds
[0m15:29:09.802710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D165507680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D162C10FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D163A054F0>]}
[0m15:29:09.803709 [debug] [MainThread]: Flushing usage events
[0m15:29:10.200135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:18.076277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025813FE6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025811F5DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025811F5ED80>]}


============================== 16:45:18.079281 | 9d197a54-df88-4010-9dd9-8e18608e7f89 ==============================
[0m16:45:18.079281 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:45:18.080280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:18.216927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025814AB74A0>]}
[0m16:45:18.265586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025814AB4950>]}
[0m16:45:18.266586 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:45:18.420128 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:45:18.532693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:18.532693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:18.560218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258151234A0>]}
[0m16:45:18.609529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:45:18.614129 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:45:18.636394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258162A6120>]}
[0m16:45:18.637394 [info ] [MainThread]: Found 6 models, 4 data tests, 15 sources, 433 macros
[0m16:45:18.638394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002581645A150>]}
[0m16:45:18.641396 [info ] [MainThread]: 
[0m16:45:18.642395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:18.642395 [info ] [MainThread]: 
[0m16:45:18.643395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:18.647395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m16:45:18.764023 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m16:45:18.764023 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m16:45:18.764023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.835700 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.072 seconds
[0m16:45:18.836718 [debug] [ThreadPool]: On list_dvdrental: Close
[0m16:45:18.838716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m16:45:18.842723 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:45:18.843718 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m16:45:18.844629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:19.016785 [debug] [ThreadPool]: SQL status: BEGIN in 0.173 seconds
[0m16:45:19.017794 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:45:19.018787 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:45:19.022801 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m16:45:19.023796 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m16:45:19.024800 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m16:45:19.029798 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.030802 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.030802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:19.090804 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m16:45:19.091816 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.092803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:19.097803 [debug] [MainThread]: SQL status: SELECT 40 in 0.004 seconds
[0m16:45:19.101803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258151227B0>]}
[0m16:45:19.102803 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:19.103802 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.103802 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.105450 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:45:19.105450 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.106472 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.106472 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.107477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:19.107477 [debug] [MainThread]: On master: Close
[0m16:45:19.112464 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.112464 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.113465 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.113465 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.114467 [info ] [Thread-1 (]: 1 of 6 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:45:19.115469 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m16:45:19.115469 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m16:45:19.116463 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m16:45:19.116463 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m16:45:19.117467 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m16:45:19.117467 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m16:45:19.118468 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.118468 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals'
[0m16:45:19.118468 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.119465 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.123474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.124474 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.126474 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.128472 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.130472 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.131473 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.132476 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.132476 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.156989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.156989 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.169642 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.172640 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.174641 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.175641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.176642 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m16:45:19.176642 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.176642 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.177641 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:45:19.177641 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m16:45:19.177641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.178642 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m16:45:19.178642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:45:19.179642 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m16:45:19.179642 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:19.180642 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:19.261159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m16:45:19.262159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.262159 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:45:19.266158 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m16:45:19.275168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.275168 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:45:19.276159 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m16:45:19.276159 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m16:45:19.276159 [debug] [Thread-2 (]: SQL status: BEGIN in 0.097 seconds
[0m16:45:19.277159 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.277159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:19.277159 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.278158 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.278158 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m16:45:19.280160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.281158 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m16:45:19.281158 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m16:45:19.281158 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:45:19.283160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.296161 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:45:19.296161 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m16:45:19.297160 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m16:45:19.297160 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m16:45:19.297160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.299161 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.302158 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.303158 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.304162 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:45:19.304162 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m16:45:19.305159 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m16:45:19.305159 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m16:45:19.306158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.306158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.307161 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.308160 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.309159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:45:19.310163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.311159 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:45:19.312160 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m16:45:19.316160 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m16:45:19.317158 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m16:45:19.317158 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.320160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:45:19.321158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:45:19.321158 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:45:19.322162 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:19.322162 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:45:19.323163 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:45:19.324161 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:45:19.324161 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:19.325162 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.325162 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.327161 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m16:45:19.327161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:45:19.327161 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:45:19.327161 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:45:19.330163 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:45:19.331167 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m16:45:19.332571 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m16:45:19.332571 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:19.332571 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m16:45:19.334576 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m16:45:19.337087 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m16:45:19.337087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025813F55910>]}
[0m16:45:19.338085 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:45:19.338085 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:45:19.339086 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:45:19.340085 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m16:45:19.339086 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:45:19.341087 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m16:45:19.341087 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m16:45:19.342085 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:45:19.342085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025815095BE0>]}
[0m16:45:19.343085 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.344086 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:45:19.344086 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:45:19.344086 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.22s]
[0m16:45:19.346086 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m16:45:19.345090 [info ] [Thread-1 (]: 5 of 6 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m16:45:19.347086 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m16:45:19.348085 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:45:19.348085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816A96630>]}
[0m16:45:19.348085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m16:45:19.349086 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816B27FE0>]}
[0m16:45:19.350085 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.350085 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:45:19.353085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.351087 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m16:45:19.353085 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:45:19.354084 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:45:19.355085 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.customers
[0m16:45:19.355085 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.358090 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.356086 [info ] [Thread-4 (]: 6 of 6 START sql view model public.customers ................................... [RUN]
[0m16:45:19.359084 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_rentals, now model.dbt_postgres_prj1.customers)
[0m16:45:19.359084 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m16:45:19.362086 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m16:45:19.362086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.363085 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m16:45:19.363085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:19.364087 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.customers
[0m16:45:19.366086 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m16:45:19.368086 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:45:19.368086 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m16:45:19.368086 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:45:19.435092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m16:45:19.436092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.436599 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m16:45:19.436599 [debug] [Thread-4 (]: SQL status: BEGIN in 0.068 seconds
[0m16:45:19.437604 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:45:19.437604 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_rental,
        customer_orders.most_recent_rental,
        customer_orders.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m16:45:19.439608 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:45:19.442604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.442604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m16:45:19.443604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:45:19.444609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.445607 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "customer_orders" does not exist
LINE 67:     left join customer_orders
                       ^

[0m16:45:19.445607 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:45:19.446604 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: ROLLBACK
[0m16:45:19.446604 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: Close
[0m16:45:19.447605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:45:19.449604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:45:19.449604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.450604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:45:19.451603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:19.452610 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m16:45:19.453607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:45:19.453607 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:45:19.455604 [debug] [Thread-4 (]: Database Error in model customers (models\intermediate\customers.sql)
  relation "customer_orders" does not exist
  LINE 67:     left join customer_orders
                         ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:45:19.456604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:45:19.456604 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816B5DA30>]}
[0m16:45:19.457604 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m16:45:19.458605 [error] [Thread-4 (]: 6 of 6 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.10s]
[0m16:45:19.458605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d197a54-df88-4010-9dd9-8e18608e7f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258169AEA80>]}
[0m16:45:19.459605 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.customers
[0m16:45:19.459605 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m16:45:19.460604 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (models\intermediate\customers.sql)
  relation "customer_orders" does not exist
  LINE 67:     left join customer_orders
                         ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql.
[0m16:45:19.461604 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:45:19.463604 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.463604 [debug] [MainThread]: On master: BEGIN
[0m16:45:19.464604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:19.526617 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m16:45:19.527615 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.528616 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:19.528616 [debug] [MainThread]: On master: COMMIT
[0m16:45:19.528616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:19.529616 [debug] [MainThread]: On master: Close
[0m16:45:19.529616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m16:45:19.530617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m16:45:19.531617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m16:45:19.531617 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m16:45:19.531617 [info ] [MainThread]: 
[0m16:45:19.532617 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m16:45:19.533616 [debug] [MainThread]: Command end result
[0m16:45:19.548646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:45:19.550646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:45:19.556644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m16:45:19.556644 [info ] [MainThread]: 
[0m16:45:19.557645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:45:19.557645 [info ] [MainThread]: 
[0m16:45:19.558644 [error] [MainThread]:   Database Error in model customers (models\intermediate\customers.sql)
  relation "customer_orders" does not exist
  LINE 67:     left join customer_orders
                         ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:45:19.559646 [info ] [MainThread]: 
[0m16:45:19.560645 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:45:19.560645 [debug] [MainThread]: Command `dbt run` failed at 16:45:19.560645 after 1.65 seconds
[0m16:45:19.561645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258110A91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025812598CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025813FE6FF0>]}
[0m16:45:19.561645 [debug] [MainThread]: Flushing usage events
[0m16:45:19.865658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:09.377025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB32E3D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB394B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB3949A60>]}


============================== 16:46:09.380025 | a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5 ==============================
[0m16:46:09.380025 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:46:09.381025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:46:09.509449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB40DBFB0>]}
[0m16:46:09.548503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB4251850>]}
[0m16:46:09.549504 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:46:09.702035 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:46:09.820790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:09.821800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:09.847780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB4209BB0>]}
[0m16:46:09.900354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:46:09.903354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:46:09.923658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB5A76690>]}
[0m16:46:09.924658 [info ] [MainThread]: Found 6 models, 4 data tests, 15 sources, 433 macros
[0m16:46:09.925649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB420A810>]}
[0m16:46:09.927648 [info ] [MainThread]: 
[0m16:46:09.927648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:09.928648 [info ] [MainThread]: 
[0m16:46:09.929647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:09.931647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m16:46:10.027177 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m16:46:10.027177 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m16:46:10.028177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:10.097226 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m16:46:10.099228 [debug] [ThreadPool]: On list_dvdrental: Close
[0m16:46:10.100225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m16:46:10.104226 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:46:10.105226 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m16:46:10.105226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:10.164761 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m16:46:10.166147 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:46:10.166147 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:46:10.170163 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.003 seconds
[0m16:46:10.172149 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m16:46:10.173150 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m16:46:10.178146 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.179154 [debug] [MainThread]: On master: BEGIN
[0m16:46:10.179154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:10.239146 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m16:46:10.240146 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.241146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:10.245145 [debug] [MainThread]: SQL status: SELECT 41 in 0.004 seconds
[0m16:46:10.250160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB3E355B0>]}
[0m16:46:10.251160 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:10.251160 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.251160 [debug] [MainThread]: On master: BEGIN
[0m16:46:10.252718 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:46:10.252718 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.252718 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.253728 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.253728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:46:10.253728 [debug] [MainThread]: On master: Close
[0m16:46:10.259728 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.259728 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.259728 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.260767 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.260767 [info ] [Thread-1 (]: 1 of 6 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:46:10.261726 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m16:46:10.262732 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m16:46:10.261726 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m16:46:10.262732 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m16:46:10.261726 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m16:46:10.263727 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.263727 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m16:46:10.264731 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.264731 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals'
[0m16:46:10.269246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.269246 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.271247 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.271247 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.273249 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.277250 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.277250 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.278246 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.288247 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.302528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.315527 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.317528 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.317528 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.320531 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.321529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.321529 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m16:46:10.322529 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.322529 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.322529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:10.323528 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m16:46:10.324528 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.324528 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m16:46:10.325528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:46:10.325528 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m16:46:10.325528 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:46:10.326529 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:46:10.413395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m16:46:10.414395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.414395 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:46:10.416393 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m16:46:10.417393 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.417393 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m16:46:10.418396 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m16:46:10.423396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.423396 [debug] [Thread-2 (]: SQL status: BEGIN in 0.098 seconds
[0m16:46:10.424394 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m16:46:10.425398 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:46:10.425398 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.426397 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.426397 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m16:46:10.426397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.426397 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:46:10.427398 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m16:46:10.429396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.431399 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.431399 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:46:10.432397 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:46:10.432397 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m16:46:10.434397 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.434397 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:46:10.435398 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.435398 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m16:46:10.436400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.437399 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.439394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.451445 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:46:10.452445 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m16:46:10.452445 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m16:46:10.453445 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m16:46:10.453445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.455444 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.455444 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:46:10.456445 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.456445 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.456445 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m16:46:10.459446 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.462128 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:46:10.462128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:46:10.463138 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m16:46:10.463138 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.463138 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.468646 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m16:46:10.469646 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:46:10.469646 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.470646 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:46:10.473645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:46:10.473645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.474646 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:46:10.475646 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:46:10.476180 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:46:10.476180 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:46:10.476180 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.479190 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m16:46:10.479190 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:46:10.479190 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:46:10.480190 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:46:10.482186 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:46:10.483188 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m16:46:10.485188 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m16:46:10.485188 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m16:46:10.486187 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:46:10.486187 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:46:10.488188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB6207B30>]}
[0m16:46:10.489188 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m16:46:10.490186 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:46:10.490186 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m16:46:10.491188 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:46:10.490186 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:46:10.492187 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m16:46:10.493197 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m16:46:10.493197 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:46:10.494198 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:46:10.494198 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB62CCF80>]}
[0m16:46:10.495188 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.496187 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m16:46:10.496187 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:46:10.497187 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:46:10.497187 [info ] [Thread-1 (]: 5 of 6 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m16:46:10.498189 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB6253BF0>]}
[0m16:46:10.499188 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m16:46:10.500195 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:46:10.501192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m16:46:10.501192 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.24s]
[0m16:46:10.502188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB60DA240>]}
[0m16:46:10.503188 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.503188 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:46:10.506294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.504188 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:46:10.507298 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:46:10.507298 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m16:46:10.508299 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.511305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.508299 [info ] [Thread-3 (]: 6 of 6 START sql view model public.customers ................................... [RUN]
[0m16:46:10.512304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m16:46:10.512304 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m16:46:10.514309 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m16:46:10.515303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.515303 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m16:46:10.516298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:10.516298 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m16:46:10.518302 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m16:46:10.519301 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:46:10.520298 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m16:46:10.520298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:46:10.586022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m16:46:10.587020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.587020 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m16:46:10.590019 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m16:46:10.590019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:46:10.590019 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:46:10.593021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.593021 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_rental,
        customer_orders.most_recent_rental,
        customer_orders.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m16:46:10.593021 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m16:46:10.594021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:46:10.596021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.596021 [debug] [Thread-3 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_orders"
LINE 60:         customer_orders.first_rental,
                 ^

[0m16:46:10.597020 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:46:10.597020 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: ROLLBACK
[0m16:46:10.598020 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m16:46:10.599021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:10.600022 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:46:10.601024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.601024 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:46:10.604022 [debug] [Thread-3 (]: Database Error in model customers (models\intermediate\customers.sql)
  missing FROM-clause entry for table "customer_orders"
  LINE 60:         customer_orders.first_rental,
                   ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:46:10.605021 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB6313CB0>]}
[0m16:46:10.605021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:46:10.605021 [error] [Thread-3 (]: 6 of 6 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.09s]
[0m16:46:10.608021 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m16:46:10.609018 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m16:46:10.609018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:46:10.610029 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (models\intermediate\customers.sql)
  missing FROM-clause entry for table "customer_orders"
  LINE 60:         customer_orders.first_rental,
                   ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql.
[0m16:46:10.610029 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:46:10.613023 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:46:10.614021 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m16:46:10.614021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29a4791-5bc8-4e62-9b36-f6f10c2ba1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB632FE00>]}
[0m16:46:10.615018 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m16:46:10.616019 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:46:10.618020 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.618020 [debug] [MainThread]: On master: BEGIN
[0m16:46:10.619023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:10.796647 [debug] [MainThread]: SQL status: BEGIN in 0.178 seconds
[0m16:46:10.796647 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.797648 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:10.797648 [debug] [MainThread]: On master: COMMIT
[0m16:46:10.798653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:46:10.798653 [debug] [MainThread]: On master: Close
[0m16:46:10.799645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:10.799645 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m16:46:10.799645 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m16:46:10.799645 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m16:46:10.800645 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_customers' was properly closed.
[0m16:46:10.800645 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m16:46:10.801652 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m16:46:10.801652 [info ] [MainThread]: 
[0m16:46:10.803007 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m16:46:10.805017 [debug] [MainThread]: Command end result
[0m16:46:10.819013 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:46:10.822015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:46:10.827012 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m16:46:10.827012 [info ] [MainThread]: 
[0m16:46:10.828013 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:46:10.828013 [info ] [MainThread]: 
[0m16:46:10.829016 [error] [MainThread]:   Database Error in model customers (models\intermediate\customers.sql)
  missing FROM-clause entry for table "customer_orders"
  LINE 60:         customer_orders.first_rental,
                   ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\customers.sql
[0m16:46:10.830015 [info ] [MainThread]: 
[0m16:46:10.830015 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:46:10.831017 [debug] [MainThread]: Command `dbt run` failed at 16:46:10.831017 after 1.59 seconds
[0m16:46:10.831017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB32E3D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB3C0EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB09D29F0>]}
[0m16:46:10.832013 [debug] [MainThread]: Flushing usage events
[0m16:46:11.126141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:07.022355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BCA52B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BA46C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BA47DA0>]}


============================== 16:47:07.026358 | aa520693-d7dc-44bf-99bf-490009000214 ==============================
[0m16:47:07.026358 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:47:07.027355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:47:07.160672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BF0DC40>]}
[0m16:47:07.200193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0912CBF0>]}
[0m16:47:07.201190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:47:07.354779 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:47:07.471063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:07.472066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:07.499595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0B898AA0>]}
[0m16:47:07.552477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:47:07.556464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:47:07.575463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0D8CA0C0>]}
[0m16:47:07.576464 [info ] [MainThread]: Found 6 models, 4 data tests, 15 sources, 433 macros
[0m16:47:07.576464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0D8C5F10>]}
[0m16:47:07.578469 [info ] [MainThread]: 
[0m16:47:07.579466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:07.579466 [info ] [MainThread]: 
[0m16:47:07.580464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:07.583469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m16:47:07.679994 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m16:47:07.679994 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m16:47:07.680995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:07.754811 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m16:47:07.755811 [debug] [ThreadPool]: On list_dvdrental: Close
[0m16:47:07.756810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m16:47:07.760810 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:47:07.761813 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m16:47:07.761813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:07.936595 [debug] [ThreadPool]: SQL status: BEGIN in 0.175 seconds
[0m16:47:07.937595 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m16:47:07.937595 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:47:07.941596 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.003 seconds
[0m16:47:07.942637 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m16:47:07.942637 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m16:47:07.948595 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:07.948595 [debug] [MainThread]: On master: BEGIN
[0m16:47:07.949593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:08.011432 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m16:47:08.012516 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.013466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:08.018432 [debug] [MainThread]: SQL status: SELECT 41 in 0.004 seconds
[0m16:47:08.023431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BF0F050>]}
[0m16:47:08.023431 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:08.024431 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.024431 [debug] [MainThread]: On master: BEGIN
[0m16:47:08.025309 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:47:08.026323 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.026323 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.026323 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.027321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:08.027321 [debug] [MainThread]: On master: Close
[0m16:47:08.031320 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.032323 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.032323 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.032323 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.033320 [info ] [Thread-1 (]: 1 of 6 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m16:47:08.033320 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m16:47:08.034320 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m16:47:08.035319 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m16:47:08.034320 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m16:47:08.035319 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m16:47:08.036321 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m16:47:08.036321 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.036321 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals'
[0m16:47:08.037319 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.037319 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.041319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.042319 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.044344 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.046353 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.048352 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.049351 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.059350 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.074353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.074353 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.074353 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.088359 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.090361 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.093364 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.095362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.096364 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.096364 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.096364 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m16:47:08.096364 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.097873 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m16:47:08.097873 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m16:47:08.097873 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:08.098883 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m16:47:08.098883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:47:08.099881 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:47:08.099881 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:47:08.183103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m16:47:08.183103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.184092 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:47:08.187087 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m16:47:08.191084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.192084 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m16:47:08.192084 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:47:08.193084 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.193084 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m16:47:08.194083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.196081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.196081 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:47:08.196081 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m16:47:08.197080 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:47:08.197080 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.198585 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.199591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:47:08.199591 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m16:47:08.199591 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m16:47:08.200593 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m16:47:08.213590 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:47:08.214596 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.214596 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.214596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.215592 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m16:47:08.215592 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m16:47:08.217593 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.217593 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:47:08.219595 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m16:47:08.220595 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:47:08.224592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.224592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:47:08.226596 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.226596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:47:08.227594 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m16:47:08.231588 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m16:47:08.231588 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m16:47:08.233598 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:47:08.238591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m16:47:08.238591 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:47:08.239590 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.239590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.239590 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m16:47:08.241592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.241592 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m16:47:08.243591 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.243591 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m16:47:08.244589 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m16:47:08.245590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.245590 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:08.245590 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:08.246593 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:47:08.247593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:47:08.248594 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:47:08.250035 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m16:47:08.251044 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.252044 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m16:47:08.253033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.255030 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m16:47:08.255030 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m16:47:08.256031 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m16:47:08.257033 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m16:47:08.257033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DEA55B0>]}
[0m16:47:08.259032 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:08.258035 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m16:47:08.261031 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m16:47:08.261031 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m16:47:08.261031 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:47:08.262032 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m16:47:08.262032 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m16:47:08.264036 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m16:47:08.265031 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m16:47:08.265031 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.266031 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m16:47:08.266031 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m16:47:08.267034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DEF2420>]}
[0m16:47:08.267034 [info ] [Thread-1 (]: 5 of 6 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m16:47:08.268031 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m16:47:08.269031 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:47:08.269031 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m16:47:08.269031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m16:47:08.271032 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m16:47:08.271032 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m16:47:08.271032 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:47:08.272033 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.272033 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DEBD1F0>]}
[0m16:47:08.273035 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m16:47:08.275032 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.277032 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DE25550>]}
[0m16:47:08.276032 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:47:08.277032 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:47:08.278033 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m16:47:08.278033 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.279032 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m16:47:08.282035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.282035 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.customers
[0m16:47:08.283040 [info ] [Thread-2 (]: 6 of 6 START sql view model public.customers ................................... [RUN]
[0m16:47:08.283040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.customers)
[0m16:47:08.284048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.284048 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m16:47:08.284048 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m16:47:08.286049 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m16:47:08.287048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:08.288048 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.customers
[0m16:47:08.290050 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m16:47:08.292049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.292049 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m16:47:08.292049 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:47:08.353185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.061 seconds
[0m16:47:08.354186 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.355186 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m16:47:08.364772 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:47:08.366779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.366779 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m16:47:08.367778 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.368779 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m16:47:08.368779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.369778 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m16:47:08.370763 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:08.372770 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m16:47:08.372770 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m16:47:08.373768 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m16:47:08.374770 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:47:08.375770 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: Close
[0m16:47:08.376768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DFAE750>]}
[0m16:47:08.377775 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m16:47:08.377775 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.customers
[0m16:47:08.453477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m16:47:08.454494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.455516 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m16:47:08.458478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:47:08.461476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.461476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m16:47:08.462477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:08.464478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.464478 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:47:08.465476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:08.467479 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:47:08.467479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.467479 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m16:47:08.471873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:47:08.473872 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m16:47:08.473872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m16:47:08.473872 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m16:47:08.475871 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:47:08.476872 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m16:47:08.477871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa520693-d7dc-44bf-99bf-490009000214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0DF9BEF0>]}
[0m16:47:08.477871 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.21s]
[0m16:47:08.479870 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m16:47:08.481871 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.482871 [debug] [MainThread]: On master: BEGIN
[0m16:47:08.483876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:08.549387 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m16:47:08.549387 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.550387 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:08.550387 [debug] [MainThread]: On master: COMMIT
[0m16:47:08.551387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:08.551387 [debug] [MainThread]: On master: Close
[0m16:47:08.551387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:08.552387 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m16:47:08.552387 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m16:47:08.552387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m16:47:08.553387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m16:47:08.553387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m16:47:08.553387 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m16:47:08.554388 [info ] [MainThread]: 
[0m16:47:08.554388 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m16:47:08.556393 [debug] [MainThread]: Command end result
[0m16:47:08.570386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m16:47:08.572388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m16:47:08.577387 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m16:47:08.577387 [info ] [MainThread]: 
[0m16:47:08.578386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:08.578386 [info ] [MainThread]: 
[0m16:47:08.579387 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:47:08.580387 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:08.580387 after 1.68 seconds
[0m16:47:08.581393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BDC60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B093EAAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B0BC0F650>]}
[0m16:47:08.581393 [debug] [MainThread]: Flushing usage events
[0m16:47:08.922234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:00.136007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF57653320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF575E7B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF575E7AD0>]}


============================== 10:10:00.140008 | a3d24c8f-fefe-48eb-b52a-f213da484f7b ==============================
[0m10:10:00.140008 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:00.140306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:10:00.268127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56ABBFE0>]}
[0m10:10:00.309005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56F43E30>]}
[0m10:10:00.310005 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:10:00.457544 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:10:00.574268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:00.575317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:00.601279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF581FE4E0>]}
[0m10:10:00.650224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:10:00.654214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:10:00.675211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF581FDCD0>]}
[0m10:10:00.676212 [info ] [MainThread]: Found 7 models, 4 data tests, 15 sources, 433 macros
[0m10:10:00.676212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5951AE70>]}
[0m10:10:00.678210 [info ] [MainThread]: 
[0m10:10:00.679210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:00.680210 [info ] [MainThread]: 
[0m10:10:00.681211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:00.684210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:10:00.802259 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:10:00.802259 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:10:00.802259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:00.867747 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m10:10:00.868756 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:10:00.871747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:10:00.875756 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:10:00.876753 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:10:00.876753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:00.936918 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m10:10:00.937918 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:10:00.937918 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:00.940918 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.003 seconds
[0m10:10:00.942919 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:10:00.942919 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:10:00.948924 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:00.949919 [debug] [MainThread]: On master: BEGIN
[0m10:10:00.949919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:01.013818 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m10:10:01.014819 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.015818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:10:01.020877 [debug] [MainThread]: SQL status: SELECT 44 in 0.004 seconds
[0m10:10:01.025875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59597A40>]}
[0m10:10:01.025875 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:01.026876 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.026876 [debug] [MainThread]: On master: BEGIN
[0m10:10:01.027876 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:10:01.028876 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.028876 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.029876 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.030876 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:01.030876 [debug] [MainThread]: On master: Close
[0m10:10:01.035878 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.035878 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.035878 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.035878 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.036876 [info ] [Thread-1 (]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:10:01.036876 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:10:01.037876 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:10:01.037876 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:10:01.038876 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:10:01.038876 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:10:01.039876 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:10:01.039876 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:10:01.039876 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.040876 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.040876 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.040876 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.045875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.046876 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.048876 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.050876 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.051876 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.051876 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.064875 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.074876 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.074876 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.088939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.090939 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.093939 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.094940 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.094940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.095939 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:10:01.096939 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.096939 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:10:01.096939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:10:01.097944 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:10:01.097944 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.097944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:10:01.098939 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:10:01.098939 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:10:01.099939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:10:01.183146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.085 seconds
[0m10:10:01.183146 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.184153 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:10:01.191165 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:10:01.195165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.196165 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:10:01.196165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m10:10:01.197165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.098 seconds
[0m10:10:01.197165 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m10:10:01.197165 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.198165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.198165 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.199165 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.200165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.201164 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:10:01.201164 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:10:01.202165 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:10:01.202165 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:10:01.203678 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.213750 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:10:01.213750 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:10:01.213750 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m10:10:01.214750 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:10:01.214750 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.216749 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.218750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.219750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.220749 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:10:01.220749 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:10:01.221750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:10:01.221750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:10:01.222746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.223749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.223749 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.224749 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:10:01.224749 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m10:10:01.226749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.228750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.229750 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.232751 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:10:01.233750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:10:01.233750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:10:01.234750 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:10:01.237749 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:10:01.238760 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.238760 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:10:01.239760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.240752 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:10:01.240752 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m10:10:01.243754 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:10:01.243754 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:10:01.244750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.245750 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:10:01.246750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.247750 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:10:01.248750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:10:01.248750 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:10:01.249750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:10:01.250750 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:10:01.251748 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59B94470>]}
[0m10:10:01.251748 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.252753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.252753 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:10:01.252753 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.21s]
[0m10:10:01.254752 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:10:01.255750 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:10:01.256750 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:10:01.257750 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:10:01.257750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:10:01.259750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:10:01.260749 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59A53920>]}
[0m10:10:01.260749 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.261750 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:10:01.261750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:10:01.262752 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.22s]
[0m10:10:01.262752 [info ] [Thread-2 (]: 5 of 7 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:10:01.264204 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:10:01.264204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:10:01.265469 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.267492 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.267492 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:10:01.267492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:10:01.268499 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:10:01.269497 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:10:01.270479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59A50D70>]}
[0m10:10:01.270479 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.270479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59B56D50>]}
[0m10:10:01.271479 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:10:01.273485 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.274566 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m10:10:01.274566 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:10:01.275995 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:10:01.276506 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.276506 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.277520 [info ] [Thread-3 (]: 6 of 7 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:10:01.277520 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:10:01.278515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:10:01.278515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:01.279515 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.281519 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.282514 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.284517 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.285844 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.285844 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:10:01.286849 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:01.355851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.077 seconds
[0m10:10:01.355851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.356852 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:10:01.356852 [debug] [Thread-3 (]: SQL status: BEGIN in 0.071 seconds
[0m10:10:01.357852 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.357852 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:10:01.358850 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:10:01.361851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.361851 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:10:01.361851 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:10:01.363854 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.364855 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:10:01.364855 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.367853 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.367853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:10:01.367853 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:10:01.369848 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.370848 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:10:01.370848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.371849 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:10:01.371849 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:01.372851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.373851 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:10:01.373851 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:10:01.373851 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.374849 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:10:01.376049 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.376555 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:10:01.377562 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:10:01.378561 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:10:01.379561 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:10:01.380559 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:10:01.380559 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:10:01.381560 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:10:01.382560 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:10:01.383560 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:10:01.384569 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:10:01.384569 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59C0D5B0>]}
[0m10:10:01.385560 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:10:01.386560 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.12s]
[0m10:10:01.386560 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59C18200>]}
[0m10:10:01.387560 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:10:01.387560 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m10:10:01.388559 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:10:01.388559 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:10:01.389564 [info ] [Thread-1 (]: 7 of 7 START sql view model public.customers ................................... [RUN]
[0m10:10:01.389564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.customers)
[0m10:10:01.390564 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:10:01.392566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:10:01.393563 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:10:01.395568 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:10:01.397564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.397564 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:10:01.397564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:01.459307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m10:10:01.461302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.461302 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:10:01.465306 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:10:01.467306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.468307 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:10:01.468307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:01.469306 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:10:01.470306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.470306 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:10:01.474434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:10:01.477450 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:10:01.478450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:10:01.478450 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:10:01.479450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:10:01.479450 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:10:01.480450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d24c8f-fefe-48eb-b52a-f213da484f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF59B8A870>]}
[0m10:10:01.481450 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m10:10:01.481450 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:10:01.483455 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.483455 [debug] [MainThread]: On master: BEGIN
[0m10:10:01.483455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:01.543990 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m10:10:01.544990 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.544990 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:01.545990 [debug] [MainThread]: On master: COMMIT
[0m10:10:01.545990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:01.546989 [debug] [MainThread]: On master: Close
[0m10:10:01.546989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:10:01.547990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:10:01.548990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:10:01.548990 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m10:10:01.548990 [info ] [MainThread]: 
[0m10:10:01.549988 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m10:10:01.551001 [debug] [MainThread]: Command end result
[0m10:10:01.565989 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:10:01.568990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:10:01.572995 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:10:01.572995 [info ] [MainThread]: 
[0m10:10:01.573990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:01.573990 [info ] [MainThread]: 
[0m10:10:01.574990 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:10:01.574990 [debug] [MainThread]: Command `dbt run` succeeded at 10:10:01.574990 after 1.60 seconds
[0m10:10:01.575989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF572594C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56F976E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF56F97BF0>]}
[0m10:10:01.575989 [debug] [MainThread]: Flushing usage events
[0m10:10:02.023735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:59.878743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6199AEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6213D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B655A0AD0>]}


============================== 10:10:59.881743 | 3def158e-5d1f-40f4-8754-6c1e8b4b6fbb ==============================
[0m10:10:59.881743 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:59.882745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:11:00.012291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65A724E0>]}
[0m10:11:00.051819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B64F45670>]}
[0m10:11:00.052820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:11:00.197365 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:11:00.317279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:00.317279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:00.344839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B660EDD90>]}
[0m10:11:00.399835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:11:00.405840 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:11:00.427855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B672314F0>]}
[0m10:11:00.428858 [info ] [MainThread]: Found 8 models, 4 data tests, 15 sources, 433 macros
[0m10:11:00.428858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B672ED670>]}
[0m10:11:00.430857 [info ] [MainThread]: 
[0m10:11:00.431857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:11:00.431857 [info ] [MainThread]: 
[0m10:11:00.432857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:11:00.435395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:11:00.525407 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:11:00.526406 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:11:00.526406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:00.712589 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.186 seconds
[0m10:11:00.713595 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:11:00.714589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:11:00.718589 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:11:00.719602 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:11:00.719602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:00.780120 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m10:11:00.781124 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:11:00.781124 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:11:00.784125 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m10:11:00.786122 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:11:00.786122 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:11:00.791120 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.792120 [debug] [MainThread]: On master: BEGIN
[0m10:11:00.792120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:00.854059 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m10:11:00.855094 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.856071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:11:00.860059 [debug] [MainThread]: SQL status: SELECT 45 in 0.004 seconds
[0m10:11:00.865062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67230F50>]}
[0m10:11:00.866060 [debug] [MainThread]: On master: ROLLBACK
[0m10:11:00.866060 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.866060 [debug] [MainThread]: On master: BEGIN
[0m10:11:00.867061 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:11:00.867061 [debug] [MainThread]: On master: COMMIT
[0m10:11:00.868060 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:00.868060 [debug] [MainThread]: On master: COMMIT
[0m10:11:00.868060 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:00.869057 [debug] [MainThread]: On master: Close
[0m10:11:00.874057 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:00.874057 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:00.875059 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:00.875059 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:00.875059 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:11:00.876062 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:11:00.876062 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:11:00.877058 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:11:00.877058 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:11:00.878057 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:11:00.879058 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:11:00.879058 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:11:00.880058 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:00.880058 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:00.880058 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:00.881058 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:00.885059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:00.887060 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:00.888264 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:00.889263 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:00.891261 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:00.909262 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:00.915693 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:00.929698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:00.929698 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:00.930698 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:00.932700 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:00.933697 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:00.933697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:00.936210 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:00.936210 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:11:00.937207 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:11:00.937207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:00.938209 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:11:00.938209 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:11:00.938209 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:11:00.939206 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:00.939206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:11:00.940206 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:11:00.941207 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:11:01.029705 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m10:11:01.030707 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.030707 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:11:01.032706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m10:11:01.033705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.033705 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m10:11:01.034706 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:11:01.034706 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:11:01.034706 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.039864 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.040865 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m10:11:01.041247 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:11:01.041247 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m10:11:01.041247 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:11:01.044255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.044255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.045253 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:11:01.045253 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.045253 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:11:01.046253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.048255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.048255 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:11:01.050255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.050255 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:11:01.050255 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:11:01.053254 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.053254 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:11:01.055256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.055256 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:01.056253 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m10:11:01.056253 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:11:01.066252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:11:01.067256 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:11:01.070253 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:11:01.070253 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:11:01.071253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:11:01.071253 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.071253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.074255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.076256 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.076256 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:11:01.076256 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:11:01.077254 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:11:01.077254 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:11:01.078254 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.078254 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.079254 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:11:01.079254 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:11:01.080254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:11:01.081255 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:11:01.081255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.085256 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:11:01.087258 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:11:01.087258 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.087258 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:11:01.091255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:11:01.093255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:11:01.093255 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:11:01.093255 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:11:01.094255 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:11:01.095254 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:11:01.095254 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:11:01.097255 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:11:01.097255 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:11:01.097255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:11:01.099260 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:11:01.100255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:11:01.101254 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:11:01.102254 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:11:01.103256 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:11:01.103256 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:11:01.105254 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:11:01.105254 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B62B42A50>]}
[0m10:11:01.105254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6795B080>]}
[0m10:11:01.106255 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m10:11:01.107255 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m10:11:01.108254 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:11:01.108254 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:11:01.109254 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.109254 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:11:01.110255 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:11:01.110255 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.111255 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:11:01.112255 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:11:01.113256 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:11:01.114262 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_dverental_inventory ..................... [RUN]
[0m10:11:01.114262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:11:01.115254 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67964860>]}
[0m10:11:01.115254 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B679EB260>]}
[0m10:11:01.116254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dverental_inventory)
[0m10:11:01.116254 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.117254 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.24s]
[0m10:11:01.117254 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.24s]
[0m10:11:01.118255 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.120260 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.121259 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:11:01.121259 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:11:01.123261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.124260 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.125259 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.125259 [info ] [Thread-4 (]: 7 of 8 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:11:01.127260 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.128259 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:11:01.128259 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.128259 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.131261 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.132259 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.133259 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.133259 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:11:01.133259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:01.134763 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.134763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.137768 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.138768 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: BEGIN
[0m10:11:01.138768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:01.139767 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.140768 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:11:01.140768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:11:01.214769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m10:11:01.215777 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.215777 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:11:01.218771 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:11:01.218771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m10:11:01.221772 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.221772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.221772 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:11:01.222772 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventory"} */

  create view "dvdrental"."public"."stg_dverental_inventory__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m10:11:01.223773 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.225775 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.225775 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:11:01.225775 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:11:01.226774 [debug] [Thread-4 (]: SQL status: BEGIN in 0.086 seconds
[0m10:11:01.227776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.228782 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.228782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.229774 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventory"} */
alter table "dvdrental"."public"."stg_dverental_inventory__dbt_tmp" rename to "stg_dverental_inventory"
[0m10:11:01.229774 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:11:01.230780 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:11:01.231774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.231774 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.232775 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: COMMIT
[0m10:11:01.232775 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:11:01.233775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.233775 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:11:01.234774 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: COMMIT
[0m10:11:01.236287 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.237286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:11:01.237286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:01.239288 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.239288 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m10:11:01.239288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:11:01.240286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:11:01.241288 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:11:01.243286 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dverental_inventory__dbt_backup"
[0m10:11:01.243286 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:11:01.244286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventory"
[0m10:11:01.244286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:01.245286 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:11:01.245286 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventory"} */
drop view if exists "dvdrental"."public"."stg_dverental_inventory__dbt_backup" cascade
[0m10:11:01.246287 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:11:01.247288 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.247288 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:11:01.248286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:11:01.248286 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:11:01.249287 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventory: Close
[0m10:11:01.250287 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:11:01.250287 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:11:01.251286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67AEEBA0>]}
[0m10:11:01.251286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67A3C890>]}
[0m10:11:01.253286 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:11:01.253286 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_dverental_inventory ................ [[32mCREATE VIEW[0m in 0.14s]
[0m10:11:01.254287 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m10:11:01.255286 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:11:01.255286 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dverental_inventory
[0m10:11:01.256286 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:11:01.256286 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:11:01.257287 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:11:01.258287 [info ] [Thread-3 (]: 8 of 8 START sql view model public.customers ................................... [RUN]
[0m10:11:01.258287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.customers)
[0m10:11:01.258287 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:11:01.261286 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:11:01.261286 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:11:01.262288 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:11:01.263287 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67B2AE70>]}
[0m10:11:01.263287 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:11:01.263287 [info ] [Thread-4 (]: 7 of 8 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.14s]
[0m10:11:01.266287 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:11:01.266287 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:11:01.267287 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.268288 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:11:01.268288 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:11:01.330290 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m10:11:01.331290 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.331290 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:11:01.334798 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:11:01.338809 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.338809 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:11:01.339803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:01.340804 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:11:01.340804 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.341804 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:11:01.346139 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m10:11:01.347145 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:11:01.348144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:11:01.348144 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:11:01.349143 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:11:01.350145 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:11:01.350145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def158e-5d1f-40f4-8754-6c1e8b4b6fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B67B3F920>]}
[0m10:11:01.351148 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m10:11:01.352144 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:11:01.354143 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:01.354143 [debug] [MainThread]: On master: BEGIN
[0m10:11:01.355144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:01.430148 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m10:11:01.431156 [debug] [MainThread]: On master: COMMIT
[0m10:11:01.432153 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:01.432153 [debug] [MainThread]: On master: COMMIT
[0m10:11:01.433147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:01.433147 [debug] [MainThread]: On master: Close
[0m10:11:01.433147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dverental_inventory' was properly closed.
[0m10:11:01.434652 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:11:01.435658 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:11:01.435658 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:11:01.435658 [info ] [MainThread]: 
[0m10:11:01.436658 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m10:11:01.438664 [debug] [MainThread]: Command end result
[0m10:11:01.452657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:11:01.455659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:11:01.460658 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:11:01.461658 [info ] [MainThread]: 
[0m10:11:01.462659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:01.462659 [info ] [MainThread]: 
[0m10:11:01.463657 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:11:01.464658 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:01.464658 after 1.75 seconds
[0m10:11:01.465659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B630391F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B64FA4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B6199AEA0>]}
[0m10:11:01.465659 [debug] [MainThread]: Flushing usage events
[0m10:11:01.874080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:11.358676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0BE4EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5A1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5638F0>]}


============================== 10:14:11.361696 | 08067f73-01c8-45ef-8728-fddd3031ca3b ==============================
[0m10:14:11.361696 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:14:11.362699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:11.494351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C8BBEC0>]}
[0m10:14:11.532350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0CE60920>]}
[0m10:14:11.533351 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:11.690749 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:14:11.813451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:11.813451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:11.840451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0DFAA270>]}
[0m10:14:11.892944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:14:11.896964 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:14:11.919942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E31BE90>]}
[0m10:14:11.920948 [info ] [MainThread]: Found 8 models, 4 data tests, 15 sources, 433 macros
[0m10:14:11.921944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5626F0>]}
[0m10:14:11.922944 [info ] [MainThread]: 
[0m10:14:11.923944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:14:11.924657 [info ] [MainThread]: 
[0m10:14:11.924657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:11.927664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:14:12.026188 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:14:12.026188 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:14:12.027188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:12.095265 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.068 seconds
[0m10:14:12.096264 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:14:12.098265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:14:12.102264 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:12.102264 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:14:12.103265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:12.164407 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m10:14:12.165418 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:12.165418 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:14:12.168303 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m10:14:12.170289 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:14:12.170857 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:14:12.177379 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.178380 [debug] [MainThread]: On master: BEGIN
[0m10:14:12.178380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:12.238568 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m10:14:12.239568 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.239568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:14:12.244564 [debug] [MainThread]: SQL status: SELECT 46 in 0.004 seconds
[0m10:14:12.249565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E2E9460>]}
[0m10:14:12.249565 [debug] [MainThread]: On master: ROLLBACK
[0m10:14:12.250566 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.250566 [debug] [MainThread]: On master: BEGIN
[0m10:14:12.251565 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:14:12.251565 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.252565 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.252565 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.252565 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:12.252565 [debug] [MainThread]: On master: Close
[0m10:14:12.257890 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.257890 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.257890 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.258883 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.258883 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:14:12.258883 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:14:12.259889 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:14:12.260905 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:14:12.259889 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:14:12.260905 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:14:12.261903 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:14:12.261903 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.262903 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:14:12.262903 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.263903 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.267903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.268900 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.270902 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.271911 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.275420 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.276440 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.276440 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.283438 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.301433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.312438 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.313439 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.315439 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.318439 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.319439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.319439 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.320439 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:14:12.320439 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:14:12.320439 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.321439 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.321439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:14:12.321439 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:14:12.322439 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:14:12.322439 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:14:12.323439 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:14:12.323439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:14:12.408990 [debug] [Thread-2 (]: SQL status: BEGIN in 0.087 seconds
[0m10:14:12.409989 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.410990 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:14:12.413991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m10:14:12.413991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.413991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:12.414995 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:14:12.418990 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.419991 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m10:14:12.419991 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m10:14:12.420991 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:14:12.420991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.420991 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.421990 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:14:12.421990 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.421990 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:14:12.422990 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m10:14:12.424990 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.424990 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:12.426987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.426987 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:14:12.428991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.428991 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:14:12.429990 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:14:12.429990 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:14:12.430991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.432990 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.441990 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:14:12.441990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:14:12.442998 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:12.443990 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m10:14:12.445990 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.447991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.448991 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.448991 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:14:12.448991 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.449991 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:14:12.449991 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:12.451991 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.451991 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:12.452991 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:14:12.453991 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:12.453991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:12.453991 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:14:12.454991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.457992 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:12.457992 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:14:12.462008 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:14:12.462008 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:12.463008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.464009 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:12.467008 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:12.468008 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:12.468008 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.469013 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:14:12.469013 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:12.469013 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:12.469013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:14:12.471009 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:14:12.471009 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:14:12.473012 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:14:12.473012 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:12.474008 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:12.475523 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:14:12.477539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:12.478539 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:14:12.478539 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:14:12.480539 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:14:12.480539 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:12.481539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E8F4890>]}
[0m10:14:12.482541 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:14:12.483535 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.22s]
[0m10:14:12.484545 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:12.484545 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.484545 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:14:12.485535 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:14:12.485535 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:14:12.485535 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:14:12.487540 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:14:12.488540 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:14:12.489539 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:14:12.489539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:14:12.490541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E93E660>]}
[0m10:14:12.490541 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E7E28A0>]}
[0m10:14:12.491540 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0CECD6A0>]}
[0m10:14:12.491540 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.492534 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m10:14:12.492534 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:14:12.496717 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.493536 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.23s]
[0m10:14:12.496717 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:12.497728 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:12.498722 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:12.498722 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.499722 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.499722 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.500721 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_dverental_inventories ................... [RUN]
[0m10:14:12.500721 [info ] [Thread-4 (]: 7 of 8 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:14:12.503721 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.503721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dverental_inventories)
[0m10:14:12.504721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:14:12.504721 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.505724 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.505724 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.507722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.508722 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.509722 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:14:12.510722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:14:12.510722 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.510722 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.513716 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.516723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.518717 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.518717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.519727 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:14:12.519727 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: BEGIN
[0m10:14:12.519727 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:14:12.520722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:12.589789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m10:14:12.590789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.590789 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:14:12.593786 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:12.595786 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.596795 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:14:12.597787 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.599794 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.599794 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:14:12.599794 [debug] [Thread-4 (]: SQL status: BEGIN in 0.080 seconds
[0m10:14:12.600791 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.600791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.600791 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:14:12.601789 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:12.602789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.602789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m10:14:12.603787 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:12.603787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.604790 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */

  create view "dvdrental"."public"."stg_dverental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m10:14:12.605793 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:14:12.606789 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.607793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:12.607793 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:14:12.607793 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:14:12.609789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.611789 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:14:12.611789 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
alter table "dvdrental"."public"."stg_dverental_inventories__dbt_tmp" rename to "stg_dverental_inventories"
[0m10:14:12.611789 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:12.612790 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:12.614790 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.614790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:12.615785 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:14:12.615785 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:14:12.616787 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:12.617790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.617790 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:12.617790 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:12.619791 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:12.619791 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:14:12.619791 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.619791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:14:12.620793 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:14:12.621790 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:12.622790 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dverental_inventories__dbt_backup"
[0m10:14:12.623802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0EA37BF0>]}
[0m10:14:12.623802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:12.624794 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:12.625784 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dverental_inventories__dbt_backup" cascade
[0m10:14:12.624794 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.13s]
[0m10:14:12.626791 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:14:12.627788 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:12.628790 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:14:12.629788 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:12.629788 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:14:12.630797 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: Close
[0m10:14:12.631789 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:14:12.632786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0EA77E30>]}
[0m10:14:12.631789 [info ] [Thread-3 (]: 8 of 8 START sql view model public.customers ................................... [RUN]
[0m10:14:12.634786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.customers)
[0m10:14:12.633785 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_dverental_inventories .............. [[32mCREATE VIEW[0m in 0.13s]
[0m10:14:12.634786 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:14:12.635787 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:14:12.635787 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:12.637789 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:14:12.638787 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:14:12.640786 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0DFCCC20>]}
[0m10:14:12.640786 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:14:12.640786 [info ] [Thread-4 (]: 7 of 8 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.14s]
[0m10:14:12.643786 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:14:12.643786 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:12.645789 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.645789 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:14:12.645789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:14:12.822642 [debug] [Thread-3 (]: SQL status: BEGIN in 0.176 seconds
[0m10:14:12.823630 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.824649 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:14:12.827624 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:12.830642 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.831628 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:14:12.832625 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:12.833628 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:12.833628 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.833628 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:12.838549 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m10:14:12.840546 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:14:12.841544 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:12.841544 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:14:12.842545 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:14:12.843549 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:14:12.844546 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08067f73-01c8-45ef-8728-fddd3031ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0EA97A70>]}
[0m10:14:12.844546 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.21s]
[0m10:14:12.845545 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:14:12.847690 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.847690 [debug] [MainThread]: On master: BEGIN
[0m10:14:12.848695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:14:12.915448 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m10:14:12.915448 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.916448 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:12.916448 [debug] [MainThread]: On master: COMMIT
[0m10:14:12.917447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:12.917447 [debug] [MainThread]: On master: Close
[0m10:14:12.918449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:12.918449 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:14:12.918449 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:14:12.919447 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dverental_inventories' was properly closed.
[0m10:14:12.919447 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:14:12.919447 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:14:12.920449 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:14:12.920449 [info ] [MainThread]: 
[0m10:14:12.921450 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m10:14:12.922449 [debug] [MainThread]: Command end result
[0m10:14:12.936446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:14:12.939449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:14:12.944448 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:14:12.944448 [info ] [MainThread]: 
[0m10:14:12.945449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:12.945449 [info ] [MainThread]: 
[0m10:14:12.946449 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:14:12.947446 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:12.947446 after 1.73 seconds
[0m10:14:12.947446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C562E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C562300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C5638F0>]}
[0m10:14:12.948449 [debug] [MainThread]: Flushing usage events
[0m10:14:13.378481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:58.481913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFF2B29F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D824355E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82434740>]}


============================== 10:14:58.484914 | 8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5 ==============================
[0m10:14:58.484914 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:14:58.485911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:14:58.612277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8301D8B0>]}
[0m10:14:58.651279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82FB0920>]}
[0m10:14:58.652278 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:58.801095 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:14:58.918120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:58.919120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:58.946120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844CD460>]}
[0m10:14:58.999128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:14:59.002632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:14:59.023640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844CE000>]}
[0m10:14:59.023640 [info ] [MainThread]: Found 8 models, 4 data tests, 15 sources, 433 macros
[0m10:14:59.024637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844EEB70>]}
[0m10:14:59.026638 [info ] [MainThread]: 
[0m10:14:59.026638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:14:59.027637 [info ] [MainThread]: 
[0m10:14:59.027637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:59.030641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m10:14:59.127156 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m10:14:59.128156 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m10:14:59.128156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:59.201841 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m10:14:59.203347 [debug] [ThreadPool]: On list_dvdrental: Close
[0m10:14:59.205354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m10:14:59.209357 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:59.210355 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m10:14:59.210355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:59.272983 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m10:14:59.272983 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m10:14:59.273984 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:14:59.276984 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m10:14:59.277983 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m10:14:59.277983 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m10:14:59.286983 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.287985 [debug] [MainThread]: On master: BEGIN
[0m10:14:59.287985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:59.349504 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m10:14:59.350503 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.351503 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:14:59.355503 [debug] [MainThread]: SQL status: SELECT 47 in 0.004 seconds
[0m10:14:59.361502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8446AB40>]}
[0m10:14:59.361502 [debug] [MainThread]: On master: ROLLBACK
[0m10:14:59.362504 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.363503 [debug] [MainThread]: On master: BEGIN
[0m10:14:59.364502 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:14:59.365508 [debug] [MainThread]: On master: COMMIT
[0m10:14:59.366503 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.366503 [debug] [MainThread]: On master: COMMIT
[0m10:14:59.367503 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:59.367503 [debug] [MainThread]: On master: Close
[0m10:14:59.372503 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.373503 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.373503 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.373503 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.374503 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:14:59.374503 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m10:14:59.375503 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m10:14:59.376503 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m10:14:59.375503 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m10:14:59.376503 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m10:14:59.377503 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m10:14:59.377503 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.378504 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_payments'
[0m10:14:59.378504 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.378504 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.383504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.383504 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.385507 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.387505 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.390510 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.391510 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.403018 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.424028 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.425025 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.441026 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.441026 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.444028 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.446024 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.446024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.447026 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m10:14:59.448025 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.448025 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:14:59.448025 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m10:14:59.449026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.449026 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.450026 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:14:59.450026 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m10:14:59.450026 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m10:14:59.451026 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:14:59.451026 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:14:59.540539 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m10:14:59.540539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.541539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m10:14:59.541539 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m10:14:59.542539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.543538 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:14:59.544547 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m10:14:59.545539 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.545539 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m10:14:59.545539 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:59.546539 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:14:59.546539 [debug] [Thread-4 (]: SQL status: BEGIN in 0.095 seconds
[0m10:14:59.551541 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.551541 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:14:59.553540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.554540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.554540 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m10:14:59.556545 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.557538 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:14:59.557538 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m10:14:59.558540 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m10:14:59.558540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.559538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.559538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.560541 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.561537 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:59.562540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.564540 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.565542 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m10:14:59.567540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.567540 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:14:59.568539 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m10:14:59.568539 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m10:14:59.568539 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.569540 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.569540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.570540 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.583539 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:59.584542 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:59.588545 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:59.590545 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.590545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.591546 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.591546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.591546 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m10:14:59.592544 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m10:14:59.592544 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m10:14:59.593545 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m10:14:59.593545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.594545 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:59.595546 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.595546 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m10:14:59.598156 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.599169 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.599169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.600165 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m10:14:59.604680 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m10:14:59.605680 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m10:14:59.607680 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m10:14:59.608680 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m10:14:59.612679 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m10:14:59.613681 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m10:14:59.615682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m10:14:59.616680 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m10:14:59.616680 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m10:14:59.617680 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m10:14:59.617680 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:14:59.618680 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m10:14:59.620685 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:14:59.621681 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:14:59.623679 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m10:14:59.623679 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:14:59.624680 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m10:14:59.625686 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m10:14:59.627167 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m10:14:59.629172 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m10:14:59.629172 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84E285C0>]}
[0m10:14:59.630173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D844EE8A0>]}
[0m10:14:59.630173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84D69730>]}
[0m10:14:59.632173 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84D68530>]}
[0m10:14:59.631173 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.25s]
[0m10:14:59.632173 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.25s]
[0m10:14:59.633586 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.25s]
[0m10:14:59.634591 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.25s]
[0m10:14:59.635739 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m10:14:59.635739 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m10:14:59.636749 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m10:14:59.636749 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m10:14:59.637750 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.637750 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.638749 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.638749 [info ] [Thread-3 (]: 5 of 8 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m10:14:59.639748 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_dverental_inventories ................... [RUN]
[0m10:14:59.639748 [info ] [Thread-1 (]: 7 of 8 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m10:14:59.640745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m10:14:59.640745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dverental_inventories)
[0m10:14:59.641751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m10:14:59.641751 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.642745 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.642745 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.644747 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.646745 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.648745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.649747 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.650745 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.650745 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.652746 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.654744 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.657746 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.658745 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.659747 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.659747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.659747 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m10:14:59.660747 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: BEGIN
[0m10:14:59.660747 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m10:14:59.661746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:14:59.661746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:14:59.661746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:59.740271 [debug] [Thread-3 (]: SQL status: BEGIN in 0.079 seconds
[0m10:14:59.741269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.741269 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m10:14:59.742266 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m10:14:59.742266 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.742266 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */

  create view "dvdrental"."public"."stg_dverental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m10:14:59.744269 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:14:59.746269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.746269 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:14:59.747270 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m10:14:59.747270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m10:14:59.749270 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.750265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.750265 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.751270 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
alter table "dvdrental"."public"."stg_dverental_inventories" rename to "stg_dverental_inventories__dbt_backup"
[0m10:14:59.751270 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m10:14:59.753270 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.754268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.754268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m10:14:59.756269 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.756269 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:14:59.756269 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.757268 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
alter table "dvdrental"."public"."stg_dverental_inventories__dbt_tmp" rename to "stg_dverental_inventories"
[0m10:14:59.759267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.760268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:59.760268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.761268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:14:59.761268 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.762267 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:59.763268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m10:14:59.763268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:14:59.763268 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.765268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.766269 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: COMMIT
[0m10:14:59.768268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:14:59.768268 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.770269 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m10:14:59.771270 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:14:59.771270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:59.772270 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m10:14:59.773268 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dverental_inventories__dbt_backup"
[0m10:14:59.774268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:59.775269 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m10:14:59.775269 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dverental_inventories"
[0m10:14:59.776268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.776268 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dverental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dverental_inventories__dbt_backup" cascade
[0m10:14:59.776268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m10:14:59.777268 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:14:59.778268 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m10:14:59.779268 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:14:59.779268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:14:59.780267 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dverental_inventories: Close
[0m10:14:59.780267 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84F5A930>]}
[0m10:14:59.782269 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m10:14:59.783272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84D8FFB0>]}
[0m10:14:59.784271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m10:14:59.783272 [info ] [Thread-3 (]: 5 of 8 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m10:14:59.785267 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:14:59.785267 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_dverental_inventories .............. [[32mCREATE VIEW[0m in 0.14s]
[0m10:14:59.786269 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m10:14:59.787268 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dverental_inventories
[0m10:14:59.788271 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:14:59.789277 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.customers
[0m10:14:59.790279 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m10:14:59.791276 [info ] [Thread-4 (]: 8 of 8 START sql view model public.customers ................................... [RUN]
[0m10:14:59.791276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84F502C0>]}
[0m10:14:59.792277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m10:14:59.792277 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m10:14:59.792277 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.15s]
[0m10:14:59.795281 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m10:14:59.796277 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m10:14:59.798276 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.customers
[0m10:14:59.802286 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m10:14:59.803279 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.803789 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m10:14:59.803789 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:14:59.978562 [debug] [Thread-4 (]: SQL status: BEGIN in 0.175 seconds
[0m10:14:59.979561 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.979561 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m10:14:59.983564 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:14:59.986559 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.986559 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m10:14:59.987564 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:59.988564 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:59.989572 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.989572 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m10:14:59.994573 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m10:14:59.996574 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m10:14:59.997573 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m10:14:59.997573 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m10:14:59.998572 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:14:59.999573 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: Close
[0m10:14:59.999573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a546ba0-4b3f-4ff9-acb4-b9ce580b2de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D84F89040>]}
[0m10:15:00.000572 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.21s]
[0m10:15:00.001572 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.customers
[0m10:15:00.003571 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:00.003571 [debug] [MainThread]: On master: BEGIN
[0m10:15:00.004077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:00.077086 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m10:15:00.078096 [debug] [MainThread]: On master: COMMIT
[0m10:15:00.078096 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:00.079083 [debug] [MainThread]: On master: COMMIT
[0m10:15:00.079083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:15:00.079083 [debug] [MainThread]: On master: Close
[0m10:15:00.080083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:00.080083 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m10:15:00.081084 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m10:15:00.081084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m10:15:00.081084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dverental_inventories' was properly closed.
[0m10:15:00.082084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m10:15:00.082084 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m10:15:00.082084 [info ] [MainThread]: 
[0m10:15:00.083085 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m10:15:00.085083 [debug] [MainThread]: Command end result
[0m10:15:00.102091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m10:15:00.105603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m10:15:00.110602 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m10:15:00.110602 [info ] [MainThread]: 
[0m10:15:00.111601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:00.112602 [info ] [MainThread]: 
[0m10:15:00.112602 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:15:00.114605 [debug] [MainThread]: Command `dbt run` succeeded at 10:15:00.113607 after 1.76 seconds
[0m10:15:00.114605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82B60860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82AE7A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D82E8D910>]}
[0m10:15:00.114605 [debug] [MainThread]: Flushing usage events
[0m10:15:00.503745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:04.862155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E44B26FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4514EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4514C680>]}


============================== 14:26:04.869152 | fc3055d9-4965-4b45-a6f0-0e8ceb811e31 ==============================
[0m14:26:04.869152 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:26:04.870153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:26:05.014220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc3055d9-4965-4b45-a6f0-0e8ceb811e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E44FED370>]}
[0m14:26:05.055220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc3055d9-4965-4b45-a6f0-0e8ceb811e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E42DA2AB0>]}
[0m14:26:05.056222 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:26:05.206605 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:26:05.335481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:26:05.336479 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\intermediate\categories_inventories.sql
[0m14:26:05.475600 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_postgres_prj1.categories_inventories' (models\intermediate\categories_inventories.sql) depends on a node named 'stg_dvdrental_inventories' which was not found
[0m14:26:05.476607 [debug] [MainThread]: Command `dbt run` failed at 14:26:05.476607 after 0.80 seconds
[0m14:26:05.477611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4490B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E46E3AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E45B31940>]}
[0m14:26:05.477611 [debug] [MainThread]: Flushing usage events
[0m14:26:05.796274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:00.861339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168FF1BA5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168FCCDE660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168FFBC53A0>]}


============================== 14:34:00.861339 | 2d413da6-d5e3-4cf2-a31a-21c589164c3f ==============================
[0m14:34:00.861339 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:34:00.861339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:34:01.008883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d413da6-d5e3-4cf2-a31a-21c589164c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168FFCCDB20>]}
[0m14:34:01.048553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d413da6-d5e3-4cf2-a31a-21c589164c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168FFCEFAA0>]}
[0m14:34:01.049270 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:34:01.196713 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:34:01.318499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:34:01.318499 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\intermediate\categories_inventories.sql
[0m14:34:01.433704 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_postgres_prj1.categories_inventories' (models\intermediate\categories_inventories.sql) depends on a node named 'stg_dvdrental_inventories' which was not found
[0m14:34:01.433704 [debug] [MainThread]: Command `dbt run` failed at 14:34:01.433704 after 0.73 seconds
[0m14:34:01.433704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168FFB99FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168803E9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168803815E0>]}
[0m14:34:01.433704 [debug] [MainThread]: Flushing usage events
[0m14:34:01.765700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:09.745836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001826507B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018261ECD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182659C9F40>]}


============================== 14:35:09.745836 | d325b8b8-1952-4932-b708-aac560a234f2 ==============================
[0m14:35:09.745836 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:35:09.745836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:09.881163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018265BAB560>]}
[0m14:35:09.927865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018265A17680>]}
[0m14:35:09.927865 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:10.080149 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:35:10.206105 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m14:35:10.206105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\staging\stg_dvdrental_inventories.sql
[0m14:35:10.206105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_prj1://models\intermediate\categories_inventories.sql
[0m14:35:10.206105 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres_prj1://models\staging\stg_dverental_inventories.sql
[0m14:35:10.378086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267693620>]}
[0m14:35:10.426761 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:35:10.426761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:35:10.457077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182673848F0>]}
[0m14:35:10.457077 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:35:10.457077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001826745CCB0>]}
[0m14:35:10.457077 [info ] [MainThread]: 
[0m14:35:10.457077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:35:10.457077 [info ] [MainThread]: 
[0m14:35:10.457077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:10.457077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:35:10.580875 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:35:10.580875 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:35:10.580875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:10.643685 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m14:35:10.643685 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:35:10.659313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:35:10.663135 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:35:10.663135 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:35:10.663135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:10.722470 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m14:35:10.722470 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:35:10.722470 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:35:10.722470 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m14:35:10.722470 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:35:10.722470 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:35:10.739811 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:10.739811 [debug] [MainThread]: On master: BEGIN
[0m14:35:10.739811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:10.800814 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m14:35:10.800814 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:10.800814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:10.800814 [debug] [MainThread]: SQL status: SELECT 46 in 0.004 seconds
[0m14:35:10.816424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267693140>]}
[0m14:35:10.816424 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:10.816424 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:10.816424 [debug] [MainThread]: On master: BEGIN
[0m14:35:10.816424 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:35:10.821446 [debug] [MainThread]: On master: COMMIT
[0m14:35:10.821446 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:10.821446 [debug] [MainThread]: On master: COMMIT
[0m14:35:10.821446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:35:10.821446 [debug] [MainThread]: On master: Close
[0m14:35:10.821446 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:35:10.821446 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:35:10.821446 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:35:10.821446 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:35:10.821446 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:35:10.821446 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:35:10.821446 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:35:10.821446 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:35:10.832474 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:35:10.832474 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:35:10.832474 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:35:10.832474 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:35:10.832474 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:35:10.832474 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:35:10.832474 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:35:10.832474 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:35:10.832474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:10.832474 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:10.832474 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:10.832474 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:35:10.832474 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:35:10.832474 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:35:10.868679 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:10.869683 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:35:10.869683 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:35:10.884054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:10.885539 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:10.885539 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:35:10.885539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:10.885539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:10.885539 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:10.885539 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:35:10.885539 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:35:10.885539 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:35:10.885539 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:35:10.885539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:10.885539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:35:10.885539 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:35:10.885539 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:35:10.885539 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:35:10.980071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m14:35:10.980071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:10.980071 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:35:10.980071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m14:35:10.980071 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:10.980071 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:35:10.980071 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:35:10.995765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:10.996611 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:35:10.996611 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:35:10.996611 [debug] [Thread-4 (]: SQL status: BEGIN in 0.101 seconds
[0m14:35:10.997318 [debug] [Thread-3 (]: SQL status: BEGIN in 0.103 seconds
[0m14:35:10.997318 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:10.997318 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:35:10.997318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:35:10.997318 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:10.997318 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:35:10.997318 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:35:10.997318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:10.997318 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:35:10.997318 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:35:10.997318 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:10.997318 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:10.997318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:35:10.997318 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:35:10.997318 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:35:10.997318 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:35:11.019979 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:35:11.022503 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:35:11.024506 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:11.024506 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:35:11.025509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:11.025509 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:35:11.026507 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:35:11.027505 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:35:11.027505 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:35:11.028505 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:11.028505 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:11.028505 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:11.029508 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:35:11.030505 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:35:11.030980 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:11.030980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:35:11.030980 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:35:11.030980 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:35:11.030980 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:35:11.030980 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:35:11.030980 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:35:11.030980 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:35:11.030980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:35:11.030980 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:35:11.030980 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:35:11.030980 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:35:11.030980 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:35:11.046613 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:35:11.046613 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:35:11.046613 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:35:11.046613 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:11.046613 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:35:11.046613 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:35:11.046613 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:35:11.046613 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:35:11.046613 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:35:11.046613 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:35:11.046613 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:35:11.046613 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:35:11.046613 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:35:11.046613 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:35:11.046613 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:35:11.046613 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:35:11.046613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267D83A40>]}
[0m14:35:11.046613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182650454F0>]}
[0m14:35:11.046613 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267D66FC0>]}
[0m14:35:11.046613 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:35:11.062280 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m14:35:11.062280 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.21s]
[0m14:35:11.062280 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.21s]
[0m14:35:11.062280 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:35:11.062280 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:35:11.062280 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:35:11.062280 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:35:11.062280 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:35:11.062280 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:35:11.062280 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:35:11.062280 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:35:11.062280 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:35:11.062280 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:35:11.062280 [info ] [Thread-4 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:35:11.070302 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267D66C60>]}
[0m14:35:11.070302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:35:11.071323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:35:11.071323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:35:11.072407 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:35:11.071323 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.24s]
[0m14:35:11.072407 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:35:11.072407 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:35:11.075281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.076100 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:35:11.078105 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.079105 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.080105 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:35:11.082105 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:35:11.082105 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:35:11.081101 [info ] [Thread-3 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:35:11.084882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.084882 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:35:11.084882 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.084882 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.categories_inventories)
[0m14:35:11.084882 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.084882 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:35:11.084882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.084882 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:35:11.084882 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.084882 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:35:11.084882 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.084882 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:35:11.084882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:11.084882 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:35:11.084882 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:35:11.084882 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:11.084882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:11.099354 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:35:11.102408 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:35:11.102408 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:35:11.102408 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:35:11.181803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m14:35:11.181803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.181803 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:35:11.181803 [debug] [Thread-4 (]: SQL status: BEGIN in 0.089 seconds
[0m14:35:11.181803 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.181803 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:35:11.181803 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:35:11.181803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.181803 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:35:11.181803 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:35:11.181803 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.181803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:35:11.181803 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:35:11.229107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.229107 [debug] [Thread-2 (]: SQL status: BEGIN in 0.148 seconds
[0m14:35:11.244758 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:11.244758 [debug] [Thread-3 (]: SQL status: BEGIN in 0.142 seconds
[0m14:35:11.244758 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:35:11.244758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.244758 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.244758 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:35:11.244758 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:35:11.244758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:11.244758 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:35:11.244758 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id as film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.catetory

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select films.category
         sum(film_id_count)
  from inventories_filmid_categories 
  group by films.category
)

select * from final
  );
[0m14:35:11.244758 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:35:11.244758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.244758 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:35:11.244758 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:11.244758 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:35:11.244758 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 49:          sum(film_id_count)
                     ^

[0m14:35:11.244758 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:35:11.244758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:35:11.244758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.244758 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:35:11.244758 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.260389 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:35:11.260389 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:35:11.260389 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:35:11.260389 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:35:11.260389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:35:11.260389 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:11.260389 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:35:11.260389 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:35:11.260389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.260389 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:35:11.260389 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:35:11.260389 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:35:11.260389 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:35:11.260389 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:35:11.260389 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:35:11.260389 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:11.260389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267439B20>]}
[0m14:35:11.260389 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:35:11.260389 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:35:11.260389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.260389 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.19s]
[0m14:35:11.276001 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:35:11.276001 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:35:11.276001 [debug] [Thread-3 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "("
  LINE 49:          sum(film_id_count)
                       ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:35:11.276001 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:35:11.276001 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267D68800>]}
[0m14:35:11.276001 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018267DD6300>]}
[0m14:35:11.276001 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:35:11.276001 [info ] [Thread-4 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.20s]
[0m14:35:11.276001 [error] [Thread-3 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.19s]
[0m14:35:11.283589 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:35:11.283589 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:35:11.284593 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:35:11.285858 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:35:11.286727 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "("
  LINE 49:          sum(film_id_count)
                       ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:35:11.286727 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:35:11.288928 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:35:11.288928 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:35:11.288928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001826763E5D0>]}
[0m14:35:11.288928 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.22s]
[0m14:35:11.288928 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:35:11.293253 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:35:11.294268 [info ] [Thread-1 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:35:11.295268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m14:35:11.295268 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:35:11.297267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:35:11.299269 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:35:11.302091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:35:11.303089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:35:11.304088 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:35:11.304088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:11.374392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m14:35:11.375392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:35:11.375392 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:35:11.379392 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:35:11.381232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:35:11.382239 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:35:11.382239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:35:11.383238 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:35:11.384243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:35:11.384243 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:35:11.386249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:35:11.388247 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:35:11.388247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:35:11.389240 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:35:11.389240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:35:11.390234 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:35:11.391233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd325b8b8-1952-4932-b708-aac560a234f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001826621EAE0>]}
[0m14:35:11.391233 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m14:35:11.392235 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:35:11.394237 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:11.395233 [debug] [MainThread]: On master: BEGIN
[0m14:35:11.396233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:11.449497 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m14:35:11.449497 [debug] [MainThread]: On master: COMMIT
[0m14:35:11.449497 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:11.449497 [debug] [MainThread]: On master: COMMIT
[0m14:35:11.449497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:35:11.449497 [debug] [MainThread]: On master: Close
[0m14:35:11.464279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:11.464279 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:35:11.464279 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:35:11.465515 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:35:11.465515 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:35:11.465515 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m14:35:11.465515 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:35:11.465515 [info ] [MainThread]: 
[0m14:35:11.465515 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m14:35:11.465515 [debug] [MainThread]: Command end result
[0m14:35:11.485344 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:35:11.487414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:35:11.487414 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:35:11.487414 [info ] [MainThread]: 
[0m14:35:11.487414 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:35:11.494577 [info ] [MainThread]: 
[0m14:35:11.494577 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "("
  LINE 49:          sum(film_id_count)
                       ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:35:11.495628 [info ] [MainThread]: 
[0m14:35:11.496624 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:35:11.496624 [debug] [MainThread]: Command `dbt run` failed at 14:35:11.496624 after 1.90 seconds
[0m14:35:11.497642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182659C9F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182658CFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018265B5D9A0>]}
[0m14:35:11.497642 [debug] [MainThread]: Flushing usage events
[0m14:35:11.880597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:59.995392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE750A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE750A480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE750A360>]}


============================== 14:37:00.003390 | fd64503f-56d8-480e-a5af-02bf229756cf ==============================
[0m14:37:00.003390 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:00.004391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:37:00.138473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE7B26BD0>]}
[0m14:37:00.176009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE81ACDA0>]}
[0m14:37:00.177008 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:00.333497 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:00.467600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:00.467600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:00.494600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE995B680>]}
[0m14:37:00.547816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:00.551821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:00.572337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE99ABF80>]}
[0m14:37:00.573337 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:37:00.574338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE965EB70>]}
[0m14:37:00.575338 [info ] [MainThread]: 
[0m14:37:00.576337 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:00.577337 [info ] [MainThread]: 
[0m14:37:00.578339 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:00.581337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:37:00.684592 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:37:00.685596 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:37:00.685596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:00.870911 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.185 seconds
[0m14:37:00.871911 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:37:00.873912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:37:00.878913 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:00.878913 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:37:00.878913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:00.946278 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m14:37:00.946278 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:00.947281 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:00.955278 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.008 seconds
[0m14:37:00.955787 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:37:00.956795 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:37:00.964871 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:00.964871 [debug] [MainThread]: On master: BEGIN
[0m14:37:00.964871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:01.130028 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m14:37:01.131032 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:01.132026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:01.142029 [debug] [MainThread]: SQL status: SELECT 47 in 0.009 seconds
[0m14:37:01.148032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE9F05970>]}
[0m14:37:01.149034 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:01.149034 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:01.149034 [debug] [MainThread]: On master: BEGIN
[0m14:37:01.150034 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:01.151034 [debug] [MainThread]: On master: COMMIT
[0m14:37:01.151034 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:01.151034 [debug] [MainThread]: On master: COMMIT
[0m14:37:01.152031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:01.152031 [debug] [MainThread]: On master: Close
[0m14:37:01.156539 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:01.156539 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:01.157539 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:01.157539 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:01.157539 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:37:01.158540 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:37:01.158540 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:37:01.159540 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:37:01.159540 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:37:01.160539 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:37:01.160539 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:37:01.160539 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:01.161541 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:37:01.161541 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:01.161541 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:01.167541 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.168539 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:01.169543 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.171540 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.173540 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.174539 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:01.193540 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:01.200542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.201539 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:01.212541 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.212541 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:01.214540 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.217539 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.217539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.218540 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.218540 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:37:01.219540 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.219540 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:37:01.220540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.220540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:01.220540 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:37:01.221541 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:37:01.221541 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:37:01.222540 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:37:01.222540 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:37:01.313572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m14:37:01.314577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.314577 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:37:01.318571 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:37:01.323570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.324572 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:37:01.324572 [debug] [Thread-2 (]: SQL status: BEGIN in 0.104 seconds
[0m14:37:01.325570 [debug] [Thread-3 (]: SQL status: BEGIN in 0.103 seconds
[0m14:37:01.325570 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.325570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.326570 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.326570 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:37:01.328570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.329572 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:37:01.329572 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:37:01.331571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:01.346585 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:01.347588 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m14:37:01.347588 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:37:01.348600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.350588 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.352586 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.352586 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:01.353587 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:37:01.353587 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:37:01.354586 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:01.354586 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:01.355587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:01.357643 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.359641 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.363645 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:37:01.364647 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:37:01.364647 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:37:01.367646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:01.368646 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:37:01.368646 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:01.369644 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:01.370644 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:01.371642 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:37:01.372643 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:37:01.372643 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.372643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.374642 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:37:01.375644 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:01.375644 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:37:01.377642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE9F089E0>]}
[0m14:37:01.377642 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:01.377642 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:01.379645 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:37:01.378643 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m14:37:01.381644 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:37:01.383646 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:01.384645 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:01.385643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:01.385643 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:37:01.386645 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:01.386645 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:37:01.387644 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:37:01.387644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:37:01.388643 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:01.389643 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.390643 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:37:01.390643 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:37:01.391644 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:37:01.392644 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:37:01.393644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE9FCB560>]}
[0m14:37:01.393644 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:01.394646 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE9F09D90>]}
[0m14:37:01.398641 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.394646 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m14:37:01.398641 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.23s]
[0m14:37:01.399642 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:01.400644 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:01.400644 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:01.401642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.401642 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:01.402644 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:37:01.402644 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:37:01.403643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:37:01.403643 [info ] [Thread-3 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:37:01.403643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:01.404642 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:01.404642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:37:01.406643 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.407641 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:01.409642 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.409642 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:01.412642 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.412642 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:01.414646 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.415646 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.416646 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:37:01.416646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:01.417644 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.417644 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:37:01.418644 [debug] [Thread-4 (]: SQL status: BEGIN in 0.196 seconds
[0m14:37:01.418644 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:01.418644 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.419645 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:37:01.422646 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:37:01.426645 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.426645 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:37:01.428644 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.431646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.431646 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:37:01.432642 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.434641 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:37:01.434641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.434641 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:37:01.436645 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:01.438646 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:37:01.439646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:01.439646 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:37:01.441657 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:37:01.442656 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:37:01.443656 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAEA071400>]}
[0m14:37:01.443656 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.28s]
[0m14:37:01.444654 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:01.445655 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:37:01.446656 [info ] [Thread-4 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:37:01.447656 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.categories_inventories)
[0m14:37:01.448657 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:37:01.451656 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:01.452656 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:37:01.455652 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:01.456158 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:01.457164 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:37:01.457164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:01.492162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m14:37:01.493162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.493162 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:37:01.496163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:37:01.499168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.499168 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:37:01.500167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.502167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.502167 [debug] [Thread-2 (]: SQL status: BEGIN in 0.085 seconds
[0m14:37:01.503166 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:37:01.503166 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.503166 [debug] [Thread-3 (]: SQL status: BEGIN in 0.085 seconds
[0m14:37:01.504165 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:37:01.504165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.504165 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.505166 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:37:01.506167 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:37:01.506167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.507164 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:37:01.509163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:01.510168 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:37:01.510168 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:37:01.511163 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:37:01.511163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:01.514164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.516169 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.516169 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:37:01.517163 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:37:01.517163 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:37:01.518164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.518164 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.518164 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:37:01.520164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.522168 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.523166 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:37:01.523166 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:37:01.524165 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:37:01.524165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAEA04B3B0>]}
[0m14:37:01.525164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:01.526164 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:01.526164 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.14s]
[0m14:37:01.527163 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:37:01.528165 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:01.529168 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:01.529168 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.530164 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.530164 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:37:01.531165 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:01.532067 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:01.534075 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:37:01.534075 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:37:01.535073 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:01.536074 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:37:01.537074 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:37:01.537074 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:01.538076 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:37:01.539073 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:37:01.540074 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:37:01.540074 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:37:01.540074 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAEA098650>]}
[0m14:37:01.541081 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:37:01.542079 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m14:37:01.542079 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAEA041790>]}
[0m14:37:01.543080 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:01.544080 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.14s]
[0m14:37:01.544080 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:37:01.545085 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:01.546080 [info ] [Thread-1 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:37:01.546080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m14:37:01.547081 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:37:01.549085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:37:01.550085 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:37:01.553081 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:37:01.554079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:01.554079 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:37:01.554079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:01.625587 [debug] [Thread-4 (]: SQL status: BEGIN in 0.168 seconds
[0m14:37:01.625587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m14:37:01.626587 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:01.626587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:01.626587 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id as film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.catetory

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select films.category
         sum(filmid_count)
  from inventories_filmid_categories 
  group by films.category
)

select * from final
  );
[0m14:37:01.627594 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:37:01.628587 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 49:          sum(filmid_count)
                     ^

[0m14:37:01.628587 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:37:01.628587 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:37:01.631588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:37:01.633586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:01.633586 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:37:01.635587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:01.636595 [debug] [Thread-4 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "("
  LINE 49:          sum(filmid_count)
                       ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:37:01.637588 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:37:01.638587 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE9A2BBF0>]}
[0m14:37:01.638587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:01.639588 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:37:01.639588 [error] [Thread-4 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.19s]
[0m14:37:01.640588 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:37:01.640588 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "("
  LINE 49:          sum(filmid_count)
                       ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:37:01.643797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:37:01.645888 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:37:01.645888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:01.646884 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:37:01.646884 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:37:01.647885 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:37:01.648892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd64503f-56d8-480e-a5af-02bf229756cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAEA0C30B0>]}
[0m14:37:01.648892 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m14:37:01.650885 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:37:01.651884 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:01.652886 [debug] [MainThread]: On master: BEGIN
[0m14:37:01.652886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:01.823288 [debug] [MainThread]: SQL status: BEGIN in 0.170 seconds
[0m14:37:01.824264 [debug] [MainThread]: On master: COMMIT
[0m14:37:01.825584 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:01.825584 [debug] [MainThread]: On master: COMMIT
[0m14:37:01.826605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:01.826605 [debug] [MainThread]: On master: Close
[0m14:37:01.827612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:01.828596 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:37:01.828596 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:37:01.828596 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:37:01.828596 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:37:01.829591 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:37:01.829591 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m14:37:01.830596 [info ] [MainThread]: 
[0m14:37:01.830596 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m14:37:01.831892 [debug] [MainThread]: Command end result
[0m14:37:01.892550 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:01.895553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:01.899551 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:37:01.899551 [info ] [MainThread]: 
[0m14:37:01.900551 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:01.901552 [info ] [MainThread]: 
[0m14:37:01.902552 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "("
  LINE 49:          sum(filmid_count)
                       ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:37:01.903609 [info ] [MainThread]: 
[0m14:37:01.904619 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:37:01.905620 [debug] [MainThread]: Command `dbt run` failed at 14:37:01.905620 after 2.09 seconds
[0m14:37:01.906618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE77EDEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE74D7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE795AF00>]}
[0m14:37:01.906618 [debug] [MainThread]: Flushing usage events
[0m14:37:02.311785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:44.631731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2696E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C28D8EEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C28D8C560>]}


============================== 14:37:44.636736 | 873a53a6-d519-4246-8129-5d6381afede1 ==============================
[0m14:37:44.636736 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:44.638731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:37:44.766277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29EF2870>]}
[0m14:37:44.808121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29977FB0>]}
[0m14:37:44.809121 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:44.975666 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:45.110571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:45.110571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:45.138569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29B4E270>]}
[0m14:37:45.190119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:45.193119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:45.216112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B2CBE60>]}
[0m14:37:45.217118 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:37:45.217118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29F1A810>]}
[0m14:37:45.219118 [info ] [MainThread]: 
[0m14:37:45.220118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:45.221118 [info ] [MainThread]: 
[0m14:37:45.222119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:45.225118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:37:45.316199 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:37:45.316199 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:37:45.317199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:45.397737 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.081 seconds
[0m14:37:45.398741 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:37:45.400740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:37:45.405740 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:45.405740 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:37:45.405740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:45.465743 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m14:37:45.466748 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:37:45.467741 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:45.475751 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.008 seconds
[0m14:37:45.477755 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:37:45.477755 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:37:45.483269 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:45.484286 [debug] [MainThread]: On master: BEGIN
[0m14:37:45.484286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:45.546282 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m14:37:45.547293 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:45.547293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:45.555290 [debug] [MainThread]: SQL status: SELECT 47 in 0.008 seconds
[0m14:37:45.560286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29EF1F70>]}
[0m14:37:45.561285 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:45.561285 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:45.562286 [debug] [MainThread]: On master: BEGIN
[0m14:37:45.562286 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:45.563293 [debug] [MainThread]: On master: COMMIT
[0m14:37:45.563293 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:45.564289 [debug] [MainThread]: On master: COMMIT
[0m14:37:45.564289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:45.564289 [debug] [MainThread]: On master: Close
[0m14:37:45.569300 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:45.569300 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:45.569300 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:45.570296 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:45.570296 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:37:45.571299 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:37:45.571299 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:37:45.572308 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:37:45.572308 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:37:45.573302 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:37:45.573302 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:37:45.574300 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:45.574300 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:37:45.574300 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:45.575303 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:45.579300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.580300 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:45.581300 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.582813 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.585828 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.586828 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:45.605041 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:45.613050 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.613050 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:45.626041 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.627042 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:45.630042 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.633042 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.634042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.634042 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.634819 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:37:45.634819 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.635843 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:37:45.635843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:45.635843 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.636836 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:37:45.636836 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:37:45.636836 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:37:45.637830 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:37:45.638830 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:37:45.733904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m14:37:45.734908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.735903 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:37:45.740902 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:37:45.745904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.745904 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:37:45.746902 [debug] [Thread-2 (]: SQL status: BEGIN in 0.110 seconds
[0m14:37:45.746902 [debug] [Thread-3 (]: SQL status: BEGIN in 0.109 seconds
[0m14:37:45.746902 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.747903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.747903 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.747903 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:37:45.750903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.750903 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:37:45.751902 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:37:45.752903 [debug] [Thread-4 (]: SQL status: BEGIN in 0.114 seconds
[0m14:37:45.752903 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.753903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:45.753903 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:37:45.767907 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:45.767907 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m14:37:45.767907 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m14:37:45.768912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.770912 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.772914 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.773914 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:37:45.773914 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:37:45.773914 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:37:45.774914 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:37:45.776914 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.776914 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:37:45.777912 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:45.777912 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:45.777912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:45.780912 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.780912 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:37:45.783421 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.786430 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:37:45.787428 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:37:45.789428 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.789428 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:37:45.793428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:37:45.793428 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:37:45.793428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.794429 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:37:45.794429 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.795429 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:45.796427 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:45.797432 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:37:45.797432 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.798432 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:37:45.799431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:37:45.799431 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.799431 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:37:45.800430 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.801430 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:37:45.802429 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:37:45.802429 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:37:45.804429 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:45.804429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29F44C20>]}
[0m14:37:45.805427 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:45.805427 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:45.806431 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:37:45.808427 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:37:45.807427 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m14:37:45.810432 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:37:45.812426 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:37:45.813429 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:37:45.813429 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:37:45.814430 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:37:45.814430 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:37:45.815428 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:37:45.815428 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:45.815428 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:37:45.816427 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:37:45.817428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:37:45.817428 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:45.819427 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.819427 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:37:45.819427 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:37:45.820431 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:37:45.821428 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:37:45.822427 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:37:45.823426 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:37:45.823426 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:45.824431 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29F99CD0>]}
[0m14:37:45.824431 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B81DF10>]}
[0m14:37:45.825428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B81E090>]}
[0m14:37:45.828427 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.828427 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:37:45.829427 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.25s]
[0m14:37:45.830428 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.25s]
[0m14:37:45.831428 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:37:45.831428 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:37:45.832430 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:37:45.832430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.832430 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:45.833436 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:45.833436 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:37:45.834432 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:37:45.834432 [info ] [Thread-3 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:37:45.834432 [info ] [Thread-4 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:37:45.835427 [info ] [Thread-2 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:37:45.835427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:45.836427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:37:45.836427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:37:45.837430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.categories_inventories)
[0m14:37:45.837430 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:45.838426 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:45.838426 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:37:45.840430 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.842431 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.845427 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:45.846428 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:45.847427 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:45.847427 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:37:45.849427 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.854428 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.857428 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:45.858429 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.859429 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.859429 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:45.859429 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:37:45.860427 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:37:45.860427 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:37:45.860427 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:45.861430 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:45.861430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:45.915614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m14:37:45.916614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.917614 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:37:45.920617 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:37:45.923621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.923621 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:37:45.924614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.925619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.926616 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:37:45.926616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.928617 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:37:45.928617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.928617 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:37:45.933615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:37:45.934615 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:37:45.935619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:37:45.935619 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:37:45.937615 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:37:45.938622 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:37:45.938622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B91B7A0>]}
[0m14:37:45.939617 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.12s]
[0m14:37:45.940616 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:37:45.947615 [debug] [Thread-3 (]: SQL status: BEGIN in 0.086 seconds
[0m14:37:45.947615 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.948624 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:37:45.950618 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:37:45.950618 [debug] [Thread-4 (]: SQL status: BEGIN in 0.090 seconds
[0m14:37:45.953691 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.953691 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.954693 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:37:45.954693 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:37:45.955693 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.957696 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.957696 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:37:45.957696 [debug] [Thread-2 (]: SQL status: BEGIN in 0.096 seconds
[0m14:37:45.958691 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:37:45.958691 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:37:45.958691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.960694 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.961692 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id as film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.catetory

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select films.category,
         sum(filmid_count)
  from inventories_filmid_categories 
  group by films.category
)

select * from final
  );
[0m14:37:45.962689 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:37:45.962689 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:37:45.963690 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.963690 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:37:45.964689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:45.964689 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
LINE 34:       inventories_filmid.film_id.
               ^

[0m14:37:45.966694 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.966694 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:37:45.967693 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:37:45.967693 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:37:45.969703 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:37:45.970698 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:37:45.970698 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:37:45.971698 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:45.972701 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:37:45.973700 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:45.974698 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.974698 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:37:45.975700 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:37:45.976706 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:37:45.976706 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:37:45.978701 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:37:45.979700 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B9942C0>]}
[0m14:37:45.979700 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:37:45.980700 [info ] [Thread-3 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m14:37:45.981700 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:37:45.981700 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:37:45.983204 [debug] [Thread-2 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:37:45.984307 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:37:45.984307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B9B8980>]}
[0m14:37:45.984307 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:37:45.985319 [info ] [Thread-1 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:37:45.986318 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:37:45.985319 [error] [Thread-2 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.15s]
[0m14:37:45.987325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m14:37:45.987325 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B991910>]}
[0m14:37:45.988323 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:37:45.988323 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:37:45.989318 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:37:45.989318 [info ] [Thread-4 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.15s]
[0m14:37:45.992324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:37:45.993325 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:37:45.994318 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:37:45.997319 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:37:45.998319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:45.998319 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:37:45.999320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:46.060320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m14:37:46.061320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:46.061320 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:37:46.065321 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:37:46.067322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:46.067322 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:37:46.068320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:46.069331 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:37:46.070328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:46.070328 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:37:46.074578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:37:46.075584 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:37:46.076583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:37:46.076583 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:37:46.078582 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:37:46.079585 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:37:46.079585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a53a6-d519-4246-8129-5d6381afede1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B96A360>]}
[0m14:37:46.080584 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m14:37:46.081583 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:37:46.081583 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:46.083088 [debug] [MainThread]: On master: BEGIN
[0m14:37:46.083088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:46.144094 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m14:37:46.145104 [debug] [MainThread]: On master: COMMIT
[0m14:37:46.145104 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:46.146093 [debug] [MainThread]: On master: COMMIT
[0m14:37:46.146093 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:46.147093 [debug] [MainThread]: On master: Close
[0m14:37:46.147093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:46.148093 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:37:46.148093 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:37:46.148093 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:37:46.148093 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m14:37:46.149092 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:37:46.149092 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:37:46.149092 [info ] [MainThread]: 
[0m14:37:46.150093 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m14:37:46.152097 [debug] [MainThread]: Command end result
[0m14:37:46.207611 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:37:46.209611 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:37:46.214611 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:37:46.214611 [info ] [MainThread]: 
[0m14:37:46.215611 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:46.215611 [info ] [MainThread]: 
[0m14:37:46.216611 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:37:46.216611 [info ] [MainThread]: 
[0m14:37:46.217611 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:37:46.218611 [debug] [MainThread]: Command `dbt run` failed at 14:37:46.218611 after 1.78 seconds
[0m14:37:46.219612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B76EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C27431760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C29202870>]}
[0m14:37:46.219612 [debug] [MainThread]: Flushing usage events
[0m14:37:46.604853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:46.154596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410028A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241007E73B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024100C962A0>]}


============================== 14:41:46.162593 | b6271ce8-40af-47aa-9de1-a54836671754 ==============================
[0m14:41:46.162593 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:41:46.163597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:41:46.304551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024100DE24E0>]}
[0m14:41:46.344110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241006B7FB0>]}
[0m14:41:46.345114 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:41:46.497165 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:41:46.625254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:46.625254 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:46.651253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410145D970>]}
[0m14:41:46.705950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:41:46.708955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:41:46.730467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410277B800>]}
[0m14:41:46.730467 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:41:46.731468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102726FF0>]}
[0m14:41:46.733468 [info ] [MainThread]: 
[0m14:41:46.734467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:46.734467 [info ] [MainThread]: 
[0m14:41:46.735466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:46.739467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:41:46.841997 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:41:46.842983 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:41:46.842983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:47.026923 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.184 seconds
[0m14:41:47.028920 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:41:47.031932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:41:47.035921 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:41:47.035921 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:41:47.035921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:47.107936 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m14:41:47.107936 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:41:47.108937 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:41:47.114931 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.005 seconds
[0m14:41:47.115930 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:41:47.116933 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:41:47.122445 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.122445 [debug] [MainThread]: On master: BEGIN
[0m14:41:47.122445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:47.299995 [debug] [MainThread]: SQL status: BEGIN in 0.177 seconds
[0m14:41:47.299995 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.299995 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:47.309000 [debug] [MainThread]: SQL status: SELECT 47 in 0.008 seconds
[0m14:41:47.315999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241013B9D30>]}
[0m14:41:47.315999 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:47.316999 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.316999 [debug] [MainThread]: On master: BEGIN
[0m14:41:47.318003 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:41:47.318003 [debug] [MainThread]: On master: COMMIT
[0m14:41:47.319003 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.319003 [debug] [MainThread]: On master: COMMIT
[0m14:41:47.319003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:47.319999 [debug] [MainThread]: On master: Close
[0m14:41:47.324517 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:41:47.324517 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:41:47.325518 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:41:47.325518 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:41:47.325518 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:41:47.326516 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:41:47.326516 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:41:47.327518 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:41:47.328517 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:41:47.328517 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:41:47.329522 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:41:47.330517 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:41:47.330517 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:41:47.331516 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:41:47.331516 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:41:47.331516 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:41:47.336523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.338519 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.340519 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.341518 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.343519 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:41:47.343519 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:41:47.368519 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.369518 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:41:47.369518 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:41:47.380521 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.382519 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.384518 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.385517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.386518 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:41:47.386518 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.386518 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.387519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:47.387519 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.387519 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:41:47.388520 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:41:47.388520 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:41:47.389518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:47.389518 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:47.390522 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:47.474044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m14:41:47.474044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.475044 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:41:47.478046 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:41:47.482041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.483044 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:41:47.483044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m14:41:47.484042 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.484042 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m14:41:47.484042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.485048 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:41:47.485048 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.487044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.488044 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m14:41:47.488044 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:41:47.489044 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:41:47.489044 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.490040 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:41:47.490040 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:41:47.490040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.492046 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.492046 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:41:47.493044 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:41:47.505045 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:41:47.505045 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:41:47.507043 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.509050 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.510050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.510050 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:41:47.510050 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.511050 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:41:47.511050 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:41:47.514051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.514051 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:41:47.514051 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:41:47.515052 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.516049 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.517054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:41:47.519053 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.519053 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:41:47.519053 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:41:47.523566 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:41:47.523566 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:41:47.524563 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:41:47.527575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:41:47.528569 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:41:47.528569 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.528569 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:47.529566 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:41:47.530566 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:41:47.530566 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:41:47.531568 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:41:47.532569 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.532569 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.533565 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:41:47.533565 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:41:47.534565 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:41:47.534565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m14:41:47.537565 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:41:47.537565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:41:47.538575 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:41:47.540573 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:41:47.544569 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:41:47.546566 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:41:47.549572 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:41:47.549572 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:41:47.550564 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:41:47.552567 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:41:47.552567 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:41:47.553567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102D72BA0>]}
[0m14:41:47.553567 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:41:47.554567 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m14:41:47.555566 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:41:47.556568 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:41:47.556568 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:41:47.556568 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:41:47.556568 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:41:47.558564 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:41:47.559568 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:41:47.560570 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:41:47.560570 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:41:47.561567 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102D58B30>]}
[0m14:41:47.561567 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102CD9F70>]}
[0m14:41:47.562565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024101447080>]}
[0m14:41:47.563566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:41:47.564565 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.23s]
[0m14:41:47.564565 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.23s]
[0m14:41:47.566042 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.23s]
[0m14:41:47.567050 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:41:47.568054 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:41:47.569053 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:41:47.570051 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:41:47.573051 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.574050 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:41:47.575050 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:41:47.576049 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:41:47.577050 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:41:47.578050 [info ] [Thread-4 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:41:47.579049 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:41:47.579049 [info ] [Thread-3 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:41:47.580051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:41:47.582053 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:41:47.586051 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.588054 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.categories_inventories)
[0m14:41:47.589052 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:41:47.589052 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:41:47.590053 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:41:47.592050 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.594054 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.594054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.597055 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:41:47.599051 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:41:47.599051 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:41:47.600054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:47.601053 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:41:47.601053 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:41:47.604053 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.606053 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.608061 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:41:47.610060 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.611061 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.611061 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:41:47.612059 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:41:47.612059 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:41:47.612059 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:47.613062 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:47.613062 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:41:47.614058 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:47.699340 [debug] [Thread-4 (]: SQL status: BEGIN in 0.087 seconds
[0m14:41:47.700341 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.700341 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:41:47.701337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.101 seconds
[0m14:41:47.701337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.702340 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:41:47.704343 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:41:47.706342 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.706342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m14:41:47.706342 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:41:47.707350 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:41:47.707350 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.709350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.710350 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:41:47.710350 [debug] [Thread-3 (]: SQL status: BEGIN in 0.096 seconds
[0m14:41:47.711352 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.711352 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:41:47.712350 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:41:47.713350 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.714349 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:41:47.714349 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id as film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.catetory

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select films.category,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_categories 
  group by films.category
)

select * from final
  );
[0m14:41:47.714349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:47.715350 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:41:47.717349 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.718349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.719351 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
LINE 34:       inventories_filmid.film_id.
               ^

[0m14:41:47.719351 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:41:47.720350 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:41:47.720350 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.720350 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:41:47.722358 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:41:47.722358 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.722871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.722871 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:41:47.722871 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.724881 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.725881 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:41:47.726882 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:41:47.727885 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:41:47.727885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.728879 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:41:47.729880 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:47.730878 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:41:47.730878 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.731884 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:41:47.732878 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m14:41:47.732878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:41:47.732878 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:47.734882 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:41:47.736879 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:41:47.738883 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:41:47.739880 [debug] [Thread-3 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:41:47.739880 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:41:47.740877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:41:47.740877 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:41:47.741881 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102E7EC90>]}
[0m14:41:47.741881 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:41:47.742885 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:41:47.742885 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:41:47.743892 [error] [Thread-3 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.15s]
[0m14:41:47.744879 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:41:47.744879 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:41:47.745902 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:41:47.745902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:41:47.745902 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:41:47.747885 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:41:47.748881 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:41:47.749877 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:41:47.749877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102CDB650>]}
[0m14:41:47.750881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410257B320>]}
[0m14:41:47.750881 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102CDB560>]}
[0m14:41:47.751879 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:41:47.752879 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.19s]
[0m14:41:47.753879 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:41:47.753879 [info ] [Thread-4 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.17s]
[0m14:41:47.754881 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:41:47.755881 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:41:47.755881 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:41:47.756880 [info ] [Thread-3 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:41:47.757882 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.categories_inventories, now model.dbt_postgres_prj1.customers)
[0m14:41:47.757882 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:41:47.759882 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:41:47.761882 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:41:47.763879 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:41:47.765888 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:41:47.765888 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:41:47.765888 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:47.828401 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m14:41:47.829405 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:41:47.830406 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:41:47.834404 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:41:47.836402 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:41:47.836402 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:41:47.837400 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:47.838400 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:41:47.839400 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:41:47.839400 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:41:47.843399 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:41:47.846401 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:41:47.847402 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:41:47.847402 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:41:47.848400 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:41:47.849401 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:41:47.849401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6271ce8-40af-47aa-9de1-a54836671754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102CD9D30>]}
[0m14:41:47.850400 [info ] [Thread-3 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m14:41:47.851402 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:41:47.852402 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.853404 [debug] [MainThread]: On master: BEGIN
[0m14:41:47.853404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:47.917407 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m14:41:47.917407 [debug] [MainThread]: On master: COMMIT
[0m14:41:47.918406 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.918406 [debug] [MainThread]: On master: COMMIT
[0m14:41:47.918406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:47.919404 [debug] [MainThread]: On master: Close
[0m14:41:47.919404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:47.920404 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:41:47.920404 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:41:47.920404 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m14:41:47.921406 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:41:47.921406 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:41:47.921406 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:41:47.922406 [info ] [MainThread]: 
[0m14:41:47.922406 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m14:41:47.924556 [debug] [MainThread]: Command end result
[0m14:41:47.989553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:41:47.992552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:41:47.997553 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:41:47.997553 [info ] [MainThread]: 
[0m14:41:47.998550 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:41:47.999551 [info ] [MainThread]: 
[0m14:41:47.999551 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:41:48.000554 [info ] [MainThread]: 
[0m14:41:48.000554 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:41:48.001556 [debug] [MainThread]: Command `dbt run` failed at 14:41:48.001556 after 1.99 seconds
[0m14:41:48.001556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024100A9BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241007E73B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241007B4140>]}
[0m14:41:48.002556 [debug] [MainThread]: Flushing usage events
[0m14:41:48.440270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:45.189000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E6196150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E369E7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E64CE2A0>]}


============================== 14:44:45.192000 | bb45d653-150f-4b24-9d59-252fa6c19319 ==============================
[0m14:44:45.192000 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:44:45.193000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:45.322541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E5E081A0>]}
[0m14:44:45.366365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E5C082F0>]}
[0m14:44:45.367367 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:44:45.515582 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:44:45.630356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:45.631356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:45.658909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E6D6A2D0>]}
[0m14:44:45.708321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:44:45.711321 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:44:45.732454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E8117770>]}
[0m14:44:45.733463 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:44:45.734333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E6D689B0>]}
[0m14:44:45.735356 [info ] [MainThread]: 
[0m14:44:45.736357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:45.737253 [info ] [MainThread]: 
[0m14:44:45.738260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:45.741265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:44:45.832243 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:44:45.833243 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:44:45.833243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:45.902820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.070 seconds
[0m14:44:45.903819 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:44:45.905820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:44:45.911189 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:44:45.911189 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:44:45.911189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:45.971970 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m14:44:45.971970 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:44:45.972966 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:44:45.975977 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m14:44:45.977973 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:44:45.977973 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:44:45.984975 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:45.984975 [debug] [MainThread]: On master: BEGIN
[0m14:44:45.984975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:46.156127 [debug] [MainThread]: SQL status: BEGIN in 0.171 seconds
[0m14:44:46.157133 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.157133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:46.162131 [debug] [MainThread]: SQL status: SELECT 47 in 0.004 seconds
[0m14:44:46.168131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E387D070>]}
[0m14:44:46.168131 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:46.169132 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.169132 [debug] [MainThread]: On master: BEGIN
[0m14:44:46.170132 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:44:46.171131 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.171131 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.172132 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.173419 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:46.173419 [debug] [MainThread]: On master: Close
[0m14:44:46.178424 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:44:46.178424 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:44:46.179425 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:44:46.178424 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:44:46.179425 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:44:46.180434 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:44:46.180434 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:44:46.181424 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:44:46.182424 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:44:46.182424 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:44:46.183423 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:44:46.183423 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:44:46.184426 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:44:46.184426 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:44:46.184426 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:44:46.190425 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.192430 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.193424 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:44:46.194432 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.197428 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.197428 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:44:46.198424 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:44:46.230426 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.231427 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:44:46.245430 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.247431 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.248434 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:44:46.249431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.251431 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.251431 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.252431 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:44:46.252431 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.253432 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:44:46.253432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:46.253432 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.254431 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:44:46.254431 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:44:46.255431 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:44:46.255431 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:44:46.256432 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:44:46.345478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m14:44:46.346476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.346476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:44:46.349476 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:44:46.349476 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m14:44:46.354490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.355480 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.355480 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m14:44:46.356495 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:44:46.356495 [debug] [Thread-4 (]: SQL status: BEGIN in 0.101 seconds
[0m14:44:46.357579 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:44:46.358108 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.358108 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.359115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.359115 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:44:46.360114 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:44:46.362115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.362115 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:44:46.363114 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:44:46.365116 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.365116 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:44:46.366113 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:44:46.366113 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:44:46.368116 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.369116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:44:46.371115 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.371115 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:44:46.371115 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:46.387114 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:44:46.388115 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:44:46.391116 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.391116 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:44:46.391116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.392116 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:44:46.392116 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:46.394117 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.395113 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:44:46.397115 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.397115 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:46.398114 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:44:46.398114 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:44:46.399114 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:44:46.400116 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:46.400116 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.401116 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.402117 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:44:46.402117 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:44:46.402117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:44:46.403114 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:44:46.404113 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.408114 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:44:46.408114 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:44:46.409113 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.410113 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:44:46.414114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:44:46.415115 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:44:46.416115 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:44:46.416115 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:44:46.418114 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:44:46.419115 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:44:46.420113 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m14:44:46.420113 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:44:46.421114 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:44:46.422120 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:46.424118 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:44:46.425113 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:44:46.426114 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:44:46.427113 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:44:46.427113 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:44:46.428113 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:44:46.430113 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:44:46.430113 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:44:46.430113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E87969C0>]}
[0m14:44:46.431114 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E866BEF0>]}
[0m14:44:46.432113 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:44:46.433113 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.25s]
[0m14:44:46.434114 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:44:46.433113 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:44:46.435113 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:44:46.436113 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:44:46.437119 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:44:46.437119 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:44:46.438115 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E8669D60>]}
[0m14:44:46.438115 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:44:46.439113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E8729B20>]}
[0m14:44:46.439113 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:44:46.440113 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.25s]
[0m14:44:46.440113 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:44:46.442119 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:44:46.441114 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.26s]
[0m14:44:46.442119 [info ] [Thread-3 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:44:46.443119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:44:46.443119 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:44:46.444120 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:44:46.445118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:44:46.445118 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:44:46.446119 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:44:46.445118 [info ] [Thread-4 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:44:46.446119 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:44:46.449122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.449122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:44:46.449122 [info ] [Thread-2 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:44:46.451119 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.452120 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:44:46.453118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.categories_inventories)
[0m14:44:46.454119 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.455119 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:44:46.455119 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:44:46.455119 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:44:46.458632 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.460630 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:44:46.463630 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.463630 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:44:46.466630 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.466630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.467630 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.467630 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:44:46.467630 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:44:46.468630 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:44:46.470631 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:44:46.470631 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.470631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:46.471631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:46.471631 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:44:46.472630 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:44:46.473630 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:44:46.473630 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:44:46.474630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:46.566140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m14:44:46.567140 [debug] [Thread-4 (]: SQL status: BEGIN in 0.093 seconds
[0m14:44:46.567140 [debug] [Thread-3 (]: SQL status: BEGIN in 0.096 seconds
[0m14:44:46.567140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.568140 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.568140 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.569142 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:44:46.569142 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:44:46.569142 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:44:46.570142 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m14:44:46.570142 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:44:46.571143 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id as film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.catetory

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

)

final as (

  select films.category,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_categories 
  group by films.category
)

select * from final
  );
[0m14:44:46.572142 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "final"
LINE 46: final as (
         ^

[0m14:44:46.572142 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:44:46.572142 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:44:46.573143 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:44:46.573143 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:44:46.575145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.577147 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.579147 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.580142 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:44:46.580142 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:44:46.580142 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:44:46.581148 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:44:46.582142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.583142 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.583142 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.585143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.587144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.589147 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.589147 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:44:46.589147 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:44:46.590143 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:44:46.591143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:46.592142 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:44:46.592142 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.593142 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:46.593142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.594146 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:44:46.595142 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:44:46.596142 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:44:46.596142 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.597142 [debug] [Thread-2 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "final"
  LINE 46: final as (
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:44:46.597142 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.598144 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:44:46.598144 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E8803E90>]}
[0m14:44:46.599146 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:44:46.601697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:44:46.602705 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:44:46.602705 [error] [Thread-2 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.15s]
[0m14:44:46.604708 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:44:46.604708 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:44:46.607710 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:44:46.607710 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:44:46.608708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:44:46.609707 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:44:46.610709 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:44:46.611706 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "final"
  LINE 46: final as (
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:44:46.611706 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:44:46.612708 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:44:46.612708 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:44:46.613708 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:44:46.614707 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:44:46.615710 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:44:46.616710 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:44:46.616710 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:46.617707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E882A0F0>]}
[0m14:44:46.618708 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:44:46.619709 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:44:46.620707 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:44:46.620707 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E87DE240>]}
[0m14:44:46.621707 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E888DC40>]}
[0m14:44:46.621707 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:44:46.622706 [info ] [Thread-3 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.18s]
[0m14:44:46.623709 [info ] [Thread-4 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.17s]
[0m14:44:46.624706 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:44:46.625715 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:44:46.626709 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:44:46.627707 [info ] [Thread-2 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:44:46.627707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.categories_inventories, now model.dbt_postgres_prj1.customers)
[0m14:44:46.628705 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:44:46.630710 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:44:46.631706 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:44:46.634707 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:44:46.635704 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:44:46.635704 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:44:46.636709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:46.697266 [debug] [Thread-2 (]: SQL status: BEGIN in 0.060 seconds
[0m14:44:46.698266 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:44:46.699272 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:44:46.703266 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:44:46.705268 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:44:46.705268 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:44:46.706268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:46.707271 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:44:46.707271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:44:46.708269 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:44:46.712747 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:44:46.713759 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:44:46.714746 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:44:46.714746 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:44:46.715771 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:44:46.716747 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:44:46.716747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb45d653-150f-4b24-9d59-252fa6c19319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E8736FF0>]}
[0m14:44:46.717745 [info ] [Thread-2 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m14:44:46.718745 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:44:46.720742 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.721744 [debug] [MainThread]: On master: BEGIN
[0m14:44:46.721744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:46.784272 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m14:44:46.785272 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.785272 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.786279 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.786279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:46.787275 [debug] [MainThread]: On master: Close
[0m14:44:46.787275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:46.787275 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:44:46.788270 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:44:46.788270 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m14:44:46.788270 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:44:46.789272 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:44:46.789272 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:44:46.789272 [info ] [MainThread]: 
[0m14:44:46.790268 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m14:44:46.792272 [debug] [MainThread]: Command end result
[0m14:44:46.849287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:44:46.852288 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:44:46.857805 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:44:46.857805 [info ] [MainThread]: 
[0m14:44:46.858821 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:44:46.858821 [info ] [MainThread]: 
[0m14:44:46.859821 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "final"
  LINE 46: final as (
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:44:46.860821 [info ] [MainThread]: 
[0m14:44:46.861821 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:44:46.862821 [debug] [MainThread]: Command `dbt run` failed at 14:44:46.861821 after 1.85 seconds
[0m14:44:46.862821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E605D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E638BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E6388290>]}
[0m14:44:46.862821 [debug] [MainThread]: Flushing usage events
[0m14:44:47.257605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:18.812918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C130C2E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1339BB680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1339BBFB0>]}


============================== 14:45:18.816918 | a4303505-8a28-436f-b016-4d900a7ead98 ==============================
[0m14:45:18.816918 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:45:18.817919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:45:18.954476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1341F9DF0>]}
[0m14:45:18.995034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C133AA66F0>]}
[0m14:45:18.996030 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:45:19.166568 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:45:19.290619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:19.291621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:19.321616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C133C60770>]}
[0m14:45:19.371625 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:45:19.375626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:45:19.395148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13569CB30>]}
[0m14:45:19.396154 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:45:19.397148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1342F8D70>]}
[0m14:45:19.399148 [info ] [MainThread]: 
[0m14:45:19.399148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:45:19.400144 [info ] [MainThread]: 
[0m14:45:19.401146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:19.403146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:45:19.502667 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:45:19.502667 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:45:19.503666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:19.585181 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.082 seconds
[0m14:45:19.586182 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:45:19.588183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:45:19.594183 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:45:19.594183 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:45:19.594183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:19.670188 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m14:45:19.670188 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:45:19.670188 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:45:19.676186 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.005 seconds
[0m14:45:19.677186 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:45:19.678186 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:45:19.683699 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:19.684701 [debug] [MainThread]: On master: BEGIN
[0m14:45:19.684701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:19.752695 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m14:45:19.753700 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:19.754703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:45:19.760697 [debug] [MainThread]: SQL status: SELECT 47 in 0.005 seconds
[0m14:45:19.765697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C134359CA0>]}
[0m14:45:19.766699 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:19.766699 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:19.767709 [debug] [MainThread]: On master: BEGIN
[0m14:45:19.767709 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:45:19.768714 [debug] [MainThread]: On master: COMMIT
[0m14:45:19.768714 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:19.769703 [debug] [MainThread]: On master: COMMIT
[0m14:45:19.769703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:19.769703 [debug] [MainThread]: On master: Close
[0m14:45:19.773707 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:45:19.773707 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:45:19.774708 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:45:19.774708 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:45:19.774708 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:45:19.775706 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:45:19.775706 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:45:19.776707 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:45:19.776707 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:45:19.777708 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:45:19.777708 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:45:19.778708 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:45:19.778708 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:45:19.778708 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:45:19.779706 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:45:19.779706 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:45:19.784221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:19.786222 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:19.788223 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:19.790226 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:19.791224 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:45:19.792223 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:45:19.792223 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:45:19.792223 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:45:19.819221 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:19.820227 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:19.834222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:19.836222 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:19.837222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:19.838221 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:19.838221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:19.839222 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:45:19.839222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:19.840221 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:45:19.840221 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:45:19.840221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:19.841222 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:45:19.841222 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:45:19.841222 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:19.842221 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:45:19.933747 [debug] [Thread-3 (]: SQL status: BEGIN in 0.093 seconds
[0m14:45:19.934745 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:19.934745 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:45:19.938745 [debug] [Thread-2 (]: SQL status: BEGIN in 0.098 seconds
[0m14:45:19.939746 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:19.939746 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:45:19.941745 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:45:19.941745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m14:45:19.947744 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:19.947744 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:45:19.947744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:19.948746 [debug] [Thread-4 (]: SQL status: BEGIN in 0.106 seconds
[0m14:45:19.948746 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:45:19.950746 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:19.951745 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:45:19.951745 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:19.952745 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:45:19.952745 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:19.952745 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:45:19.954751 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:19.955746 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:45:19.955746 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:45:19.955746 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:45:19.958744 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:19.958744 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:45:19.960745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:19.960745 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:45:19.961745 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:19.963749 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:19.963749 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:45:19.972751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:45:19.975755 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:45:19.975755 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:45:19.977759 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:45:19.977759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:19.977759 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:19.978754 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:19.978754 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:19.980754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:19.980754 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:45:19.980754 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:45:19.983272 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:19.983272 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:45:19.984269 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:45:19.985271 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:19.986269 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:45:19.986269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:45:19.986269 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:19.986269 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:45:19.987274 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:19.990269 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:45:19.994271 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:45:19.995269 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:45:19.996269 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:45:19.996269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:20.001274 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:45:20.001274 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:45:20.002271 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:45:20.002271 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:45:20.003270 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:45:20.003270 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:20.005268 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:45:20.005268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:20.006269 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:45:20.006269 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:45:20.007272 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:45:20.008269 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:45:20.010272 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:45:20.011270 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:45:20.011270 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:45:20.014270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:45:20.015269 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:45:20.016270 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135D49550>]}
[0m14:45:20.016270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135BE9D30>]}
[0m14:45:20.018268 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:45:20.017269 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.24s]
[0m14:45:20.019269 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:45:20.018268 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.24s]
[0m14:45:20.020268 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:45:20.020268 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:45:20.021268 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:45:20.022267 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:45:20.023269 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135B3EA80>]}
[0m14:45:20.023269 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:45:20.023269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135CA99D0>]}
[0m14:45:20.024270 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:45:20.024270 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.24s]
[0m14:45:20.025268 [info ] [Thread-3 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:45:20.025268 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.25s]
[0m14:45:20.027269 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:45:20.026270 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:45:20.027269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:45:20.028271 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:45:20.028271 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:45:20.028271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:45:20.029270 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:45:20.029270 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:45:20.030271 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:45:20.030271 [info ] [Thread-4 (]: 7 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:45:20.032271 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.033269 [info ] [Thread-1 (]: 8 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:45:20.035268 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.035268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.categories_inventories)
[0m14:45:20.036269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:45:20.036269 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:45:20.037268 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:45:20.037268 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:45:20.039280 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:45:20.039280 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:45:20.041270 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.043269 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.046269 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.047270 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:45:20.049270 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:45:20.049270 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.050274 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:45:20.050274 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:45:20.050274 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.052272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.053270 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:20.053270 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:45:20.054269 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:45:20.054269 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:45:20.055269 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:20.055269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.056271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:20.057271 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:45:20.058269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:20.144794 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m14:45:20.144794 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.145794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.090 seconds
[0m14:45:20.145794 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:45:20.146797 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.146797 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:45:20.148798 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:45:20.149796 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:45:20.151798 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.153802 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.154793 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m14:45:20.154793 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:45:20.154793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m14:45:20.155795 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:45:20.155795 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:45:20.156797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.156797 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:20.156797 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id as film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.catetory

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select films.category,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_categories 
  group by films.category
)

select * from final
  );
[0m14:45:20.157795 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:20.157795 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:45:20.159795 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.161796 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.161796 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
LINE 34:       inventories_filmid.film_id.
               ^

[0m14:45:20.162794 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:45:20.162794 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:45:20.162794 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:45:20.163796 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:20.163796 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:20.164795 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:45:20.165795 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:45:20.166795 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:45:20.167804 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:45:20.167804 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.168801 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.170800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.170800 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:45:20.171802 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:45:20.171802 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:45:20.172803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:20.174804 [debug] [Thread-4 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:45:20.177672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.178671 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m14:45:20.178671 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m14:45:20.178671 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135D88380>]}
[0m14:45:20.179671 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:45:20.180677 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:45:20.183181 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:45:20.184180 [error] [Thread-4 (]: 7 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.14s]
[0m14:45:20.184180 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:45:20.185181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:20.185181 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:45:20.186180 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:45:20.186180 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:45:20.187181 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:45:20.188180 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:45:20.188180 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:45:20.189180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.190181 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:45:20.190181 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:20.190181 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:20.191180 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:45:20.192180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:20.192180 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:45:20.193181 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135D9D490>]}
[0m14:45:20.195182 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:45:20.195182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135D9E360>]}
[0m14:45:20.196180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:45:20.196180 [info ] [Thread-3 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:45:20.197180 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:45:20.197180 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:45:20.199180 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:45:20.200180 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:45:20.201180 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:45:20.201180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:45:20.201180 [info ] [Thread-4 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:45:20.202180 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:45:20.203181 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.categories_inventories, now model.dbt_postgres_prj1.customers)
[0m14:45:20.203181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135D9D0D0>]}
[0m14:45:20.204179 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:45:20.207180 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:45:20.204179 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.17s]
[0m14:45:20.208180 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:45:20.208180 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:45:20.211190 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:45:20.212179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:45:20.213180 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:45:20.213180 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:20.382013 [debug] [Thread-4 (]: SQL status: BEGIN in 0.169 seconds
[0m14:45:20.383030 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:45:20.384032 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:45:20.388021 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:45:20.390019 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:45:20.390019 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:45:20.391018 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:20.392021 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:45:20.393019 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:45:20.393019 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:45:20.397243 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m14:45:20.398250 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:45:20.399248 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:45:20.399248 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:45:20.400247 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:45:20.401249 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:45:20.401249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4303505-8a28-436f-b016-4d900a7ead98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135D9D3D0>]}
[0m14:45:20.402249 [info ] [Thread-4 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m14:45:20.403247 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:45:20.405248 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:20.405248 [debug] [MainThread]: On master: BEGIN
[0m14:45:20.406248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:20.469199 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m14:45:20.470200 [debug] [MainThread]: On master: COMMIT
[0m14:45:20.471191 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:20.471191 [debug] [MainThread]: On master: COMMIT
[0m14:45:20.472187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:20.472187 [debug] [MainThread]: On master: Close
[0m14:45:20.473187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:20.473187 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:45:20.474186 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:45:20.474186 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:45:20.474186 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:45:20.475187 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m14:45:20.475187 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:45:20.475187 [info ] [MainThread]: 
[0m14:45:20.476187 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m14:45:20.478187 [debug] [MainThread]: Command end result
[0m14:45:20.535932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:45:20.537933 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:45:20.543990 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:45:20.543990 [info ] [MainThread]: 
[0m14:45:20.545001 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:45:20.545999 [info ] [MainThread]: 
[0m14:45:20.545999 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:45:20.546998 [info ] [MainThread]: 
[0m14:45:20.546998 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:45:20.547998 [debug] [MainThread]: Command `dbt run` failed at 14:45:20.547998 after 1.88 seconds
[0m14:45:20.548997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C133B10140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C133359A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1341DB830>]}
[0m14:45:20.548997 [debug] [MainThread]: Flushing usage events
[0m14:45:20.926417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:14.740541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F3B89FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F3B880E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F3B897C0>]}


============================== 14:50:14.743541 | 7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525 ==============================
[0m14:50:14.743541 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:50:14.744541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:50:14.869316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F4117260>]}
[0m14:50:14.912998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F4230950>]}
[0m14:50:14.915001 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:50:15.078553 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:50:15.205857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:15.206857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:15.238860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F4C2B710>]}
[0m14:50:15.297409 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:50:15.301408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:50:15.323408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F60A8AD0>]}
[0m14:50:15.323408 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:50:15.324408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F4D6A810>]}
[0m14:50:15.326408 [info ] [MainThread]: 
[0m14:50:15.327408 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:15.330000 [info ] [MainThread]: 
[0m14:50:15.330415 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:15.334410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:50:15.429948 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:50:15.429948 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:50:15.429948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:15.499489 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m14:50:15.500487 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:50:15.503486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:50:15.506486 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:50:15.507487 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:50:15.507487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:15.571500 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m14:50:15.572500 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:50:15.572500 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:15.577500 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.005 seconds
[0m14:50:15.580500 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:50:15.581500 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:50:15.587025 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:15.588024 [debug] [MainThread]: On master: BEGIN
[0m14:50:15.588024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:15.654134 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m14:50:15.655134 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:15.655134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:15.660136 [debug] [MainThread]: SQL status: SELECT 47 in 0.004 seconds
[0m14:50:15.666134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F60A9250>]}
[0m14:50:15.666134 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:15.667133 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:15.667133 [debug] [MainThread]: On master: BEGIN
[0m14:50:15.668137 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:50:15.668137 [debug] [MainThread]: On master: COMMIT
[0m14:50:15.669142 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:15.669142 [debug] [MainThread]: On master: COMMIT
[0m14:50:15.670157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:15.670157 [debug] [MainThread]: On master: Close
[0m14:50:15.675156 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:50:15.676154 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:50:15.676154 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:50:15.676154 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:50:15.677153 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:50:15.677153 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:50:15.678153 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:50:15.679150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:50:15.679150 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:50:15.680156 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:50:15.681154 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:50:15.681154 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:50:15.682157 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:50:15.682157 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:50:15.682157 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:50:15.688688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.689687 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:50:15.691686 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.693687 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.695681 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.696679 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:50:15.696679 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:50:15.716680 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:50:15.721681 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.734682 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.737681 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.737681 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:50:15.741681 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.741681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.742682 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.742682 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.743681 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:50:15.743681 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:50:15.744681 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:50:15.744681 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.744681 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:15.745680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:15.745680 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:15.746685 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:50:15.747680 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:50:15.847212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.102 seconds
[0m14:50:15.848212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.848212 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:50:15.852215 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:50:15.856218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.857217 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:50:15.857217 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m14:50:15.858216 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.858216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:15.858216 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:50:15.860217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.861214 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:50:15.861214 [debug] [Thread-2 (]: SQL status: BEGIN in 0.116 seconds
[0m14:50:15.862216 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.862216 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:50:15.863216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:15.875229 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:50:15.876235 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:50:15.876235 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m14:50:15.878230 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.878230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.880231 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.881230 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:50:15.881230 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:50:15.881230 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:50:15.882230 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:15.884231 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.884749 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:50:15.884749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:50:15.884749 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:50:15.886766 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.890765 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:50:15.891774 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:50:15.891774 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:15.895766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:50:15.896766 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:50:15.897766 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:15.897766 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:50:15.897766 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.898765 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:50:15.899766 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:50:15.899766 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.900770 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:50:15.901769 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:15.901769 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:15.901769 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:50:15.903766 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:50:15.904766 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:50:15.906773 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:50:15.908766 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:50:15.909766 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:50:15.910765 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:50:15.911761 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:50:15.911761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F1812510>]}
[0m14:50:15.912763 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m14:50:15.913764 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:50:15.913764 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:50:15.914771 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:50:15.914771 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:50:15.914771 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:50:15.915767 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:50:15.917765 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:50:15.917765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:50:15.918766 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F66B3C50>]}
[0m14:50:15.918766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F6619E20>]}
[0m14:50:15.918766 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:50:15.919761 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.24s]
[0m14:50:15.920769 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.24s]
[0m14:50:15.922763 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:15.923767 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:50:15.923767 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:50:15.924765 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:50:15.924765 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:50:15.925766 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:50:15.925766 [info ] [Thread-3 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:50:15.926760 [info ] [Thread-2 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:50:15.928766 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:15.929760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:50:15.929760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:50:15.930765 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:50:15.930765 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:50:15.932765 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:15.932765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:15.934766 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:15.935761 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:50:15.935761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:15.936761 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:50:15.938773 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:15.938773 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:50:15.941763 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:15.941763 [debug] [Thread-4 (]: SQL status: BEGIN in 0.194 seconds
[0m14:50:15.942766 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.942766 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:15.943761 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:50:15.943761 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:50:15.943761 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:15.944765 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:50:15.944765 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:50:15.945766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:15.946763 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:50:15.948760 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.949761 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:50:15.949761 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:15.954762 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.954762 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:50:15.955760 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:15.957765 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:50:15.957765 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.957765 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:50:15.959761 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:50:15.961760 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:50:15.962770 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:50:15.962770 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:50:15.964761 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:50:15.965762 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:50:15.966761 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F6721760>]}
[0m14:50:15.966761 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.28s]
[0m14:50:15.967761 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:50:15.968767 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:50:15.969781 [info ] [Thread-4 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:50:15.970776 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.categories_inventories)
[0m14:50:15.970776 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:50:15.972776 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:50:15.974777 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:50:15.976779 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:50:15.977780 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:50:15.978781 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:50:15.978781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:50:16.021304 [debug] [Thread-3 (]: SQL status: BEGIN in 0.077 seconds
[0m14:50:16.021304 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:16.022304 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:50:16.024304 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:50:16.027304 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:16.027304 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:50:16.028304 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:16.030309 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:16.030309 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:50:16.031306 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:16.032305 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:50:16.032305 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:16.033304 [debug] [Thread-2 (]: SQL status: BEGIN in 0.087 seconds
[0m14:50:16.033304 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:50:16.034304 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:16.038304 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:50:16.038304 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:50:16.040301 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:50:16.040301 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:50:16.041300 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:50:16.041300 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:50:16.043309 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:16.044304 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:50:16.044304 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:50:16.045299 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:50:16.046298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F678A240>]}
[0m14:50:16.046298 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:16.049302 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:16.047305 [info ] [Thread-3 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.12s]
[0m14:50:16.049302 [debug] [Thread-4 (]: SQL status: BEGIN in 0.071 seconds
[0m14:50:16.050304 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:50:16.050304 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:50:16.051305 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:50:16.051305 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.category

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select category,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_categories 
  group by category

select * from final
  );
[0m14:50:16.052305 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:16.053304 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:50:16.053304 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 53: select * from final
         ^

[0m14:50:16.054304 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:16.054304 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:50:16.054304 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:50:16.055304 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:50:16.056309 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:16.057302 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:50:16.058299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:50:16.058299 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:50:16.060310 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:50:16.062303 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:50:16.062303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F67ABB00>]}
[0m14:50:16.063302 [debug] [Thread-4 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:50:16.064312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F67CE9C0>]}
[0m14:50:16.064312 [info ] [Thread-2 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.13s]
[0m14:50:16.066304 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:50:16.065301 [error] [Thread-4 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.09s]
[0m14:50:16.067305 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:50:16.067305 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:50:16.106842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.171 seconds
[0m14:50:16.107842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:16.107842 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:50:16.110839 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:50:16.112842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:16.112842 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:50:16.113842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:16.115842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:16.115842 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:50:16.116842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:16.118839 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:50:16.118839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:16.118839 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:50:16.121130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:16.122235 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:50:16.123243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:50:16.123243 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:50:16.124243 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:50:16.125242 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:50:16.126242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F67E9FA0>]}
[0m14:50:16.126242 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.21s]
[0m14:50:16.127241 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:50:16.128242 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:50:16.128242 [info ] [Thread-3 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:50:16.129242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_rentals, now model.dbt_postgres_prj1.customers)
[0m14:50:16.130242 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:50:16.132246 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:50:16.134241 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:50:16.136245 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:50:16.137244 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:50:16.138241 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:50:16.138241 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:50:16.200834 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m14:50:16.200834 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:50:16.201834 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:50:16.204833 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:50:16.207833 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:50:16.207833 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:50:16.208833 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:16.209833 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:50:16.210833 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:50:16.210833 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:50:16.215361 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:50:16.216368 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:50:16.217367 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:50:16.218368 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:50:16.219366 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:50:16.220368 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:50:16.220368 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd93f9c-9c3d-43cf-a6f8-20c4ff5e6525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F6738980>]}
[0m14:50:16.221367 [info ] [Thread-3 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m14:50:16.222366 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:50:16.223366 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:16.224365 [debug] [MainThread]: On master: BEGIN
[0m14:50:16.225366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:16.287875 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m14:50:16.287875 [debug] [MainThread]: On master: COMMIT
[0m14:50:16.288877 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:16.289876 [debug] [MainThread]: On master: COMMIT
[0m14:50:16.289876 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:16.290879 [debug] [MainThread]: On master: Close
[0m14:50:16.290879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:16.291875 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:50:16.291875 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:50:16.291875 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_payments' was properly closed.
[0m14:50:16.292874 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:50:16.292874 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:50:16.292874 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m14:50:16.293875 [info ] [MainThread]: 
[0m14:50:16.293875 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m14:50:16.295878 [debug] [MainThread]: Command end result
[0m14:50:16.347875 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:50:16.349875 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:50:16.355875 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:50:16.355875 [info ] [MainThread]: 
[0m14:50:16.356874 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:50:16.356874 [info ] [MainThread]: 
[0m14:50:16.357880 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:50:16.358876 [info ] [MainThread]: 
[0m14:50:16.358876 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:50:16.359875 [debug] [MainThread]: Command `dbt run` failed at 14:50:16.359875 after 1.78 seconds
[0m14:50:16.359875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F416A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F33C42C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F607B050>]}
[0m14:50:16.360875 [debug] [MainThread]: Flushing usage events
[0m14:50:16.766532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:03.361740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CCA4AEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D05267E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D0526FF0>]}


============================== 14:51:03.365739 | 472e2d03-e8c6-4c92-ad51-3f82b3732416 ==============================
[0m14:51:03.365739 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:51:03.366740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:03.493648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D0BC0770>]}
[0m14:51:03.530166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D0B7A870>]}
[0m14:51:03.531166 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:03.683169 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:51:03.801698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:03.802698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:03.829213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D21BDBB0>]}
[0m14:51:03.878329 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:51:03.881328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:51:03.901323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D24DBC50>]}
[0m14:51:03.902325 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:51:03.903325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D0D0A5A0>]}
[0m14:51:03.905326 [info ] [MainThread]: 
[0m14:51:03.905326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:03.905326 [info ] [MainThread]: 
[0m14:51:03.906323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:03.909324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:51:04.015344 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:51:04.015344 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:51:04.016350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:04.095346 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m14:51:04.096347 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:51:04.098345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:51:04.103359 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:51:04.104354 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:51:04.104354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:04.165695 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m14:51:04.166700 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:51:04.166700 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:51:04.170698 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m14:51:04.171696 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:51:04.172694 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:51:04.178698 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:04.178698 [debug] [MainThread]: On master: BEGIN
[0m14:51:04.178698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:04.239205 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m14:51:04.240222 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:04.241222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:04.251203 [debug] [MainThread]: SQL status: SELECT 47 in 0.009 seconds
[0m14:51:04.257216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CDD69190>]}
[0m14:51:04.257216 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:04.258217 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:04.258217 [debug] [MainThread]: On master: BEGIN
[0m14:51:04.259204 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:51:04.260218 [debug] [MainThread]: On master: COMMIT
[0m14:51:04.260218 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:04.261205 [debug] [MainThread]: On master: COMMIT
[0m14:51:04.261205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:04.262205 [debug] [MainThread]: On master: Close
[0m14:51:04.266212 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:04.266212 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:04.267205 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:04.267205 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:04.267205 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:51:04.268205 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:51:04.269204 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:51:04.269204 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:51:04.269204 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:51:04.270205 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:51:04.270205 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:51:04.271204 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:04.271204 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:51:04.272207 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:04.272207 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:04.277205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.277205 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:04.279205 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.281206 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.283205 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.287204 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:04.287204 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:04.299205 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:04.314716 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:04.319725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.333722 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.336724 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.338722 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.339723 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.340722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.340722 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:51:04.340722 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.341721 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.341721 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:51:04.341721 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:51:04.342723 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:51:04.342723 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:51:04.342723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:51:04.343722 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:51:04.344723 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:51:04.452251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m14:51:04.453248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.453248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.111 seconds
[0m14:51:04.454249 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:51:04.454249 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.455252 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:51:04.457247 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m14:51:04.457247 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.458248 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:51:04.458248 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m14:51:04.464251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.464251 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:51:04.465249 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:51:04.465249 [debug] [Thread-4 (]: SQL status: BEGIN in 0.121 seconds
[0m14:51:04.465249 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:51:04.468248 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.470247 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.471249 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.471249 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:51:04.472247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:04.472247 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:51:04.472247 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:51:04.474248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.475252 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:51:04.476249 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:51:04.476249 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:04.478249 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.480248 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.480248 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:51:04.481248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:51:04.481248 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:51:04.481248 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:51:04.484249 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.501256 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:51:04.502255 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:51:04.502255 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:04.502255 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:04.503255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.504259 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:51:04.504259 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:04.505254 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:51:04.506256 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:51:04.506256 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.508258 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.508258 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.509257 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:51:04.509257 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:51:04.510256 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:51:04.510256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:51:04.511255 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:04.511255 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:04.511255 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:04.515775 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:51:04.516774 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:51:04.518774 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:51:04.519775 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:51:04.523773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:04.524774 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.526771 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:04.527774 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:04.527774 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:51:04.527774 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:51:04.528772 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:51:04.528772 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:51:04.530773 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:04.530773 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:04.531773 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:51:04.533770 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:51:04.533770 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:51:04.535773 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:51:04.536775 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:51:04.536775 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:04.537774 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:51:04.539773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D24BB500>]}
[0m14:51:04.539773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2A7F740>]}
[0m14:51:04.539773 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:51:04.540773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2B29F40>]}
[0m14:51:04.541773 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.27s]
[0m14:51:04.542773 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.27s]
[0m14:51:04.543771 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:04.543771 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.27s]
[0m14:51:04.544776 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:04.544776 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:04.545772 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:04.545772 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:04.546772 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:51:04.547778 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:04.548772 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:04.547778 [info ] [Thread-3 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:51:04.548772 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2AF8A10>]}
[0m14:51:04.549772 [info ] [Thread-1 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:51:04.550773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:51:04.549772 [info ] [Thread-2 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:51:04.551770 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.28s]
[0m14:51:04.551770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:51:04.551770 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:04.552774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:51:04.553773 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:04.553773 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:04.555773 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.556771 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:04.557773 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:51:04.558774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.560771 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.561773 [info ] [Thread-4 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:51:04.561773 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:04.562773 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.categories_inventories)
[0m14:51:04.562773 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:04.565774 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.565774 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:51:04.566771 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:04.569777 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.571785 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:04.573775 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.574774 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.575773 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:51:04.575773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.575773 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:51:04.576772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:04.576772 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:51:04.576772 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.578775 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:04.579774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:04.579774 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:51:04.580774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:04.581775 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:04.581775 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:51:04.582774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:04.667292 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m14:51:04.667292 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.668294 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:51:04.670290 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:51:04.673293 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.673293 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:51:04.674293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m14:51:04.674293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.675294 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m14:51:04.675294 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:04.675294 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:51:04.676294 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.678293 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.678293 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:51:04.679293 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:51:04.679293 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m14:51:04.680295 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:04.680295 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:04.680295 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:51:04.681292 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.category

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select category,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_categories 
  group by category

select * from final
  );
[0m14:51:04.682293 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:51:04.682293 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:51:04.684293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.685291 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.685291 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 53: select * from final
         ^

[0m14:51:04.687299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.687299 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:51:04.688295 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:51:04.688295 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:51:04.689292 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:51:04.689292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:04.690293 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:51:04.691296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.692296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:51:04.693294 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:51:04.693294 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:51:04.695293 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.697292 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:51:04.697292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:51:04.698291 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:51:04.699291 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:04.700297 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:51:04.700297 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:51:04.701296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:04.701296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.703297 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:51:04.703297 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:04.703297 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:51:04.704297 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.705296 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:51:04.706296 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:51:04.706296 [debug] [Thread-4 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:51:04.707301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:04.707301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2A44C80>]}
[0m14:51:04.708296 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2BB3DD0>]}
[0m14:51:04.711297 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:51:04.711297 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:51:04.712296 [info ] [Thread-3 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:51:04.713297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:04.712296 [error] [Thread-4 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.15s]
[0m14:51:04.714804 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:51:04.714804 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:04.715810 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:51:04.715810 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:51:04.716810 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:04.717811 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:51:04.717811 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:51:04.718811 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:04.719811 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:51:04.720811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2C87B30>]}
[0m14:51:04.720811 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:51:04.721810 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:51:04.720811 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:51:04.722811 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2C61520>]}
[0m14:51:04.722811 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:04.723811 [info ] [Thread-2 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.17s]
[0m14:51:04.724810 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:51:04.724810 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:04.725810 [info ] [Thread-3 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:51:04.726811 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m14:51:04.726811 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:51:04.729810 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:51:04.730809 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:51:04.733809 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:51:04.734810 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:04.734810 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:51:04.735810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:04.798670 [debug] [Thread-3 (]: SQL status: BEGIN in 0.063 seconds
[0m14:51:04.799679 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:04.800676 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:51:04.805678 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:51:04.807677 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:04.807677 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:51:04.808676 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:04.809679 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:51:04.810678 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:04.810678 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:51:04.815446 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:51:04.816457 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:51:04.817451 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:04.817451 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:51:04.818451 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:51:04.819453 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:51:04.819453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472e2d03-e8c6-4c92-ad51-3f82b3732416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2C91E20>]}
[0m14:51:04.820453 [info ] [Thread-3 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m14:51:04.821452 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:51:04.823451 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:04.823451 [debug] [MainThread]: On master: BEGIN
[0m14:51:04.823451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:04.887514 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m14:51:04.887514 [debug] [MainThread]: On master: COMMIT
[0m14:51:04.888525 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:04.888525 [debug] [MainThread]: On master: COMMIT
[0m14:51:04.889545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:04.889545 [debug] [MainThread]: On master: Close
[0m14:51:04.890542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:04.890542 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:51:04.890542 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:51:04.890542 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:51:04.891533 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:51:04.891533 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:51:04.891533 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m14:51:04.892525 [info ] [MainThread]: 
[0m14:51:04.892525 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m14:51:04.894528 [debug] [MainThread]: Command end result
[0m14:51:04.947053 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:51:04.950114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:51:04.956113 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:51:04.956113 [info ] [MainThread]: 
[0m14:51:04.957111 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:51:04.958116 [info ] [MainThread]: 
[0m14:51:04.959114 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:51:04.959114 [info ] [MainThread]: 
[0m14:51:04.960116 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:51:04.961113 [debug] [MainThread]: Command `dbt run` failed at 14:51:04.961113 after 1.73 seconds
[0m14:51:04.961113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CF8E1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D0757E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CE651790>]}
[0m14:51:04.962116 [debug] [MainThread]: Flushing usage events
[0m14:51:05.339774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:46.099729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001343225E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134346D8FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013434A1DEB0>]}


============================== 14:51:46.107252 | bd7c8016-265d-47c9-b4d1-e3a9ecfe1395 ==============================
[0m14:51:46.107252 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:51:46.108246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:51:46.244052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013435249310>]}
[0m14:51:46.284052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013434D832C0>]}
[0m14:51:46.285050 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:46.435875 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:51:46.582443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:46.583441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:46.622445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134358FA630>]}
[0m14:51:46.687404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:51:46.692497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:51:46.721492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013436C3A000>]}
[0m14:51:46.721492 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:51:46.722495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013436A33E00>]}
[0m14:51:46.724503 [info ] [MainThread]: 
[0m14:51:46.724503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:46.725501 [info ] [MainThread]: 
[0m14:51:46.726502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:46.730502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:51:46.854026 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:51:46.855027 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:51:46.855027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:47.052077 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.196 seconds
[0m14:51:47.053078 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:51:47.055076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:51:47.058509 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:51:47.058509 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:51:47.059700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:47.133197 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m14:51:47.134196 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:51:47.134196 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:51:47.140333 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.006 seconds
[0m14:51:47.142329 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:51:47.142329 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:51:47.148420 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:47.148420 [debug] [MainThread]: On master: BEGIN
[0m14:51:47.149420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:47.227752 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m14:51:47.228755 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:47.228755 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:47.239269 [debug] [MainThread]: SQL status: SELECT 47 in 0.010 seconds
[0m14:51:47.245270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013437056CC0>]}
[0m14:51:47.245270 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:47.246270 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:47.246270 [debug] [MainThread]: On master: BEGIN
[0m14:51:47.246270 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:51:47.247268 [debug] [MainThread]: On master: COMMIT
[0m14:51:47.247268 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:47.248270 [debug] [MainThread]: On master: COMMIT
[0m14:51:47.248270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:47.248270 [debug] [MainThread]: On master: Close
[0m14:51:47.253268 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:47.253268 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:47.254269 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:47.254269 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:47.254269 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:51:47.255269 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:51:47.255269 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:51:47.256269 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:51:47.256269 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:51:47.257269 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:51:47.257269 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:51:47.258273 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:51:47.258273 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:47.259273 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:47.259273 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:47.259273 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:47.264272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.266270 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.267270 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.269270 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.271272 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:47.271272 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:47.271272 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:47.296663 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.296663 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:47.309654 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.311656 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.314656 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.315654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.315654 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:51:47.316655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:51:47.316655 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.317901 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.317901 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.318910 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:51:47.318910 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:51:47.318910 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:51:47.319908 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:51:47.319908 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:51:47.320909 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:51:47.415475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.099 seconds
[0m14:51:47.416475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.417476 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:51:47.421475 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m14:51:47.427481 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.428483 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:51:47.429481 [debug] [Thread-2 (]: SQL status: BEGIN in 0.109 seconds
[0m14:51:47.429481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:47.429481 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.432483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.433482 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:51:47.433482 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:51:47.434482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:47.443516 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:51:47.449515 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:51:47.449515 [debug] [Thread-3 (]: SQL status: BEGIN in 0.129 seconds
[0m14:51:47.451515 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.452518 [debug] [Thread-4 (]: SQL status: BEGIN in 0.132 seconds
[0m14:51:47.452518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.452518 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.453519 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:51:47.453519 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.454517 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:51:47.454517 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:51:47.454517 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:51:47.455515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:47.457516 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.457516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:51:47.458517 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:51:47.463517 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:51:47.463517 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:51:47.464514 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:51:47.468515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:51:47.468515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:51:47.471516 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.473517 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.473517 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:51:47.474517 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:51:47.474517 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:51:47.475517 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:51:47.475517 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.476516 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:51:47.476516 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:47.477519 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:47.477519 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:51:47.479517 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.479517 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:51:47.481515 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.483516 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:51:47.483516 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:51:47.485516 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:51:47.485516 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:51:47.489515 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:51:47.489515 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:51:47.490515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001343579B980>]}
[0m14:51:47.490515 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:47.490515 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:51:47.491516 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:51:47.493515 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:51:47.492519 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m14:51:47.494520 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.494520 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.495515 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:51:47.495515 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:47.495515 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:51:47.496517 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:51:47.496517 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:47.497517 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:51:47.498515 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:47.498515 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:47.498515 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:51:47.499515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013437269F10>]}
[0m14:51:47.500520 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:51:47.502519 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:51:47.502519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:51:47.504516 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:51:47.503522 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.24s]
[0m14:51:47.504516 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:51:47.505519 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:47.505519 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:51:47.506520 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:51:47.506520 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:51:47.508521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.509515 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:47.510515 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:47.509515 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:51:47.510515 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:47.511517 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:51:47.512515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:51:47.512515 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:47.513523 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:51:47.513523 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001343717BA70>]}
[0m14:51:47.514516 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:47.516515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.517516 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013435875AF0>]}
[0m14:51:47.519517 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.517516 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.26s]
[0m14:51:47.520516 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.26s]
[0m14:51:47.521521 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:51:47.521521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.522515 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:51:47.522515 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:47.522515 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:47.523516 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:51:47.523516 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:51:47.526525 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.524520 [info ] [Thread-4 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:51:47.526525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:47.527527 [info ] [Thread-3 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:51:47.528521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:51:47.528521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.categories_inventories)
[0m14:51:47.529520 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.529520 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:47.529520 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:51:47.530520 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:51:47.532520 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.534522 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:47.535520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:47.536521 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:47.537521 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:51:47.540540 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.542547 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:47.544546 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:47.544546 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.544546 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:51:47.545546 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:51:47.545546 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:47.546547 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:47.607006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m14:51:47.608010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.609006 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:51:47.612009 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:51:47.614009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.615009 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:51:47.615009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:47.617008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.617008 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:51:47.618007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:47.619006 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:51:47.620007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.620007 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:51:47.621008 [debug] [Thread-2 (]: SQL status: BEGIN in 0.085 seconds
[0m14:51:47.621008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:47.621008 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.623011 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:51:47.623011 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:51:47.624018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:51:47.625018 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:51:47.626029 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:47.627017 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:51:47.628018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134372D7740>]}
[0m14:51:47.629016 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:51:47.629016 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.13s]
[0m14:51:47.632016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.632016 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:51:47.633015 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:51:47.634015 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:47.636018 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.637019 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:51:47.637019 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m14:51:47.637019 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:51:47.637019 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:47.638524 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_categories as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.category

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select category,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_categories 
  group by category

select * from final
  );
[0m14:51:47.639531 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:51:47.640528 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.640528 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 53: select * from final
         ^

[0m14:51:47.640528 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:51:47.641531 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:51:47.642530 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:51:47.642530 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:47.643529 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m14:51:47.644528 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:51:47.645529 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.646529 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:51:47.646529 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:51:47.646529 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:51:47.648529 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:47.649537 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:51:47.650529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134371AA0F0>]}
[0m14:51:47.650529 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:51:47.651529 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m14:51:47.653071 [debug] [Thread-3 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:51:47.655080 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.656085 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:51:47.656085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013437312180>]}
[0m14:51:47.657083 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:51:47.657083 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:51:47.658080 [error] [Thread-3 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.13s]
[0m14:51:47.659080 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:47.658080 [info ] [Thread-1 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:51:47.659080 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:51:47.662082 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.662082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m14:51:47.663081 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:51:47.663081 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:51:47.664083 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:51:47.667081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:51:47.667081 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:51:47.669087 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:51:47.669087 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.670082 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:51:47.670082 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:51:47.672083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:51:47.673083 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:51:47.674082 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:51:47.675081 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:51:47.675081 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:51:47.675081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:47.676082 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:51:47.676082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:47.677079 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:51:47.678079 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:51:47.679082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134371AA1B0>]}
[0m14:51:47.679082 [info ] [Thread-4 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.15s]
[0m14:51:47.680081 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:51:47.740749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m14:51:47.741752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:47.741752 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:51:47.745750 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:51:47.747749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:47.747749 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:51:47.748749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:47.749752 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:51:47.750750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:47.750750 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:51:47.751749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:47.753749 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:51:47.753749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:51:47.754749 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:51:47.754749 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:51:47.755749 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:51:47.756749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c8016-265d-47c9-b4d1-e3a9ecfe1395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013437380B60>]}
[0m14:51:47.756749 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m14:51:47.758750 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:51:47.760115 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:47.760115 [debug] [MainThread]: On master: BEGIN
[0m14:51:47.761124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:47.822124 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m14:51:47.823121 [debug] [MainThread]: On master: COMMIT
[0m14:51:47.823121 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:47.824125 [debug] [MainThread]: On master: COMMIT
[0m14:51:47.824125 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:47.824125 [debug] [MainThread]: On master: Close
[0m14:51:47.825127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:47.825127 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:51:47.826127 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:51:47.826127 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:51:47.826127 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:51:47.827126 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m14:51:47.827126 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:51:47.827126 [info ] [MainThread]: 
[0m14:51:47.828130 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m14:51:47.829126 [debug] [MainThread]: Command end result
[0m14:51:47.887646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:51:47.889644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:51:47.894643 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:51:47.894643 [info ] [MainThread]: 
[0m14:51:47.895645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:51:47.895645 [info ] [MainThread]: 
[0m14:51:47.896644 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:51:47.897643 [info ] [MainThread]: 
[0m14:51:47.898643 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:51:47.899643 [debug] [MainThread]: Command `dbt run` failed at 14:51:47.899643 after 1.96 seconds
[0m14:51:47.900643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013434C1CA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013432502C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001343706D5B0>]}
[0m14:51:47.900643 [debug] [MainThread]: Flushing usage events
[0m14:51:48.285455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:34.942326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204BF8C59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204BCBD2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C0405130>]}


============================== 14:59:34.951327 | 8a49fd49-2452-43ce-9c57-41d7659da3cf ==============================
[0m14:59:34.951327 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:59:34.952325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:59:35.086850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C044D160>]}
[0m14:59:35.132375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204BF9247D0>]}
[0m14:59:35.133375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:59:35.289888 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:59:35.414410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:59:35.415410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:59:35.446926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C1AFCD70>]}
[0m14:59:35.500927 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:59:35.503927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:59:35.527444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C1D21D00>]}
[0m14:59:35.527444 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m14:59:35.528444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C1D53C80>]}
[0m14:59:35.529444 [info ] [MainThread]: 
[0m14:59:35.530450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:59:35.531465 [info ] [MainThread]: 
[0m14:59:35.532473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:59:35.535474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m14:59:35.638990 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m14:59:35.639991 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m14:59:35.640997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:35.714998 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m14:59:35.715996 [debug] [ThreadPool]: On list_dvdrental: Close
[0m14:59:35.717999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m14:59:35.721997 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:59:35.721997 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m14:59:35.722996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:35.784514 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m14:59:35.785515 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m14:59:35.785515 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:59:35.788513 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m14:59:35.789514 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m14:59:35.790515 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m14:59:35.797522 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:35.797522 [debug] [MainThread]: On master: BEGIN
[0m14:59:35.798518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:35.859904 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m14:59:35.860905 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:35.860905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:59:35.872906 [debug] [MainThread]: SQL status: SELECT 47 in 0.010 seconds
[0m14:59:35.877907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C1A94C20>]}
[0m14:59:35.878904 [debug] [MainThread]: On master: ROLLBACK
[0m14:59:35.878904 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:35.878904 [debug] [MainThread]: On master: BEGIN
[0m14:59:35.879905 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:59:35.879905 [debug] [MainThread]: On master: COMMIT
[0m14:59:35.880909 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:35.880909 [debug] [MainThread]: On master: COMMIT
[0m14:59:35.880909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:59:35.881905 [debug] [MainThread]: On master: Close
[0m14:59:35.885905 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:59:35.885905 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:59:35.886908 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:59:35.886908 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:59:35.886908 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:59:35.887907 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m14:59:35.887907 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m14:59:35.888906 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m14:59:35.888906 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m14:59:35.889906 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m14:59:35.889906 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m14:59:35.890906 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:59:35.890906 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m14:59:35.890906 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:59:35.891906 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:59:35.895906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:35.896907 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:59:35.897905 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:35.899906 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:35.901915 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:35.902905 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:59:35.902905 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:59:35.923911 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:59:35.928428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:35.928428 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:59:35.940427 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:35.942427 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:35.945425 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:35.946425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:35.947426 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m14:59:35.947426 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:35.948425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:35.948425 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:35.948425 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:35.948425 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m14:59:35.949426 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m14:59:35.949426 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m14:59:35.950426 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:35.950426 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:59:35.950426 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:59:36.048941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.101 seconds
[0m14:59:36.049942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:36.050943 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:59:36.053943 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:59:36.058941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:36.059944 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:59:36.059944 [debug] [Thread-3 (]: SQL status: BEGIN in 0.109 seconds
[0m14:59:36.060945 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:36.060945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:59:36.061941 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m14:59:36.063942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:36.063942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m14:59:36.063942 [debug] [Thread-4 (]: SQL status: BEGIN in 0.113 seconds
[0m14:59:36.064943 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:59:36.064943 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:36.065942 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:36.065942 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m14:59:36.066945 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m14:59:36.066945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:59:36.081945 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:59:36.081945 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:59:36.081945 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m14:59:36.082944 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m14:59:36.082944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:36.085942 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:36.087947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:36.089944 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:36.089944 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m14:59:36.090946 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m14:59:36.090946 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m14:59:36.091946 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m14:59:36.092944 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:59:36.092944 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:59:36.092944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:59:36.095945 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:36.096948 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:36.097949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:59:36.098949 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:36.099945 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m14:59:36.099945 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m14:59:36.103948 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m14:59:36.103948 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m14:59:36.107945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m14:59:36.107945 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:59:36.108943 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:59:36.108943 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:59:36.108943 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:36.109946 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:59:36.110946 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:59:36.112953 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:59:36.112953 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:36.113955 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:36.113955 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:36.113955 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:59:36.114955 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m14:59:36.114955 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m14:59:36.114955 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m14:59:36.116953 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m14:59:36.118954 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:59:36.118954 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:59:36.119954 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:59:36.121953 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m14:59:36.121953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204BD5226C0>]}
[0m14:59:36.123955 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m14:59:36.124958 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m14:59:36.127477 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m14:59:36.128476 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m14:59:36.127477 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m14:59:36.128476 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m14:59:36.129475 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m14:59:36.129475 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m14:59:36.130476 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m14:59:36.130476 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m14:59:36.131476 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:59:36.132476 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:59:36.131476 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m14:59:36.132476 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:59:36.132476 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:59:36.133475 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m14:59:36.134476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m14:59:36.134476 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m14:59:36.135478 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m14:59:36.136476 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C23D9F70>]}
[0m14:59:36.136476 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:59:36.137475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C23D9DF0>]}
[0m14:59:36.137475 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C23DBFE0>]}
[0m14:59:36.140475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.138475 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:59:36.141475 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.25s]
[0m14:59:36.142475 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.25s]
[0m14:59:36.143477 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m14:59:36.143477 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m14:59:36.144476 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m14:59:36.144476 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:59:36.144476 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:59:36.145476 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:59:36.146476 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m14:59:36.148477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.148477 [info ] [Thread-3 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m14:59:36.149475 [info ] [Thread-2 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:59:36.149475 [info ] [Thread-4 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m14:59:36.150478 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m14:59:36.151476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m14:59:36.151476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.categories_inventories)
[0m14:59:36.151476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.152476 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:59:36.152476 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:59:36.152476 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m14:59:36.153477 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m14:59:36.154478 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.156484 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.159476 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:59:36.159476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:36.160477 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:59:36.161478 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:59:36.161478 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m14:59:36.163478 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.165476 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.168476 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m14:59:36.169476 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.169476 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.170475 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:59:36.170475 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m14:59:36.170475 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m14:59:36.171476 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m14:59:36.171476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:59:36.172479 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:59:36.172479 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:59:36.238996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m14:59:36.239998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.239998 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m14:59:36.242993 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:59:36.244997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.245996 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m14:59:36.245996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:36.247998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.248998 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m14:59:36.248998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:36.250996 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:59:36.250996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.250996 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m14:59:36.255999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:59:36.257996 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m14:59:36.257996 [debug] [Thread-3 (]: SQL status: BEGIN in 0.086 seconds
[0m14:59:36.258993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m14:59:36.258993 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.258993 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m14:59:36.259993 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m14:59:36.261996 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:59:36.262995 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m14:59:36.262995 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:59:36.263996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C25712E0>]}
[0m14:59:36.266007 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.266997 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m14:59:36.266007 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.13s]
[0m14:59:36.266997 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m14:59:36.267997 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m14:59:36.267997 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:59:36.267997 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.270002 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.270992 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:59:36.270992 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m14:59:36.271996 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:36.272997 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:59:36.273997 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.273997 [debug] [Thread-4 (]: SQL status: BEGIN in 0.101 seconds
[0m14:59:36.273997 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:59:36.273997 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m14:59:36.274995 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m14:59:36.276998 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.276998 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_ratings as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.rating

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select rating,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_ratings 
  group by rating

select * from final
  );
[0m14:59:36.277997 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:59:36.277997 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 53: select * from final
         ^

[0m14:59:36.278996 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:36.278996 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m14:59:36.278996 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:59:36.280994 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.281995 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m14:59:36.283997 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m14:59:36.283997 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:59:36.284997 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m14:59:36.285996 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m14:59:36.286997 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:59:36.287995 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:59:36.288994 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:59:36.288994 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.289996 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m14:59:36.290994 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m14:59:36.290994 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C250DC70>]}
[0m14:59:36.291996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:59:36.291996 [info ] [Thread-3 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.14s]
[0m14:59:36.293997 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m14:59:36.294998 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m14:59:36.294998 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m14:59:36.295993 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m14:59:36.296997 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:59:36.297997 [debug] [Thread-4 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:59:36.296997 [info ] [Thread-1 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m14:59:36.298996 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C1E3B080>]}
[0m14:59:36.298996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m14:59:36.299998 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m14:59:36.299998 [error] [Thread-4 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.15s]
[0m14:59:36.302001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m14:59:36.302999 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:59:36.302999 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m14:59:36.305002 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m14:59:36.305002 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m14:59:36.305002 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m14:59:36.305997 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C25811F0>]}
[0m14:59:36.308997 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m14:59:36.308997 [info ] [Thread-2 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.15s]
[0m14:59:36.309996 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m14:59:36.310995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:59:36.310995 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m14:59:36.310995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:36.373522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m14:59:36.374526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:59:36.375519 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m14:59:36.379529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:59:36.381525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:59:36.382524 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m14:59:36.383531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:36.384528 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:59:36.384528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:59:36.384528 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m14:59:36.389080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:59:36.390092 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m14:59:36.391088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m14:59:36.391088 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m14:59:36.392088 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:59:36.392088 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m14:59:36.393088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49fd49-2452-43ce-9c57-41d7659da3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C2558980>]}
[0m14:59:36.394090 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m14:59:36.395093 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m14:59:36.397093 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:36.398089 [debug] [MainThread]: On master: BEGIN
[0m14:59:36.399092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:36.461009 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m14:59:36.461009 [debug] [MainThread]: On master: COMMIT
[0m14:59:36.462007 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:36.462007 [debug] [MainThread]: On master: COMMIT
[0m14:59:36.463009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:59:36.463009 [debug] [MainThread]: On master: Close
[0m14:59:36.464014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:36.464014 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m14:59:36.464014 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m14:59:36.465008 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m14:59:36.465008 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m14:59:36.466007 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m14:59:36.466007 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m14:59:36.466007 [info ] [MainThread]: 
[0m14:59:36.467359 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m14:59:36.469368 [debug] [MainThread]: Command end result
[0m14:59:36.523373 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m14:59:36.525373 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m14:59:36.531672 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m14:59:36.532668 [info ] [MainThread]: 
[0m14:59:36.533667 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:59:36.534667 [info ] [MainThread]: 
[0m14:59:36.535670 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  syntax error at or near "select"
  LINE 53: select * from final
           ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m14:59:36.535670 [info ] [MainThread]: 
[0m14:59:36.536668 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:59:36.537929 [debug] [MainThread]: Command `dbt run` failed at 14:59:36.537929 after 1.76 seconds
[0m14:59:36.537929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C0108440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C0176690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C014AFF0>]}
[0m14:59:36.537929 [debug] [MainThread]: Flushing usage events
[0m14:59:36.950273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:12.375525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001826FB7AEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182736B62A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182736B7F20>]}


============================== 15:00:12.383527 | 4d7e2c63-753d-4978-85c6-dd14d2616414 ==============================
[0m15:00:12.383527 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:12.384526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:00:12.518045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018273BCB6B0>]}
[0m15:00:12.560563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018273099AC0>]}
[0m15:00:12.563572 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:12.724906 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:00:12.859949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:12.860950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:12.886952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182751EDC70>]}
[0m15:00:12.941953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:00:12.946952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:00:12.968492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182751EE7B0>]}
[0m15:00:12.969494 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m15:00:12.970493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827541DCA0>]}
[0m15:00:12.971497 [info ] [MainThread]: 
[0m15:00:12.972497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:12.972497 [info ] [MainThread]: 
[0m15:00:12.973493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:12.978497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m15:00:13.080009 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m15:00:13.081009 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m15:00:13.081009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:13.155947 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m15:00:13.156948 [debug] [ThreadPool]: On list_dvdrental: Close
[0m15:00:13.158945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m15:00:13.162947 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:00:13.163959 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m15:00:13.163959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:13.226947 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m15:00:13.226947 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:00:13.227950 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:00:13.231946 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m15:00:13.232949 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m15:00:13.232949 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m15:00:13.240959 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:13.240959 [debug] [MainThread]: On master: BEGIN
[0m15:00:13.241958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:13.302470 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m15:00:13.303471 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:13.303471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:13.308470 [debug] [MainThread]: SQL status: SELECT 47 in 0.004 seconds
[0m15:00:13.314471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182751D7050>]}
[0m15:00:13.315468 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:13.315468 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:13.316469 [debug] [MainThread]: On master: BEGIN
[0m15:00:13.317472 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:00:13.318469 [debug] [MainThread]: On master: COMMIT
[0m15:00:13.319472 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:13.319472 [debug] [MainThread]: On master: COMMIT
[0m15:00:13.319472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:00:13.320468 [debug] [MainThread]: On master: Close
[0m15:00:13.324470 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:00:13.325470 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:00:13.325470 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:00:13.325470 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:00:13.326470 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:00:13.327470 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m15:00:13.327470 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m15:00:13.327470 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m15:00:13.328472 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m15:00:13.329469 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m15:00:13.329469 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m15:00:13.330469 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m15:00:13.330469 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:00:13.330469 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:00:13.331470 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:00:13.331470 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:00:13.336477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.338478 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.340476 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.342481 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.343476 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:00:13.343476 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:00:13.344477 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:00:13.368997 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:00:13.374994 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.388994 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.391996 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.393994 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.395994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.395994 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.395994 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m15:00:13.396995 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.396995 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.396995 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m15:00:13.397994 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:13.397994 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m15:00:13.398994 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m15:00:13.398994 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:00:13.399994 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:00:13.399994 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:13.490515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m15:00:13.490515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.491514 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:00:13.495516 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m15:00:13.496515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.097 seconds
[0m15:00:13.501514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.501514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.502515 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:00:13.502515 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m15:00:13.503514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:00:13.507514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.507514 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:00:13.508515 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:00:13.510514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.511514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:00:13.511514 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m15:00:13.511514 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m15:00:13.528519 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:00:13.528519 [debug] [Thread-4 (]: SQL status: BEGIN in 0.129 seconds
[0m15:00:13.529514 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.529514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.530515 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.530515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:00:13.530515 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m15:00:13.531515 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:00:13.531515 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m15:00:13.533514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.534514 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m15:00:13.535517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:00:13.535517 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:00:13.541522 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m15:00:13.542523 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:00:13.542523 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m15:00:13.544523 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:00:13.550522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:00:13.552039 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.555040 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.555040 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.555040 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:00:13.556038 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m15:00:13.556038 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m15:00:13.556038 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:00:13.558038 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:00:13.558038 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:00:13.560040 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.560040 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:00:13.560040 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:00:13.562040 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.562040 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m15:00:13.564040 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m15:00:13.565039 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m15:00:13.566039 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m15:00:13.568040 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:00:13.569040 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:00:13.570042 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m15:00:13.571039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018275BCD910>]}
[0m15:00:13.571039 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:00:13.572039 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m15:00:13.574039 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m15:00:13.573038 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.24s]
[0m15:00:13.575039 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:00:13.575039 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.575039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.576039 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:00:13.577040 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m15:00:13.577040 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m15:00:13.578038 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m15:00:13.578038 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:00:13.579041 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018275A99DC0>]}
[0m15:00:13.580039 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:00:13.580039 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:00:13.580039 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m15:00:13.581039 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.25s]
[0m15:00:13.583039 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m15:00:13.584040 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m15:00:13.585039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m15:00:13.585039 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:00:13.586040 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:00:13.587039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:00:13.587039 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:00:13.588047 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:00:13.588047 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m15:00:13.589039 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m15:00:13.591042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.591042 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m15:00:13.592039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m15:00:13.593039 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:00:13.594039 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.595045 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:00:13.595045 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:00:13.595045 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:00:13.598041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.599039 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m15:00:13.599039 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:00:13.600040 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m15:00:13.603039 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.603039 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018275B30AA0>]}
[0m15:00:13.604039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182751CADB0>]}
[0m15:00:13.604039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.605040 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.27s]
[0m15:00:13.606040 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m15:00:13.606040 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.27s]
[0m15:00:13.607041 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.607041 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:00:13.608040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:13.608040 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:00:13.609040 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m15:00:13.609040 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:00:13.610041 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.categories_inventories
[0m15:00:13.610041 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:13.611040 [info ] [Thread-4 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:00:13.611040 [info ] [Thread-3 (]: 8 of 9 START sql view model public.categories_inventories ...................... [RUN]
[0m15:00:13.612040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m15:00:13.612040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.categories_inventories)
[0m15:00:13.613040 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:00:13.613040 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.categories_inventories
[0m15:00:13.617040 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.620042 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.categories_inventories"
[0m15:00:13.621040 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:00:13.623039 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.624040 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.categories_inventories
[0m15:00:13.627041 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.categories_inventories"
[0m15:00:13.628040 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.628040 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m15:00:13.629040 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m15:00:13.629040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:13.630042 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: BEGIN
[0m15:00:13.630042 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:13.690554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m15:00:13.691554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.691554 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m15:00:13.693556 [debug] [Thread-2 (]: SQL status: BEGIN in 0.083 seconds
[0m15:00:13.693556 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.693556 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m15:00:13.694561 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:00:13.696556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.697559 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:00:13.697559 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m15:00:13.699558 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.700558 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m15:00:13.700558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:00:13.702562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.702562 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:00:13.703556 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m15:00:13.705558 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.705558 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m15:00:13.706557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:00:13.706557 [debug] [Thread-3 (]: SQL status: BEGIN in 0.076 seconds
[0m15:00:13.707557 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:00:13.708346 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:00:13.708346 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.categories_inventories"
[0m15:00:13.708346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.709355 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m15:00:13.710357 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.categories_inventories"} */

  create view "dvdrental"."public"."categories_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_ratings as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.rating

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select rating,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_ratings 
  group by rating
)

select * from final
  );
[0m15:00:13.710357 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:00:13.711355 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.711355 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m15:00:13.712355 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
LINE 34:       inventories_filmid.film_id.
               ^

[0m15:00:13.712355 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: ROLLBACK
[0m15:00:13.713355 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.categories_inventories: Close
[0m15:00:13.713355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:00:13.714355 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:00:13.715355 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m15:00:13.717355 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m15:00:13.718356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:00:13.718356 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:00:13.719356 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m15:00:13.719356 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m15:00:13.721355 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:00:13.721355 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:00:13.722355 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m15:00:13.723356 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m15:00:13.724354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018275BB3620>]}
[0m15:00:13.725355 [debug] [Thread-3 (]: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m15:00:13.725355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018275A94B30>]}
[0m15:00:13.726354 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018275C0B170>]}
[0m15:00:13.726354 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:00:13.727356 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:00:13.728355 [error] [Thread-3 (]: 8 of 9 ERROR creating sql view model public.categories_inventories ............. [[31mERROR[0m in 0.11s]
[0m15:00:13.728355 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:00:13.729355 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:00:13.729355 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.categories_inventories
[0m15:00:13.730355 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m15:00:13.731355 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.categories_inventories' to be skipped because of status 'error'.  Reason: Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql.
[0m15:00:13.731355 [info ] [Thread-1 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m15:00:13.732356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m15:00:13.733355 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m15:00:13.735360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m15:00:13.736367 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m15:00:13.740370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m15:00:13.741366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:00:13.741366 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m15:00:13.741366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:13.813305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m15:00:13.813305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:00:13.814305 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m15:00:13.815305 [debug] [Thread-4 (]: SQL status: BEGIN in 0.186 seconds
[0m15:00:13.816305 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.817305 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:00:13.817305 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:00:13.820305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:00:13.820305 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m15:00:13.820305 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:00:13.822305 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.823305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:00:13.823305 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:00:13.824305 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m15:00:13.825305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:00:13.825305 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:00:13.825305 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m15:00:13.827302 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.827302 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:00:13.828305 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:00:13.830305 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:00:13.830305 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.830305 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:00:13.831716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:00:13.831716 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:00:13.833723 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m15:00:13.834721 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m15:00:13.835721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:00:13.835721 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:00:13.836726 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m15:00:13.836726 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:00:13.837725 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:00:13.838726 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m15:00:13.838726 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:00:13.839727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018273BF2360>]}
[0m15:00:13.840727 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m15:00:13.840727 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m15:00:13.841726 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7e2c63-753d-4978-85c6-dd14d2616414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018275C55040>]}
[0m15:00:13.842726 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m15:00:13.842726 [info ] [Thread-4 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.23s]
[0m15:00:13.843725 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:00:13.845726 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:13.845726 [debug] [MainThread]: On master: BEGIN
[0m15:00:13.845726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:13.908126 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m15:00:13.909128 [debug] [MainThread]: On master: COMMIT
[0m15:00:13.909128 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:13.910125 [debug] [MainThread]: On master: COMMIT
[0m15:00:13.910125 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:00:13.911126 [debug] [MainThread]: On master: Close
[0m15:00:13.911126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:13.912127 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m15:00:13.912127 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m15:00:13.912127 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m15:00:13.913126 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m15:00:13.914127 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.categories_inventories' was properly closed.
[0m15:00:13.914127 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m15:00:13.915127 [info ] [MainThread]: 
[0m15:00:13.916137 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m15:00:13.918133 [debug] [MainThread]: Command end result
[0m15:00:13.974646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:00:13.976645 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:00:13.981651 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m15:00:13.982646 [info ] [MainThread]: 
[0m15:00:13.983645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:00:13.983645 [info ] [MainThread]: 
[0m15:00:13.984646 [error] [MainThread]:   Database Error in model categories_inventories (models\intermediate\categories_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\categories_inventories.sql
[0m15:00:13.984646 [info ] [MainThread]: 
[0m15:00:13.985646 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:00:13.986716 [debug] [MainThread]: Command `dbt run` failed at 15:00:13.986716 after 1.76 seconds
[0m15:00:13.987732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018273AA8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182716A9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182716A9340>]}
[0m15:00:13.987732 [debug] [MainThread]: Flushing usage events
[0m15:00:14.381223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:44.297103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2A46EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A29C8B140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A29C8A450>]}


============================== 15:01:44.300116 | 31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28 ==============================
[0m15:01:44.300116 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:01:44.301124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:44.433188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2A7E2450>]}
[0m15:01:44.472192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2A0D9A00>]}
[0m15:01:44.474200 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:44.626618 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:01:44.743337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:44.743337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:44.769336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2A352DB0>]}
[0m15:01:44.819882 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:01:44.823881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:01:44.844882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C18B770>]}
[0m15:01:44.844882 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m15:01:44.845878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2A9BA810>]}
[0m15:01:44.846882 [info ] [MainThread]: 
[0m15:01:44.847964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:01:44.847964 [info ] [MainThread]: 
[0m15:01:44.848971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:44.851971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m15:01:44.953987 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m15:01:44.953987 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m15:01:44.954987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:45.023750 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m15:01:45.024805 [debug] [ThreadPool]: On list_dvdrental: Close
[0m15:01:45.026812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m15:01:45.030815 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:01:45.031817 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m15:01:45.031817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:45.092201 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m15:01:45.093201 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:01:45.093201 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:01:45.096202 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m15:01:45.098204 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m15:01:45.098204 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m15:01:45.106432 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:45.107431 [debug] [MainThread]: On master: BEGIN
[0m15:01:45.107431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:45.169602 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m15:01:45.170616 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:45.170616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:01:45.174622 [debug] [MainThread]: SQL status: SELECT 47 in 0.004 seconds
[0m15:01:45.181614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C1AE840>]}
[0m15:01:45.181614 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:45.182626 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:45.182626 [debug] [MainThread]: On master: BEGIN
[0m15:01:45.183614 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:01:45.183614 [debug] [MainThread]: On master: COMMIT
[0m15:01:45.183614 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:45.184613 [debug] [MainThread]: On master: COMMIT
[0m15:01:45.184613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:45.184613 [debug] [MainThread]: On master: Close
[0m15:01:45.189613 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:01:45.189613 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:01:45.190614 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:01:45.190614 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:01:45.190614 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:01:45.191615 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m15:01:45.192612 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m15:01:45.192612 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m15:01:45.193611 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m15:01:45.193611 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m15:01:45.194613 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m15:01:45.194613 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m15:01:45.194613 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:01:45.195612 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:01:45.195612 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:01:45.196612 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:01:45.202621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.204623 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.205626 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.207621 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.208623 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:01:45.209626 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:01:45.209626 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:01:45.240137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.241138 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:01:45.256138 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.258138 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.261141 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.262140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.263139 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.263139 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.263139 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m15:01:45.264139 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m15:01:45.264139 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.265141 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m15:01:45.265141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:45.265141 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:45.266139 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m15:01:45.266139 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:01:45.267139 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:01:45.352389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m15:01:45.353391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.354388 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:01:45.357390 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m15:01:45.362390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.363391 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:01:45.363391 [debug] [Thread-3 (]: SQL status: BEGIN in 0.098 seconds
[0m15:01:45.364389 [debug] [Thread-2 (]: SQL status: BEGIN in 0.098 seconds
[0m15:01:45.364389 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.365389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:45.365389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.365389 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m15:01:45.368390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.368390 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m15:01:45.368390 [debug] [Thread-4 (]: SQL status: BEGIN in 0.102 seconds
[0m15:01:45.369391 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:01:45.370391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.370391 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m15:01:45.371388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.386554 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:01:45.386554 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m15:01:45.387557 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m15:01:45.387557 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m15:01:45.388559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.390557 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.392555 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.394554 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.395553 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:01:45.395553 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m15:01:45.396554 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m15:01:45.396554 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m15:01:45.397554 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:45.398553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.398553 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.398553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:01:45.401562 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.403662 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.405669 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.412717 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m15:01:45.412717 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m15:01:45.413718 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m15:01:45.413718 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m15:01:45.418228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:01:45.419228 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.420229 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.420229 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:45.420229 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:01:45.422231 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m15:01:45.423227 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m15:01:45.424227 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:01:45.425228 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.425228 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.426229 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.426229 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m15:01:45.426229 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m15:01:45.427233 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:01:45.427233 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:01:45.429229 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m15:01:45.430228 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:01:45.430228 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:01:45.432228 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:01:45.434228 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m15:01:45.435229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2AE54C20>]}
[0m15:01:45.436228 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m15:01:45.438228 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m15:01:45.440233 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:01:45.442229 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:01:45.441228 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.24s]
[0m15:01:45.442229 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:01:45.443230 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m15:01:45.443230 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m15:01:45.444231 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:01:45.444231 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m15:01:45.445228 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:01:45.446228 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m15:01:45.447229 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:01:45.447229 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:01:45.447229 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:01:45.448229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m15:01:45.449229 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m15:01:45.450228 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m15:01:45.451228 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m15:01:45.452228 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:01:45.452228 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C7B2DE0>]}
[0m15:01:45.453231 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C7B2F60>]}
[0m15:01:45.454228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C7AB980>]}
[0m15:01:45.456230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.457229 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.26s]
[0m15:01:45.458229 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.26s]
[0m15:01:45.459235 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.26s]
[0m15:01:45.460230 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:01:45.460230 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:01:45.461228 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:01:45.461228 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:01:45.462228 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:01:45.462228 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:01:45.464229 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.ratings_inventories
[0m15:01:45.467771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.467771 [info ] [Thread-4 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m15:01:45.468767 [info ] [Thread-3 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:01:45.468767 [info ] [Thread-2 (]: 8 of 9 START sql view model public.ratings_inventories ......................... [RUN]
[0m15:01:45.469768 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m15:01:45.470768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m15:01:45.471768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.ratings_inventories)
[0m15:01:45.471768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.472767 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:01:45.472767 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:01:45.472767 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.ratings_inventories
[0m15:01:45.473767 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m15:01:45.475769 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.477768 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.480768 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.ratings_inventories"
[0m15:01:45.480768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:45.482768 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:01:45.482768 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:01:45.485768 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.487767 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.488768 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.ratings_inventories
[0m15:01:45.491768 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.ratings_inventories"
[0m15:01:45.491768 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.492767 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.492767 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m15:01:45.493768 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m15:01:45.493768 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.ratings_inventories"
[0m15:01:45.494768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:45.494768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:45.495768 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.ratings_inventories: BEGIN
[0m15:01:45.496768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:45.574705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m15:01:45.575705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.576705 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m15:01:45.579705 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:01:45.582705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.583705 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m15:01:45.584705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:45.587705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.587705 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m15:01:45.588707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:45.589708 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:01:45.590707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.590707 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:01:45.595706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:01:45.595706 [debug] [Thread-3 (]: SQL status: BEGIN in 0.101 seconds
[0m15:01:45.597707 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m15:01:45.598706 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.599707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:01:45.600713 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:01:45.600713 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m15:01:45.602713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:01:45.604711 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m15:01:45.604711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C86D5E0>]}
[0m15:01:45.605713 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:01:45.609714 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.610713 [debug] [Thread-4 (]: SQL status: BEGIN in 0.116 seconds
[0m15:01:45.605713 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.16s]
[0m15:01:45.610713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m15:01:45.611712 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:01:45.611712 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.612714 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:01:45.612714 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.ratings_inventories"
[0m15:01:45.613711 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m15:01:45.613711 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:45.613711 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.ratings_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.ratings_inventories"} */

  create view "dvdrental"."public"."ratings_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_ratings as (

   select 
      inventories_filmid.film_id.
      inventories_filmid.filmid_count,
      films.rating

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select rating,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_ratings 
  group by rating
)

select * from final
  );
[0m15:01:45.617223 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.617223 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:01:45.618222 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:01:45.621224 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.621224 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
LINE 34:       inventories_filmid.film_id.
               ^

[0m15:01:45.622219 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m15:01:45.622219 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.ratings_inventories: ROLLBACK
[0m15:01:45.623220 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.623220 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.ratings_inventories: Close
[0m15:01:45.625220 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:01:45.625220 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:01:45.626220 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.628221 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.629220 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:01:45.629220 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m15:01:45.631221 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.632219 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:01:45.633220 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m15:01:45.636221 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m15:01:45.637222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.637222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:01:45.638228 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m15:01:45.638228 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:01:45.640221 [debug] [Thread-2 (]: Database Error in model ratings_inventories (models\intermediate\ratings_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\ratings_inventories.sql
[0m15:01:45.640221 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:01:45.640221 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:01:45.641237 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C908DD0>]}
[0m15:01:45.642239 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m15:01:45.643237 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m15:01:45.644237 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:01:45.644237 [error] [Thread-2 (]: 8 of 9 ERROR creating sql view model public.ratings_inventories ................ [[31mERROR[0m in 0.17s]
[0m15:01:45.645235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C866FF0>]}
[0m15:01:45.645235 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m15:01:45.646237 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.ratings_inventories
[0m15:01:45.647236 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.17s]
[0m15:01:45.647236 [debug] [Thread-7 (]: Marking all children of 'model.dbt_postgres_prj1.ratings_inventories' to be skipped because of status 'error'.  Reason: Database Error in model ratings_inventories (models\intermediate\ratings_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\ratings_inventories.sql.
[0m15:01:45.648241 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:01:45.648241 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:01:45.650235 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m15:01:45.651237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C864740>]}
[0m15:01:45.651237 [info ] [Thread-4 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.18s]
[0m15:01:45.652237 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:01:45.653236 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.customers
[0m15:01:45.653236 [info ] [Thread-1 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m15:01:45.654237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m15:01:45.654237 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m15:01:45.657240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m15:01:45.658239 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.customers
[0m15:01:45.661238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m15:01:45.662237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:01:45.662237 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m15:01:45.662237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:45.726424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m15:01:45.727424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:01:45.727424 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m15:01:45.732425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:01:45.734428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:01:45.734428 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m15:01:45.735425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:45.736427 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m15:01:45.737422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:01:45.737422 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m15:01:45.739312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:01:45.740323 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m15:01:45.741323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:01:45.741323 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m15:01:45.742323 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:01:45.743322 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.customers: Close
[0m15:01:45.744322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31bfcaa8-6eae-4c6c-98a3-b22eaf9dab28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C8659D0>]}
[0m15:01:45.744322 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m15:01:45.745320 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.customers
[0m15:01:45.747321 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:45.747321 [debug] [MainThread]: On master: BEGIN
[0m15:01:45.748321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:45.923901 [debug] [MainThread]: SQL status: BEGIN in 0.176 seconds
[0m15:01:45.924911 [debug] [MainThread]: On master: COMMIT
[0m15:01:45.924911 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:45.924911 [debug] [MainThread]: On master: COMMIT
[0m15:01:45.925908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:45.925908 [debug] [MainThread]: On master: Close
[0m15:01:45.926909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:45.926909 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m15:01:45.927907 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m15:01:45.927907 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m15:01:45.927907 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.ratings_inventories' was properly closed.
[0m15:01:45.927907 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m15:01:45.928908 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m15:01:45.928908 [info ] [MainThread]: 
[0m15:01:45.929906 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m15:01:45.931913 [debug] [MainThread]: Command end result
[0m15:01:45.992549 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:01:45.994549 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:01:45.999548 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m15:01:45.999548 [info ] [MainThread]: 
[0m15:01:46.001553 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:01:46.002554 [info ] [MainThread]: 
[0m15:01:46.003554 [error] [MainThread]:   Database Error in model ratings_inventories (models\intermediate\ratings_inventories.sql)
  cross-database references are not implemented: inventories_filmid.film_id.inventories_filmid.filmid_count
  LINE 34:       inventories_filmid.film_id.
                 ^
  compiled code at target\run\dbt_postgres_prj1\models\intermediate\ratings_inventories.sql
[0m15:01:46.004553 [info ] [MainThread]: 
[0m15:01:46.005554 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:01:46.006555 [debug] [MainThread]: Command `dbt run` failed at 15:01:46.006555 after 1.85 seconds
[0m15:01:46.007554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2A249970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2C137680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2A0F4BC0>]}
[0m15:01:46.007554 [debug] [MainThread]: Flushing usage events
[0m15:01:46.404168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:47.752952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2488EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2488E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2488FE00>]}


============================== 15:22:47.756952 | 40fba00a-9319-4202-b29a-05506ae9ecde ==============================
[0m15:22:47.756952 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:22:47.757952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\peichunl\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Program Files\\Python312\\dbt-core-demo\\dbt_postgres_prj1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:47.905766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A252412B0>]}
[0m15:22:47.946471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A244EDE20>]}
[0m15:22:47.947464 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:22:48.094645 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:22:48.214806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:48.214806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:48.241321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A24D60440>]}
[0m15:22:48.295315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:22:48.299318 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:22:48.322498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A266DBBC0>]}
[0m15:22:48.323501 [info ] [MainThread]: Found 9 models, 4 data tests, 15 sources, 433 macros
[0m15:22:48.324498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A25390D70>]}
[0m15:22:48.326499 [info ] [MainThread]: 
[0m15:22:48.326499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:48.327499 [info ] [MainThread]: 
[0m15:22:48.328499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:48.331497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m15:22:48.452343 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m15:22:48.452343 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m15:22:48.453341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.528842 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.076 seconds
[0m15:22:48.529841 [debug] [ThreadPool]: On list_dvdrental: Close
[0m15:22:48.531841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental_public'
[0m15:22:48.535841 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:22:48.536840 [debug] [ThreadPool]: On list_dvdrental_public: BEGIN
[0m15:22:48.536840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.597840 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m15:22:48.598845 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_public"
[0m15:22:48.598845 [debug] [ThreadPool]: On list_dvdrental_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "list_dvdrental_public"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:22:48.602844 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m15:22:48.603844 [debug] [ThreadPool]: On list_dvdrental_public: ROLLBACK
[0m15:22:48.603844 [debug] [ThreadPool]: On list_dvdrental_public: Close
[0m15:22:48.610854 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.611851 [debug] [MainThread]: On master: BEGIN
[0m15:22:48.611851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:48.672771 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:22:48.673771 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.674777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:48.678770 [debug] [MainThread]: SQL status: SELECT 47 in 0.004 seconds
[0m15:22:48.684770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A253AD8E0>]}
[0m15:22:48.684770 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:48.685774 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.685774 [debug] [MainThread]: On master: BEGIN
[0m15:22:48.687035 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:22:48.688049 [debug] [MainThread]: On master: COMMIT
[0m15:22:48.688049 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.688049 [debug] [MainThread]: On master: COMMIT
[0m15:22:48.689057 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:48.689057 [debug] [MainThread]: On master: Close
[0m15:22:48.693952 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:22:48.694964 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:22:48.694964 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:22:48.694964 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:22:48.695972 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:22:48.695972 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_dvdrental_customers ..................... [RUN]
[0m15:22:48.696964 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_dvdrental_films ......................... [RUN]
[0m15:22:48.696964 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_dvdrental_inventories ................... [RUN]
[0m15:22:48.697803 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.my_first_dbt_model'
[0m15:22:48.698827 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_customers'
[0m15:22:48.698827 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_films'
[0m15:22:48.699835 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_postgres_prj1.stg_dvdrental_inventories'
[0m15:22:48.699835 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:22:48.699835 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:22:48.700813 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:22:48.700813 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:22:48.704813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.706816 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.708825 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.710825 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.712822 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:22:48.712822 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:22:48.720823 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:22:48.749474 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.749474 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:22:48.753684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.756683 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.758689 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.759688 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.760703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.760703 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: BEGIN
[0m15:22:48.760703 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.761684 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: BEGIN
[0m15:22:48.761684 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:22:48.761684 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.762683 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: BEGIN
[0m15:22:48.762683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:48.762683 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: BEGIN
[0m15:22:48.763682 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:22:48.763682 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:22:48.848681 [debug] [Thread-2 (]: SQL status: BEGIN in 0.086 seconds
[0m15:22:48.849668 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.850668 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */

  create view "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp"
    
    
  as (
    with source_customer as (

    select * from "dvdrental"."public"."customer"

),

final as (
	select * from source_customer
)

select * from final
  );
[0m15:22:48.853669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m15:22:48.853669 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:22:48.853669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.858672 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.859669 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:22:48.859669 [debug] [Thread-3 (]: SQL status: BEGIN in 0.095 seconds
[0m15:22:48.859669 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m15:22:48.859669 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers" rename to "stg_dvdrental_customers__dbt_backup"
[0m15:22:48.860675 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.861672 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.861672 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */

  create view "dvdrental"."public"."stg_dvdrental_films__dbt_tmp"
    
    
  as (
    with source_film as (

    select * from "dvdrental"."public"."film"

),

final as (
	select * from source_film
)

select * from final
  );
[0m15:22:48.861672 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:48.862728 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */

  create view "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp"
    
    
  as (
    with source_inventory as (

    select * from "dvdrental"."public"."inventory"

),

final as (
	select * from source_inventory
)

select * from final
  );
[0m15:22:48.864738 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.864738 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m15:22:48.865737 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:22:48.867288 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
alter table "dvdrental"."public"."stg_dvdrental_customers__dbt_tmp" rename to "stg_dvdrental_customers"
[0m15:22:48.869294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.869294 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:22:48.871294 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.872292 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:22:48.872292 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:48.874298 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.874298 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films" rename to "stg_dvdrental_films__dbt_backup"
[0m15:22:48.885292 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:22:48.885292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:22:48.886292 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories" rename to "stg_dvdrental_inventories__dbt_backup"
[0m15:22:48.886292 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.886292 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:48.889291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.889291 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: COMMIT
[0m15:22:48.890292 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:48.891293 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.892293 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
alter table "dvdrental"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:22:48.894292 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.894292 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:22:48.894292 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
alter table "dvdrental"."public"."stg_dvdrental_films__dbt_tmp" rename to "stg_dvdrental_films"
[0m15:22:48.895294 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
alter table "dvdrental"."public"."stg_dvdrental_inventories__dbt_tmp" rename to "stg_dvdrental_inventories"
[0m15:22:48.899294 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_customers__dbt_backup"
[0m15:22:48.899294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:22:48.903294 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_customers"
[0m15:22:48.903294 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:22:48.903294 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:22:48.907299 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:22:48.907299 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_customers"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_customers__dbt_backup" cascade
[0m15:22:48.908299 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m15:22:48.910298 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m15:22:48.910298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.911298 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.912298 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.912298 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: COMMIT
[0m15:22:48.913297 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: COMMIT
[0m15:22:48.914297 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: COMMIT
[0m15:22:48.914297 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:22:48.915298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:22:48.917298 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_customers: Close
[0m15:22:48.917298 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:48.917298 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:22:48.919298 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."my_first_dbt_model__dbt_backup"
[0m15:22:48.921801 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_films__dbt_backup"
[0m15:22:48.923808 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup"
[0m15:22:48.923808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26CBD5B0>]}
[0m15:22:48.925809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.my_first_dbt_model"
[0m15:22:48.926807 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_films"
[0m15:22:48.926807 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_inventories"
[0m15:22:48.927810 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_first_dbt_model"} */
drop table if exists "dvdrental"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:22:48.927810 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_dvdrental_customers ................ [[32mCREATE VIEW[0m in 0.22s]
[0m15:22:48.928806 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_films"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_films__dbt_backup" cascade
[0m15:22:48.928806 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_inventories"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_inventories__dbt_backup" cascade
[0m15:22:48.929808 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_customers
[0m15:22:48.930807 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:22:48.930807 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:22:48.930807 [info ] [Thread-2 (]: 5 of 9 START sql view model public.stg_dvdrental_payments ...................... [RUN]
[0m15:22:48.931806 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:22:48.931806 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:22:48.932808 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.my_first_dbt_model: Close
[0m15:22:48.932808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_customers, now model.dbt_postgres_prj1.stg_dvdrental_payments)
[0m15:22:48.933807 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.stg_dvdrental_inventories: Close
[0m15:22:48.934807 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.stg_dvdrental_films: Close
[0m15:22:48.935807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26C2F740>]}
[0m15:22:48.935807 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:22:48.936807 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26CBCE00>]}
[0m15:22:48.936807 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26CA9550>]}
[0m15:22:48.937806 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.24s]
[0m15:22:48.940806 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:48.940806 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_dvdrental_inventories .............. [[32mCREATE VIEW[0m in 0.24s]
[0m15:22:48.941806 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.my_first_dbt_model
[0m15:22:48.941806 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_dvdrental_films .................... [[32mCREATE VIEW[0m in 0.24s]
[0m15:22:48.942807 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_inventories
[0m15:22:48.943807 [debug] [Thread-1 (]: Began running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:22:48.943807 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_films
[0m15:22:48.944807 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:22:48.944807 [debug] [Thread-4 (]: Began running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:22:48.944807 [info ] [Thread-1 (]: 6 of 9 START sql view model public.stg_dvdrental_rentals ....................... [RUN]
[0m15:22:48.947809 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:48.947809 [debug] [Thread-3 (]: Began running node model.dbt_postgres_prj1.ratings_inventories
[0m15:22:48.948806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.my_first_dbt_model, now model.dbt_postgres_prj1.stg_dvdrental_rentals)
[0m15:22:48.948806 [info ] [Thread-4 (]: 7 of 9 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:22:48.949806 [info ] [Thread-3 (]: 8 of 9 START sql view model public.ratings_inventories ......................... [RUN]
[0m15:22:48.949806 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:22:48.950806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_inventories, now model.dbt_postgres_prj1.my_second_dbt_model)
[0m15:22:48.950806 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:48.950806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_films, now model.dbt_postgres_prj1.ratings_inventories)
[0m15:22:48.952807 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:48.952807 [debug] [Thread-4 (]: Began compiling node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:22:48.953806 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: BEGIN
[0m15:22:48.953806 [debug] [Thread-3 (]: Began compiling node model.dbt_postgres_prj1.ratings_inventories
[0m15:22:48.955806 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:48.955806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:22:48.958808 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_postgres_prj1.ratings_inventories"
[0m15:22:48.958808 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:22:48.964806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:48.964806 [debug] [Thread-4 (]: Began executing node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:22:48.965806 [debug] [Thread-3 (]: Began executing node model.dbt_postgres_prj1.ratings_inventories
[0m15:22:48.967806 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:48.969808 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_postgres_prj1.ratings_inventories"
[0m15:22:48.970806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:48.970806 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: BEGIN
[0m15:22:48.971806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:48.971806 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:48.972807 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.ratings_inventories"
[0m15:22:48.972807 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: BEGIN
[0m15:22:48.973808 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.ratings_inventories: BEGIN
[0m15:22:48.973808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:22:48.974809 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:22:49.044316 [debug] [Thread-2 (]: SQL status: BEGIN in 0.088 seconds
[0m15:22:49.045316 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:49.045316 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */

  create view "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp"
    
    
  as (
    with source_payment as (

    select * from "dvdrental"."public"."payment"

),

final as (
	select * from source_payment
)

select * from final
  );
[0m15:22:49.047316 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:22:49.050317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:49.050317 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments" rename to "stg_dvdrental_payments__dbt_backup"
[0m15:22:49.051318 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:49.053319 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:49.054318 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
alter table "dvdrental"."public"."stg_dvdrental_payments__dbt_tmp" rename to "stg_dvdrental_payments"
[0m15:22:49.054318 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:49.055317 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:22:49.056317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:49.056317 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: COMMIT
[0m15:22:49.059319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m15:22:49.059319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:49.059319 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */

  create view "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp"
    
    
  as (
    with source_rental as (

    select * from "dvdrental"."public"."rental"

),

final as (
	select * from source_rental
)

select * from final
  );
[0m15:22:49.060317 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:22:49.062319 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_payments__dbt_backup"
[0m15:22:49.062319 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:22:49.063317 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m15:22:49.063317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_payments"
[0m15:22:49.065324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:49.066322 [debug] [Thread-4 (]: SQL status: BEGIN in 0.092 seconds
[0m15:22:49.066322 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.ratings_inventories"
[0m15:22:49.067318 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_payments"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_payments__dbt_backup" cascade
[0m15:22:49.067318 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals" rename to "stg_dvdrental_rentals__dbt_backup"
[0m15:22:49.067318 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:49.068319 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.ratings_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.ratings_inventories"} */

  create view "dvdrental"."public"."ratings_inventories__dbt_tmp"
    
    
  as (
    with films as (

    select * from "dvdrental"."public"."stg_dvdrental_films"

),

inventories as (

    select * from "dvdrental"."public"."stg_dvdrental_inventories"

),

inventories_filmid as (

    select
        film_id,
        count(*) as filmid_count

    from inventories

    group by film_id

),

inventories_filmid_ratings as (

   select 
      inventories_filmid.film_id,
      inventories_filmid.filmid_count,
      films.rating

    from inventories_filmid


    left join films
        on inventories_filmid.film_id = films.film_id

),

final as (

  select rating,
         sum(filmid_count) as total_filmid_count
  from inventories_filmid_ratings 
  group by rating
)

select * from final
  );
[0m15:22:49.069318 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */

  
    

  create  table "dvdrental"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:22:49.069318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:49.070317 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:22:49.071318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:49.072319 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.stg_dvdrental_payments: Close
[0m15:22:49.073319 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:22:49.073319 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:22:49.073319 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
alter table "dvdrental"."public"."stg_dvdrental_rentals__dbt_tmp" rename to "stg_dvdrental_rentals"
[0m15:22:49.074319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26CC0A70>]}
[0m15:22:49.076319 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.ratings_inventories"
[0m15:22:49.078318 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:49.079318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:49.078318 [info ] [Thread-2 (]: 5 of 9 OK created sql view model public.stg_dvdrental_payments ................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:22:49.079318 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.ratings_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.ratings_inventories"} */
alter table "dvdrental"."public"."ratings_inventories__dbt_tmp" rename to "ratings_inventories"
[0m15:22:49.079318 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:22:49.080317 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m15:22:49.081319 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_payments
[0m15:22:49.082318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:49.082318 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:49.082318 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:49.083317 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: COMMIT
[0m15:22:49.084318 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.ratings_inventories: COMMIT
[0m15:22:49.086318 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:49.087319 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.ratings_inventories"
[0m15:22:49.087319 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
alter table "dvdrental"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:22:49.088319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:22:49.088319 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.ratings_inventories: COMMIT
[0m15:22:49.090319 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup"
[0m15:22:49.090319 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:49.091318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_prj1.stg_dvdrental_rentals"
[0m15:22:49.091318 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:22:49.092322 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:22:49.092322 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.stg_dvdrental_rentals"} */
drop view if exists "dvdrental"."public"."stg_dvdrental_rentals__dbt_backup" cascade
[0m15:22:49.093318 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."public"."ratings_inventories__dbt_backup"
[0m15:22:49.094319 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:49.095319 [debug] [Thread-3 (]: Using postgres connection "model.dbt_postgres_prj1.ratings_inventories"
[0m15:22:49.095319 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: COMMIT
[0m15:22:49.095319 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:22:49.095319 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.ratings_inventories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.ratings_inventories"} */
drop view if exists "dvdrental"."public"."ratings_inventories__dbt_backup" cascade
[0m15:22:49.097319 [debug] [Thread-1 (]: On model.dbt_postgres_prj1.stg_dvdrental_rentals: Close
[0m15:22:49.097319 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:22:49.098318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26DB8D70>]}
[0m15:22:49.100318 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."public"."my_second_dbt_model__dbt_backup"
[0m15:22:49.100318 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:22:49.102318 [debug] [Thread-4 (]: Using postgres connection "model.dbt_postgres_prj1.my_second_dbt_model"
[0m15:22:49.101325 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.stg_dvdrental_rentals .................. [[32mCREATE VIEW[0m in 0.15s]
[0m15:22:49.103318 [debug] [Thread-3 (]: On model.dbt_postgres_prj1.ratings_inventories: Close
[0m15:22:49.103318 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.my_second_dbt_model"} */
drop table if exists "dvdrental"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:22:49.104318 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_prj1.stg_dvdrental_rentals
[0m15:22:49.104318 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26D47E90>]}
[0m15:22:49.105317 [debug] [Thread-2 (]: Began running node model.dbt_postgres_prj1.customers
[0m15:22:49.105317 [info ] [Thread-3 (]: 8 of 9 OK created sql view model public.ratings_inventories .................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:22:49.107330 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:22:49.106318 [info ] [Thread-2 (]: 9 of 9 START sql view model public.customers ................................... [RUN]
[0m15:22:49.108322 [debug] [Thread-3 (]: Finished running node model.dbt_postgres_prj1.ratings_inventories
[0m15:22:49.109322 [debug] [Thread-4 (]: On model.dbt_postgres_prj1.my_second_dbt_model: Close
[0m15:22:49.109322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_prj1.stg_dvdrental_payments, now model.dbt_postgres_prj1.customers)
[0m15:22:49.110322 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26C2F890>]}
[0m15:22:49.111324 [debug] [Thread-2 (]: Began compiling node model.dbt_postgres_prj1.customers
[0m15:22:49.114324 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_postgres_prj1.customers"
[0m15:22:49.111324 [info ] [Thread-4 (]: 7 of 9 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.16s]
[0m15:22:49.115323 [debug] [Thread-4 (]: Finished running node model.dbt_postgres_prj1.my_second_dbt_model
[0m15:22:49.115323 [debug] [Thread-2 (]: Began executing node model.dbt_postgres_prj1.customers
[0m15:22:49.118324 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_postgres_prj1.customers"
[0m15:22:49.119321 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:22:49.119321 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: BEGIN
[0m15:22:49.120322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:22:49.183835 [debug] [Thread-2 (]: SQL status: BEGIN in 0.064 seconds
[0m15:22:49.184843 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:22:49.184843 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */

  create view "dvdrental"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "dvdrental"."public"."stg_dvdrental_customers"

),

rentals as (

    select * from "dvdrental"."public"."stg_dvdrental_rentals"

),

payments as (

    select * from "dvdrental"."public"."stg_dvdrental_payments"

),

customer_rentals as (

        select
        customer_id,

        min(rental_date) as first_rental,
        max(rental_date) as most_recent_rental,
        count(rental_id) as number_of_rentals
    from rentals

    group by customer_id

),

customer_payments as (

    select
        rentals.customer_id,
        sum(amount) as total_amount

    from payments

    left join rentals on
         payments.rental_id = rentals.rental_id

    group by rentals.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_rentals.first_rental,
        customer_rentals.most_recent_rental,
        customer_rentals.number_of_rentals,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_rentals
        on customers.customer_id = customer_rentals.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m15:22:49.188835 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:22:49.190835 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:22:49.190835 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
alter table "dvdrental"."public"."customers__dbt_tmp" rename to "customers"
[0m15:22:49.191835 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:49.192939 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m15:22:49.192939 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:22:49.193953 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: COMMIT
[0m15:22:49.198077 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:22:49.199088 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."public"."customers__dbt_backup"
[0m15:22:49.200082 [debug] [Thread-2 (]: Using postgres connection "model.dbt_postgres_prj1.customers"
[0m15:22:49.200082 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_postgres_prj1", "target_name": "dev", "node_id": "model.dbt_postgres_prj1.customers"} */
drop view if exists "dvdrental"."public"."customers__dbt_backup" cascade
[0m15:22:49.200082 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:22:49.201082 [debug] [Thread-2 (]: On model.dbt_postgres_prj1.customers: Close
[0m15:22:49.202083 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fba00a-9319-4202-b29a-05506ae9ecde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A26D28BF0>]}
[0m15:22:49.203084 [info ] [Thread-2 (]: 9 of 9 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m15:22:49.203084 [debug] [Thread-2 (]: Finished running node model.dbt_postgres_prj1.customers
[0m15:22:49.205081 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:49.206082 [debug] [MainThread]: On master: BEGIN
[0m15:22:49.206082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:49.267889 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:22:49.268905 [debug] [MainThread]: On master: COMMIT
[0m15:22:49.268905 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:49.268905 [debug] [MainThread]: On master: COMMIT
[0m15:22:49.269913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:49.269913 [debug] [MainThread]: On master: Close
[0m15:22:49.270901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:49.270901 [debug] [MainThread]: Connection 'list_dvdrental' was properly closed.
[0m15:22:49.270901 [debug] [MainThread]: Connection 'list_dvdrental_public' was properly closed.
[0m15:22:49.271900 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.stg_dvdrental_rentals' was properly closed.
[0m15:22:49.271900 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.customers' was properly closed.
[0m15:22:49.271900 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.ratings_inventories' was properly closed.
[0m15:22:49.271900 [debug] [MainThread]: Connection 'model.dbt_postgres_prj1.my_second_dbt_model' was properly closed.
[0m15:22:49.272901 [info ] [MainThread]: 
[0m15:22:49.272901 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m15:22:49.274902 [debug] [MainThread]: Command end result
[0m15:22:49.328255 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\manifest.json
[0m15:22:49.330892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\semantic_manifest.json
[0m15:22:49.335904 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Program Files\Python312\dbt-core-demo\dbt_postgres_prj1\target\run_results.json
[0m15:22:49.335904 [info ] [MainThread]: 
[0m15:22:49.336904 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:49.336904 [info ] [MainThread]: 
[0m15:22:49.337903 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:22:49.338901 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:49.338901 after 1.74 seconds
[0m15:22:49.338901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A244114C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2490E0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A24D61520>]}
[0m15:22:49.339902 [debug] [MainThread]: Flushing usage events
[0m15:22:49.740540 [debug] [MainThread]: An error was encountered while trying to flush usage events
